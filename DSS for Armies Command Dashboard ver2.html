<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malaysian Army - Mission Readiness Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'army-blue': '#1e3a8a',
                        'army-dark': '#0f172a',
                        'army-light': '#3b82f6'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-army-dark text-white font-sans">
    <!-- Header -->
    <header class="bg-army-blue border-b border-blue-800 p-4">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <div class="w-12 h-12 bg-yellow-500 rounded-full flex items-center justify-center">
                    <svg class="w-8 h-8 text-army-dark" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h12a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6z" clip-rule="evenodd"/>
                    </svg>
                </div>
                <div>
                    <h1 class="text-2xl font-bold">Malaysian Army Command Center</h1>
                    <p class="text-blue-200 text-sm">Mission Readiness Dashboard</p>
                </div>
            </div>
            <div class="text-right">
                <p class="text-sm text-blue-200">Last Updated: <span id="lastUpdate"></span></p>
                <p class="text-lg font-semibold">Overall Readiness: <span class="text-green-400">87%</span></p>
            </div>
        </div>
        
        <!-- Navigation Tabs -->
        <div class="mt-4 border-b border-blue-800">
            <nav class="flex space-x-8">
                <button onclick="switchTab('dashboard')" id="dashboardTab" class="py-2 px-1 border-b-2 border-yellow-500 text-yellow-400 font-medium text-sm">
                    Mission Readiness
                </button>
                <button onclick="switchTab('hr')" id="hrTab" class="py-2 px-1 border-b-2 border-transparent text-blue-200 hover:text-white hover:border-blue-300 font-medium text-sm">
                    Human Resources
                </button>
                <button onclick="switchTab('mobility')" id="mobilityTab" class="py-2 px-1 border-b-2 border-transparent text-blue-200 hover:text-white hover:border-blue-300 font-medium text-sm">
                    Mobility
                </button>
                <button onclick="switchTab('firepower')" id="firepowerTab" class="py-2 px-1 border-b-2 border-transparent text-blue-200 hover:text-white hover:border-blue-300 font-medium text-sm">
                    Fire Power
                </button>
            </nav>
        </div>
    </header>

    <!-- Main Dashboard -->
    <div id="dashboardContent" class="p-6 space-y-6">
        <!-- Key Metrics Row -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700 cursor-pointer hover:bg-slate-700 hover:border-green-500 hover:shadow-lg hover:shadow-green-500/20 transition-all duration-300 transform hover:scale-105" onclick="drillDown('personnel')">
                <div>
                    <p class="text-slate-400 text-sm">Personnel Readiness</p>
                    <p class="text-3xl font-bold text-green-400 transition-all duration-300">92%</p>
                    <p class="text-sm text-slate-300">24,580 / 26,717</p>
                    <div class="w-full bg-slate-600 rounded-full h-2 mt-2">
                        <div class="bg-green-500 h-2 rounded-full transition-all duration-1000 ease-out" style="width: 92%"></div>
                    </div>
                </div>
            </div>

            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700 cursor-pointer hover:bg-slate-700 hover:border-yellow-500 hover:shadow-lg hover:shadow-yellow-500/20 transition-all duration-300 transform hover:scale-105" onclick="drillDown('equipment')">
                <div>
                    <p class="text-slate-400 text-sm">Equipment Status</p>
                    <p class="text-3xl font-bold text-yellow-400 transition-all duration-300">78%</p>
                    <p class="text-sm text-slate-300">1,247 / 1,598</p>
                    <div class="w-full bg-slate-600 rounded-full h-2 mt-2">
                        <div class="bg-yellow-500 h-2 rounded-full transition-all duration-1000 ease-out" style="width: 78%"></div>
                    </div>
                </div>
            </div>

            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700 cursor-pointer hover:bg-slate-700 hover:border-blue-500 hover:shadow-lg hover:shadow-blue-500/20 transition-all duration-300 transform hover:scale-105" onclick="drillDown('training')">
                <div>
                    <p class="text-slate-400 text-sm">Training Completion</p>
                    <p class="text-3xl font-bold text-blue-400 transition-all duration-300">85%</p>
                    <p class="text-sm text-slate-300">Q4 2024 Cycle</p>
                    <div class="w-full bg-slate-600 rounded-full h-2 mt-2">
                        <div class="bg-blue-500 h-2 rounded-full transition-all duration-1000 ease-out" style="width: 85%"></div>
                    </div>
                </div>
            </div>

            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700 cursor-pointer hover:bg-slate-700 hover:border-red-500 hover:shadow-lg hover:shadow-red-500/20 transition-all duration-300 transform hover:scale-105" onclick="drillDown('logistics')">
                <div>
                    <p class="text-slate-400 text-sm">Supply Chain</p>
                    <p class="text-3xl font-bold text-red-400 transition-all duration-300">68%</p>
                    <p class="text-sm text-slate-300">Critical Items Low</p>
                    <div class="w-full bg-slate-600 rounded-full h-2 mt-2">
                        <div class="bg-red-500 h-2 rounded-full transition-all duration-1000 ease-out" style="width: 68%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Regional Commands -->
        <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
            <h2 class="text-xl font-bold mb-4">Regional Command Status</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-slate-700 rounded-lg p-4 cursor-pointer hover:bg-slate-600 transition-colors" onclick="drillDown('northern')">
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="font-semibold">Northern Command</h3>
                        <span class="px-2 py-1 bg-green-500 text-xs rounded-full">READY</span>
                    </div>
                    <div class="space-y-2">
                        <div class="flex justify-between text-sm">
                            <span>Personnel:</span>
                            <span class="text-green-400">94%</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span>Equipment:</span>
                            <span class="text-green-400">89%</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span>Bases:</span>
                            <span>Perlis, Kedah, Penang</span>
                        </div>
                    </div>
                </div>

                <div class="bg-slate-700 rounded-lg p-4 cursor-pointer hover:bg-slate-600 transition-colors" onclick="drillDown('central')">
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="font-semibold">Central Command</h3>
                        <span class="px-2 py-1 bg-yellow-500 text-xs rounded-full">CAUTION</span>
                    </div>
                    <div class="space-y-2">
                        <div class="flex justify-between text-sm">
                            <span>Personnel:</span>
                            <span class="text-green-400">91%</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span>Equipment:</span>
                            <span class="text-yellow-400">72%</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span>Bases:</span>
                            <span>KL, Selangor, Perak</span>
                        </div>
                    </div>
                </div>

                <div class="bg-slate-700 rounded-lg p-4 cursor-pointer hover:bg-slate-600 transition-colors" onclick="drillDown('eastern')">
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="font-semibold">Eastern Command</h3>
                        <span class="px-2 py-1 bg-green-500 text-xs rounded-full">READY</span>
                    </div>
                    <div class="space-y-2">
                        <div class="flex justify-between text-sm">
                            <span>Personnel:</span>
                            <span class="text-green-400">88%</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span>Equipment:</span>
                            <span class="text-green-400">85%</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span>Bases:</span>
                            <span>Sabah, Sarawak</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mission Alerts & Intelligence -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <h2 class="text-xl font-bold mb-4">Active Alerts</h2>
                <div class="space-y-3">
                    <div class="flex items-center space-x-3 p-3 bg-red-900 bg-opacity-30 rounded-lg border border-red-800">
                        <div class="w-3 h-3 bg-red-500 rounded-full animate-pulse"></div>
                        <div class="flex-1">
                            <p class="font-semibold text-red-300">Supply Chain Disruption</p>
                            <p class="text-sm text-slate-300">Ammunition supplies below threshold - Eastern Command</p>
                        </div>
                        <button class="px-3 py-1 bg-red-600 text-xs rounded hover:bg-red-700" onclick="viewAlert('supply')">VIEW</button>
                    </div>
                    
                    <div class="flex items-center space-x-3 p-3 bg-yellow-900 bg-opacity-30 rounded-lg border border-yellow-800">
                        <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                        <div class="flex-1">
                            <p class="font-semibold text-yellow-300">Training Exercise Delayed</p>
                            <p class="text-sm text-slate-300">Weather conditions affecting Operation Thunder - Central</p>
                        </div>
                        <button class="px-3 py-1 bg-yellow-600 text-xs rounded hover:bg-yellow-700" onclick="viewAlert('training')">VIEW</button>
                    </div>

                    <div class="flex items-center space-x-3 p-3 bg-blue-900 bg-opacity-30 rounded-lg border border-blue-800">
                        <div class="w-3 h-3 bg-blue-500 rounded-full"></div>
                        <div class="flex-1">
                            <p class="font-semibold text-blue-300">Equipment Maintenance</p>
                            <p class="text-sm text-slate-300">Scheduled maintenance for 12 vehicles - Northern Command</p>
                        </div>
                        <button class="px-3 py-1 bg-blue-600 text-xs rounded hover:bg-blue-700" onclick="viewAlert('maintenance')">VIEW</button>
                    </div>
                </div>
            </div>

            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <h2 class="text-xl font-bold mb-4">Deployment Readiness</h2>
                <div class="space-y-4">
                    <div class="flex items-center justify-between p-3 bg-slate-700 rounded-lg">
                        <div>
                            <p class="font-semibold">1st Infantry Division</p>
                            <p class="text-sm text-slate-300">Ready for immediate deployment</p>
                        </div>
                        <div class="text-right">
                            <p class="text-green-400 font-bold">READY</p>
                            <p class="text-xs text-slate-400">2,450 personnel</p>
                        </div>
                    </div>

                    <div class="flex items-center justify-between p-3 bg-slate-700 rounded-lg">
                        <div>
                            <p class="font-semibold">Special Forces Regiment</p>
                            <p class="text-sm text-slate-300">Training exercise in progress</p>
                        </div>
                        <div class="text-right">
                            <p class="text-yellow-400 font-bold">TRAINING</p>
                            <p class="text-xs text-slate-400">580 personnel</p>
                        </div>
                    </div>

                    <div class="flex items-center justify-between p-3 bg-slate-700 rounded-lg">
                        <div>
                            <p class="font-semibold">Armored Brigade</p>
                            <p class="text-sm text-slate-300">Equipment maintenance cycle</p>
                        </div>
                        <div class="text-right">
                            <p class="text-red-400 font-bold">MAINTENANCE</p>
                            <p class="text-xs text-slate-400">1,200 personnel</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Advanced HR Analytics Sections -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Predictive Workforce Planning -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <h2 class="text-xl font-bold mb-4">Predictive Workforce Planning</h2>
                <div class="space-y-4">
                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-blue-400">Retirement Forecast (Next 5 Years)</h3>
                        <div style="height: 180px;">
                            <canvas id="retirementForecastChart"></canvas>
                        </div>
                    </div>

                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-green-400">Recruitment Needs</h3>
                        <div style="height: 140px;">
                            <canvas id="recruitmentNeedsChart"></canvas>
                        </div>
                    </div>

                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-purple-400">Skills Gap Risk Level</h3>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between">
                                <span class="text-sm">Cyber Security</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-20 bg-slate-600 rounded-full h-2">
                                        <div class="bg-red-500 h-2 rounded-full" style="width: 85%"></div>
                                    </div>
                                    <span class="text-red-400 text-xs font-semibold">85%</span>
                                </div>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm">Advanced Engineering</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-20 bg-slate-600 rounded-full h-2">
                                        <div class="bg-yellow-500 h-2 rounded-full" style="width: 60%"></div>
                                    </div>
                                    <span class="text-yellow-400 text-xs font-semibold">60%</span>
                                </div>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm">Leadership</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-20 bg-slate-600 rounded-full h-2">
                                        <div class="bg-green-500 h-2 rounded-full" style="width: 25%"></div>
                                    </div>
                                    <span class="text-green-400 text-xs font-semibold">25%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded text-sm transition-colors" onclick="drillDown('workforce-planning')">
                        View Detailed Forecast
                    </button>
                </div>
            </div>

            <!-- AI-Skill Based Matching -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <h2 class="text-xl font-bold mb-4">AI-Skill Based Matching</h2>
                <div class="space-y-4">
                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-green-400">Match Accuracy Distribution</h3>
                        <div style="height: 140px;">
                            <canvas id="skillMatchChart"></canvas>
                        </div>
                    </div>

                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-blue-400">Top Transfer Recommendations</h3>
                        <div style="height: 120px;">
                            <canvas id="transferRecommendationsChart"></canvas>
                        </div>
                    </div>

                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-purple-400">Training Needs by Category</h3>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between">
                                <span class="text-sm">Leadership Development</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-20 bg-slate-600 rounded-full h-2">
                                        <div class="bg-blue-500 h-2 rounded-full" style="width: 19%"></div>
                                    </div>
                                    <span class="text-blue-400 text-xs font-semibold">245</span>
                                </div>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm">Technical Upskilling</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-20 bg-slate-600 rounded-full h-2">
                                        <div class="bg-yellow-500 h-2 rounded-full" style="width: 69%"></div>
                                    </div>
                                    <span class="text-yellow-400 text-xs font-semibold">890</span>
                                </div>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm">Cross-Training</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-20 bg-slate-600 rounded-full h-2">
                                        <div class="bg-green-500 h-2 rounded-full" style="width: 12%"></div>
                                    </div>
                                    <span class="text-green-400 text-xs font-semibold">156</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button class="w-full bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded text-sm transition-colors" onclick="drillDown('skill-matching')">
                        View AI Recommendations
                    </button>
                </div>
            </div>

            <!-- Attrition Risk Analysis -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <h2 class="text-xl font-bold mb-4">Attrition Risk Analysis</h2>
                <div class="space-y-4">
                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-red-400">Risk Level Distribution</h3>
                        <div style="height: 140px;">
                            <canvas id="attritionRiskChart"></canvas>
                        </div>
                    </div>

                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-yellow-400">Risk Factors Impact</h3>
                        <div style="height: 120px;">
                            <canvas id="riskFactorsChart"></canvas>
                        </div>
                    </div>

                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-green-400">Retention Program Progress</h3>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between">
                                <span class="text-sm">Career Counseling</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-20 bg-slate-600 rounded-full h-2">
                                        <div class="bg-blue-500 h-2 rounded-full" style="width: 48%"></div>
                                    </div>
                                    <span class="text-blue-400 text-xs font-semibold">1,240</span>
                                </div>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm">Skill Development</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-20 bg-slate-600 rounded-full h-2">
                                        <div class="bg-green-500 h-2 rounded-full" style="width: 34%"></div>
                                    </div>
                                    <span class="text-green-400 text-xs font-semibold">890</span>
                                </div>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm">Mentorship Program</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-20 bg-slate-600 rounded-full h-2">
                                        <div class="bg-purple-500 h-2 rounded-full" style="width: 18%"></div>
                                    </div>
                                    <span class="text-purple-400 text-xs font-semibold">456</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button class="w-full bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded text-sm transition-colors" onclick="drillDown('attrition-risk')">
                        View Risk Assessment
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Human Resources Dashboard -->
    <div id="hrContent" class="p-6 space-y-6 hidden">
        <!-- HR Key Metrics Cards -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div>
                    <p class="text-slate-400 text-sm">Active Personnel</p>
                    <p class="text-3xl font-bold text-green-400">24,580</p>
                    <p class="text-sm text-slate-300">+2.3% from last month</p>
                </div>
            </div>

            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div>
                    <p class="text-slate-400 text-sm">Personnel on Leave</p>
                    <p class="text-3xl font-bold text-yellow-400">1,247</p>
                    <p class="text-sm text-slate-300">5.1% of total force</p>
                </div>
            </div>

            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div>
                    <p class="text-slate-400 text-sm">New Appointments</p>
                    <p class="text-3xl font-bold text-blue-400">342</p>
                    <p class="text-sm text-slate-300">This quarter</p>
                </div>
            </div>

            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div>
                    <p class="text-slate-400 text-sm">Avg Performance Score</p>
                    <p class="text-3xl font-bold text-green-400">8.7</p>
                    <p class="text-sm text-slate-300">Out of 10.0</p>
                </div>
            </div>
        </div>

        <!-- Charts Row -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Personnel by Rank and Corps Chart -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700 cursor-pointer hover:bg-slate-700 transition-colors" onclick="drillThroughChart('personnel')">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold">Personnel by Rank & Corps</h2>
                    <span class="text-xs text-slate-400">Click for details →</span>
                </div>
                <div style="height: 300px;">
                    <canvas id="personnelChart"></canvas>
                </div>
            </div>

            <!-- Appointments vs Retirements Chart -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700 cursor-pointer hover:bg-slate-700 transition-colors" onclick="drillThroughChart('appointments')">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold">Appointments vs Retirements</h2>
                    <div class="flex items-center space-x-2">
                        <select id="timeFilter" class="bg-slate-700 text-white px-3 py-1 rounded text-sm" onchange="updateAppointmentChart()" onclick="event.stopPropagation()">
                            <option value="year">By Year</option>
                            <option value="quarter">By Quarter</option>
                            <option value="month">By Month</option>
                        </select>
                        <span class="text-xs text-slate-400">Click for details →</span>
                    </div>
                </div>
                <div style="height: 300px;">
                    <canvas id="appointmentChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Training and Medical Status Charts Row -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Training Status Chart -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <h2 class="text-xl font-bold mb-4">Training Status by Unit</h2>
                
                <!-- Progress Cards View -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Infantry Card -->
                    <div class="bg-slate-700 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <h4 class="font-semibold text-green-400">1st Infantry Division</h4>
                            <div class="w-12 h-12 relative">
                                <svg class="w-12 h-12 transform -rotate-90" viewBox="0 0 36 36">
                                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#374151" stroke-width="2"/>
                                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#10b981" stroke-width="2" stroke-dasharray="87, 100"/>
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <span class="text-xs font-bold text-green-400">87%</span>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-2">
                            <div class="flex justify-between text-sm">
                                <span>Combat Training:</span>
                                <span class="text-green-400">95%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Leadership:</span>
                                <span class="text-yellow-400">78%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Technical:</span>
                                <span class="text-green-400">87%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Physical:</span>
                                <span class="text-green-400">92%</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Armored Card -->
                    <div class="bg-slate-700 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <h4 class="font-semibold text-blue-400">Armored Brigade</h4>
                            <div class="w-12 h-12 relative">
                                <svg class="w-12 h-12 transform -rotate-90" viewBox="0 0 36 36">
                                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#374151" stroke-width="2"/>
                                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#10b981" stroke-width="2" stroke-dasharray="85, 100"/>
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <span class="text-xs font-bold text-green-400">85%</span>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-2">
                            <div class="flex justify-between text-sm">
                                <span>Combat Training:</span>
                                <span class="text-green-400">92%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Leadership:</span>
                                <span class="text-yellow-400">75%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Technical:</span>
                                <span class="text-green-400">89%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Physical:</span>
                                <span class="text-green-400">84%</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Artillery Card -->
                    <div class="bg-slate-700 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <h4 class="font-semibold text-yellow-400">Artillery Regiment</h4>
                            <div class="w-12 h-12 relative">
                                <svg class="w-12 h-12 transform -rotate-90" viewBox="0 0 36 36">
                                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#374151" stroke-width="2"/>
                                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#10b981" stroke-width="2" stroke-dasharray="84, 100"/>
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <span class="text-xs font-bold text-green-400">84%</span>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-2">
                            <div class="flex justify-between text-sm">
                                <span>Combat Training:</span>
                                <span class="text-green-400">89%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Leadership:</span>
                                <span class="text-yellow-400">72%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Technical:</span>
                                <span class="text-green-400">91%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Physical:</span>
                                <span class="text-green-400">84%</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Engineering Card -->
                    <div class="bg-slate-700 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <h4 class="font-semibold text-purple-400">Engineering Corps</h4>
                            <div class="w-12 h-12 relative">
                                <svg class="w-12 h-12 transform -rotate-90" viewBox="0 0 36 36">
                                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#374151" stroke-width="2"/>
                                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#10b981" stroke-width="2" stroke-dasharray="87, 100"/>
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <span class="text-xs font-bold text-green-400">87%</span>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-2">
                            <div class="flex justify-between text-sm">
                                <span>Combat Training:</span>
                                <span class="text-green-400">87%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Leadership:</span>
                                <span class="text-yellow-400">79%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Technical:</span>
                                <span class="text-green-400">94%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Physical:</span>
                                <span class="text-green-400">88%</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Medical Card -->
                    <div class="bg-slate-700 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <h4 class="font-semibold text-cyan-400">Medical Corps</h4>
                            <div class="w-12 h-12 relative">
                                <svg class="w-12 h-12 transform -rotate-90" viewBox="0 0 36 36">
                                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#374151" stroke-width="2"/>
                                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#10b981" stroke-width="2" stroke-dasharray="88, 100"/>
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <span class="text-xs font-bold text-green-400">88%</span>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-2">
                            <div class="flex justify-between text-sm">
                                <span>Combat Training:</span>
                                <span class="text-green-400">85%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Leadership:</span>
                                <span class="text-green-400">82%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Technical:</span>
                                <span class="text-green-400">96%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Physical:</span>
                                <span class="text-green-400">89%</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Special Forces Card -->
                    <div class="bg-slate-700 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <h4 class="font-semibold text-red-400">Special Forces</h4>
                            <div class="w-12 h-12 relative">
                                <svg class="w-12 h-12 transform -rotate-90" viewBox="0 0 36 36">
                                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#374151" stroke-width="2"/>
                                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#10b981" stroke-width="2" stroke-dasharray="95, 100"/>
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <span class="text-xs font-bold text-green-400">95%</span>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-2">
                            <div class="flex justify-between text-sm">
                                <span>Combat Training:</span>
                                <span class="text-green-400">98%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Leadership:</span>
                                <span class="text-green-400">94%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Technical:</span>
                                <span class="text-green-400">92%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Physical:</span>
                                <span class="text-green-400">96%</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Performance Legend -->
                <div class="mt-4 bg-slate-700 rounded p-3">
                    <h4 class="font-semibold text-yellow-400 text-sm mb-2">Performance Scale:</h4>
                    <div class="flex items-center space-x-6 text-xs">
                        <div class="flex items-center space-x-2">
                            <div class="w-4 h-4 bg-green-500 rounded"></div>
                            <span>90-100%: Excellent</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div class="w-4 h-4 bg-yellow-500 rounded"></div>
                            <span>70-89%: Good</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div class="w-4 h-4 bg-red-500 rounded"></div>
                            <span>Below 70%: Needs Attention</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Medical & Fitness Status Chart (Enhanced) -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold">Medical & Fitness Status</h2>
                    <select id="medTimeFilter" class="bg-slate-700 text-white px-3 py-1 rounded text-sm" onchange="updateMedicalFitnessTimeframe()">
                        <option value="90">Last 90 days</option>
                        <option value="30">Last 30 days</option>
                        <option value="365">Year to date</option>
                    </select>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                    <!-- Left: KPIs + Medical Categories Donut -->
                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-green-400">Medical Categories</h3>
                        <div class="hidden"></div>
                        <div style="height: 220px;">
                            <canvas id="medicalStatusChart"></canvas>
                        </div>
                    </div>

                    <!-- Right: Fitness Pass Rate + Injury Types -->
                    <div class="space-y-4">
                        <div class="bg-slate-700 rounded-lg p-4">
                            <h3 class="font-semibold mb-2 text-blue-400">Fitness Test Pass Rate</h3>
                            <div style="height: 140px;">
                                <canvas id="fitnessPassChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-slate-700 rounded-lg p-4">
                            <h3 class="font-semibold mb-2 text-yellow-400">Top Injury Types</h3>
                            <div style="height: 140px;">
                                <canvas id="injuryTypeChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bottom: Sick Days Trend + Clearance Status -->
                <div class="mt-4 grid grid-cols-1 lg:grid-cols-3 gap-4">
                    <div class="bg-slate-700 rounded-lg p-4 lg:col-span-2">
                        <h3 class="font-semibold mb-2 text-purple-400">Sick Days Trend</h3>
                        <div style="height: 140px;">
                            <canvas id="sickDaysTrendChart"></canvas>
                        </div>
                    </div>
                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-2 text-cyan-400">Clearance Status</h3>
                        <div class="space-y-2 text-sm">
                            <div>
                                <div class="flex justify-between mb-1"><span>Fit for all duties</span><span class="text-green-400 font-semibold">78%</span></div>
                                <div class="w-full bg-slate-600 rounded-full h-2"><div class="bg-green-500 h-2 rounded-full" style="width:78%"></div></div>
                            </div>
                            <div>
                                <div class="flex justify-between mb-1"><span>Limited duty</span><span class="text-yellow-400 font-semibold">18%</span></div>
                                <div class="w-full bg-slate-600 rounded-full h-2"><div class="bg-yellow-500 h-2 rounded-full" style="width:18%"></div></div>
                            </div>
                            <div>
                                <div class="flex justify-between mb-1"><span>Under review</span><span class="text-red-400 font-semibold">4%</span></div>
                                <div class="w-full bg-slate-600 rounded-full h-2"><div class="bg-red-500 h-2 rounded-full" style="width:4%"></div></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance and Leave Status Tables Row -->
        <div class="grid grid-cols-1 lg:grid-cols-1 gap-6">
            <!-- Performance Evaluation Table -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <h2 class="text-xl font-bold mb-4">Performance Evaluation Summary</h2>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead>
                            <tr class="border-b border-slate-600">
                                <th class="text-left py-2">Performance Level</th>
                                <th class="text-left py-2">Officers</th>
                                <th class="text-left py-2">NCOs</th>
                                <th class="text-left py-2">Enlisted</th>
                                <th class="text-left py-2">Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-slate-700">
                                <td class="py-2">Excellent (9.0-10.0)</td>
                                <td class="py-2">890</td>
                                <td class="py-2">1,245</td>
                                <td class="py-2">1,552</td>
                                <td class="py-2">3,687</td>
                            </tr>
                            <tr class="border-b border-slate-700">
                                <td class="py-2">Good (7.0-8.9)</td>
                                <td class="py-2">1,456</td>
                                <td class="py-2">6,234</td>
                                <td class="py-2">8,287</td>
                                <td class="py-2">15,977</td>
                            </tr>
                            <tr class="border-b border-slate-700">
                                <td class="py-2">Satisfactory (5.0-6.9)</td>
                                <td class="py-2">189</td>
                                <td class="py-2">860</td>
                                <td class="py-2">3,375</td>
                                <td class="py-2">4,424</td>
                            </tr>
                            <tr>
                                <td class="py-2">Needs Improvement (&lt;5.0)</td>
                                <td class="py-2">20</td>
                                <td class="py-2">101</td>
                                <td class="py-2">371</td>
                                <td class="py-2">492</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobility Dashboard -->
    <div id="mobilityContent" class="p-6 space-y-6 hidden">
        <!-- Vehicle Status Cards -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div>
                    <p class="text-slate-400 text-sm">Total Fleet</p>
                    <p class="text-3xl font-bold text-green-400">2,847</p>
                    <p class="text-sm text-slate-300">Vehicles Active</p>
                </div>
            </div>

            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div>
                    <p class="text-slate-400 text-sm">Operational</p>
                    <p class="text-3xl font-bold text-green-400">89%</p>
                    <p class="text-sm text-slate-300">2,534 vehicles</p>
                </div>
            </div>

            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div>
                    <p class="text-slate-400 text-sm">Under Maintenance</p>
                    <p class="text-3xl font-bold text-yellow-400">8%</p>
                    <p class="text-sm text-slate-300">228 vehicles</p>
                </div>
            </div>

            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div>
                    <p class="text-slate-400 text-sm">Out of Service</p>
                    <p class="text-3xl font-bold text-red-400">3%</p>
                    <p class="text-sm text-slate-300">85 vehicles</p>
                </div>
            </div>
        </div>

        <!-- Charts Row -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Vehicle Type Distribution Chart -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold">Vehicle Fleet by Type</h2>
                </div>
                <div style="height: 300px;">
                    <canvas id="vehicleTypeChart"></canvas>
                </div>
            </div>

            <!-- Location Distribution Chart -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold">Asset Location Distribution</h2>
                    <span class="text-xs text-slate-400">Click bars for details</span>
                </div>
                <div style="height: 300px;">
                    <canvas id="locationChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Tables Row -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Aged Vehicles Table -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <h2 class="text-xl font-bold mb-4">Aged Vehicles (Maintenance/Disposal)</h2>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead>
                            <tr class="border-b border-slate-600">
                                <th class="text-left py-2">Vehicle ID</th>
                                <th class="text-left py-2">Type</th>
                                <th class="text-left py-2">Age (Years)</th>
                                <th class="text-left py-2">Status</th>
                                <th class="text-left py-2">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-slate-700">
                                <td class="py-2">MY-T001-1998</td>
                                <td class="py-2">Main Battle Tank</td>
                                <td class="py-2">26</td>
                                <td class="py-2"><span class="px-2 py-1 bg-red-600 text-xs rounded">Critical</span></td>
                                <td class="py-2"><span class="px-2 py-1 bg-orange-600 text-xs rounded">Disposal</span></td>
                            </tr>
                            <tr class="border-b border-slate-700">
                                <td class="py-2">MY-APC-2001</td>
                                <td class="py-2">Armored Personnel Carrier</td>
                                <td class="py-2">23</td>
                                <td class="py-2"><span class="px-2 py-1 bg-yellow-600 text-xs rounded">Warning</span></td>
                                <td class="py-2"><span class="px-2 py-1 bg-blue-600 text-xs rounded">Major Service</span></td>
                            </tr>
                            <tr class="border-b border-slate-700">
                                <td class="py-2">MY-TR-1999</td>
                                <td class="py-2">Transport Truck</td>
                                <td class="py-2">25</td>
                                <td class="py-2"><span class="px-2 py-1 bg-red-600 text-xs rounded">Critical</span></td>
                                <td class="py-2"><span class="px-2 py-1 bg-orange-600 text-xs rounded">Disposal</span></td>
                            </tr>
                            <tr class="border-b border-slate-700">
                                <td class="py-2">MY-HEL-2003</td>
                                <td class="py-2">Utility Helicopter</td>
                                <td class="py-2">21</td>
                                <td class="py-2"><span class="px-2 py-1 bg-yellow-600 text-xs rounded">Warning</span></td>
                                <td class="py-2"><span class="px-2 py-1 bg-blue-600 text-xs rounded">Overhaul</span></td>
                            </tr>
                            <tr class="border-b border-slate-700">
                                <td class="py-2">MY-ART-2000</td>
                                <td class="py-2">Artillery System</td>
                                <td class="py-2">24</td>
                                <td class="py-2"><span class="px-2 py-1 bg-red-600 text-xs rounded">Critical</span></td>
                                <td class="py-2"><span class="px-2 py-1 bg-orange-600 text-xs rounded">Disposal</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Location & Conditions Table -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <h2 class="text-xl font-bold mb-4">Location & Environmental Conditions</h2>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead>
                            <tr class="border-b border-slate-600">
                                <th class="text-left py-2">Location</th>
                                <th class="text-left py-2">Weather</th>
                                <th class="text-left py-2">Road Condition</th>
                                <th class="text-left py-2">Impact</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-slate-700">
                                <td class="py-2">Kem Terendak</td>
                                <td class="py-2"><span class="px-2 py-1 bg-green-600 text-xs rounded">Clear</span></td>
                                <td class="py-2"><span class="px-2 py-1 bg-green-600 text-xs rounded">Good</span></td>
                                <td class="py-2">Optimal</td>
                            </tr>
                            <tr class="border-b border-slate-700">
                                <td class="py-2">Kem Gemas</td>
                                <td class="py-2"><span class="px-2 py-1 bg-yellow-600 text-xs rounded">Rain</span></td>
                                <td class="py-2"><span class="px-2 py-1 bg-yellow-600 text-xs rounded">Fair</span></td>
                                <td class="py-2">Reduced</td>
                            </tr>
                            <tr class="border-b border-slate-700">
                                <td class="py-2">Kem Mahkota</td>
                                <td class="py-2"><span class="px-2 py-1 bg-green-600 text-xs rounded">Sunny</span></td>
                                <td class="py-2"><span class="px-2 py-1 bg-green-600 text-xs rounded">Excellent</span></td>
                                <td class="py-2">Optimal</td>
                            </tr>
                            <tr class="border-b border-slate-700">
                                <td class="py-2">Kem Wardieburn</td>
                                <td class="py-2"><span class="px-2 py-1 bg-red-600 text-xs rounded">Storm</span></td>
                                <td class="py-2"><span class="px-2 py-1 bg-red-600 text-xs rounded">Poor</span></td>
                                <td class="py-2">Limited</td>
                            </tr>
                            <tr class="border-b border-slate-700">
                                <td class="py-2">Kem Sungai Udang</td>
                                <td class="py-2"><span class="px-2 py-1 bg-green-600 text-xs rounded">Clear</span></td>
                                <td class="py-2"><span class="px-2 py-1 bg-yellow-600 text-xs rounded">Fair</span></td>
                                <td class="py-2">Good</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Operation Report Visualization -->
        <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
            <h2 class="text-xl font-bold mb-4">Operation Reports Visualization</h2>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="bg-slate-700 rounded-lg p-4">
                    <h3 class="font-semibold mb-2 text-green-400">Mission Success Rate</h3>
                    <div class="text-center mb-3">
                        <span class="text-3xl font-bold text-green-400">94.7%</span>
                        <p class="text-xs text-slate-300">Last 30 days</p>
                    </div>
                    <div class="w-full bg-slate-600 rounded-full h-2">
                        <div class="bg-green-500 h-2 rounded-full" style="width: 94.7%"></div>
                    </div>
                </div>

                <div class="bg-slate-700 rounded-lg p-4">
                    <h3 class="font-semibold mb-2 text-blue-400">Active Operations</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>Border Patrol:</span>
                            <span class="text-green-400">12 missions</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Training Exercises:</span>
                            <span class="text-blue-400">8 missions</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Humanitarian Aid:</span>
                            <span class="text-yellow-400">3 missions</span>
                        </div>
                    </div>
                </div>

                <div class="bg-slate-700 rounded-lg p-4">
                    <h3 class="font-semibold mb-2 text-purple-400">Vehicle Utilization</h3>
                    <div class="space-y-1 text-sm">
                        <div class="flex justify-between">
                            <span>High Usage:</span>
                            <span class="text-red-400">1,240 vehicles</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Normal Usage:</span>
                            <span class="text-green-400">1,450 vehicles</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Low Usage:</span>
                            <span class="text-blue-400">157 vehicles</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Fleet Maintenance Prediction -->
        <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold">Fleet Maintenance Prediction</h2>
                <div class="flex items-center space-x-2">
                    <div class="w-3 h-3 bg-red-500 rounded-full animate-pulse"></div>
                    <span class="text-sm text-red-400">8 Critical Alerts</span>
                </div>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Maintenance Notifications -->
                <div class="space-y-3">
                    <h3 class="font-semibold text-yellow-400 mb-3">Upcoming Maintenance Notifications</h3>
                    
                    <div class="bg-red-900 bg-opacity-30 border border-red-700 rounded-lg p-3">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-red-500 rounded-full animate-pulse"></div>
                                <span class="font-semibold text-red-400">CRITICAL - Due Now</span>
                            </div>
                            <button class="px-2 py-1 bg-red-600 text-xs rounded hover:bg-red-700" onclick="viewMaintenanceAlert('critical')">VIEW</button>
                        </div>
                        <p class="text-sm text-slate-300">MY-T045-2010: Engine overhaul required (25,000 km overdue)</p>
                        <p class="text-xs text-slate-400">Location: Kem Terendak | Est. Cost: RM 45,000</p>
                    </div>

                    <div class="bg-yellow-900 bg-opacity-30 border border-yellow-700 rounded-lg p-3">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
                                <span class="font-semibold text-yellow-400">WARNING - Due in 7 days</span>
                            </div>
                            <button class="px-2 py-1 bg-yellow-600 text-xs rounded hover:bg-yellow-700" onclick="viewMaintenanceAlert('warning')">VIEW</button>
                        </div>
                        <p class="text-sm text-slate-300">MY-APC-2015: Transmission service required</p>
                        <p class="text-xs text-slate-400">Location: Kem Gemas | Est. Cost: RM 12,000</p>
                    </div>

                    <div class="bg-blue-900 bg-opacity-30 border border-blue-700 rounded-lg p-3">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                <span class="font-semibold text-blue-400">SCHEDULED - Due in 14 days</span>
                            </div>
                            <button class="px-2 py-1 bg-blue-600 text-xs rounded hover:bg-blue-700" onclick="viewMaintenanceAlert('scheduled')">VIEW</button>
                        </div>
                        <p class="text-sm text-slate-300">MY-HEL-2018: Routine inspection and service</p>
                        <p class="text-xs text-slate-400">Location: Kem Wardieburn | Est. Cost: RM 8,500</p>
                    </div>

                    <div class="bg-green-900 bg-opacity-30 border border-green-700 rounded-lg p-3">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                <span class="font-semibold text-green-400">PLANNED - Due in 30 days</span>
                            </div>
                            <button class="px-2 py-1 bg-green-600 text-xs rounded hover:bg-green-700" onclick="viewMaintenanceAlert('planned')">VIEW</button>
                        </div>
                        <p class="text-sm text-slate-300">MY-TR-2019: Preventive maintenance cycle</p>
                        <p class="text-xs text-slate-400">Location: Kem Mahkota | Est. Cost: RM 6,200</p>
                    </div>
                </div>

                <!-- Predictive Analytics -->
                <div class="bg-slate-700 rounded-lg p-4">
                    <h3 class="font-semibold mb-3 text-purple-400">Predictive Maintenance Analytics</h3>
                    
                    <div class="space-y-4">
                        <div class="bg-slate-600 rounded p-3">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-semibold">Engine Failure Risk</span>
                                <span class="px-2 py-1 bg-red-600 text-xs rounded">High</span>
                            </div>
                            <div class="w-full bg-slate-500 rounded-full h-2 mb-1">
                                <div class="bg-red-500 h-2 rounded-full" style="width: 85%"></div>
                            </div>
                            <p class="text-xs text-slate-300">12 vehicles at risk in next 30 days</p>
                        </div>

                        <div class="bg-slate-600 rounded p-3">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-semibold">Transmission Issues</span>
                                <span class="px-2 py-1 bg-yellow-600 text-xs rounded">Medium</span>
                            </div>
                            <div class="w-full bg-slate-500 rounded-full h-2 mb-1">
                                <div class="bg-yellow-500 h-2 rounded-full" style="width: 60%"></div>
                            </div>
                            <p class="text-xs text-slate-300">8 vehicles showing early signs</p>
                        </div>

                        <div class="bg-slate-600 rounded p-3">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-semibold">Brake System</span>
                                <span class="px-2 py-1 bg-green-600 text-xs rounded">Low</span>
                            </div>
                            <div class="w-full bg-slate-500 rounded-full h-2 mb-1">
                                <div class="bg-green-500 h-2 rounded-full" style="width: 25%"></div>
                            </div>
                            <p class="text-xs text-slate-300">3 vehicles require attention</p>
                        </div>

                        <div class="mt-4 p-3 bg-slate-600 rounded">
                            <h4 class="font-semibold mb-2 text-sm">Cost Predictions</h4>
                            <div class="space-y-1 text-xs">
                                <div class="flex justify-between">
                                    <span>Next 30 days:</span>
                                    <span class="text-red-400">RM 245,000</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Next 90 days:</span>
                                    <span class="text-yellow-400">RM 680,000</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Annual forecast:</span>
                                    <span class="text-blue-400">RM 2.4M</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Route Optimization & Usage Pattern Analysis -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Route Optimization -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <h2 class="text-xl font-bold mb-4">Route Optimization</h2>
                
                <div class="space-y-4">
                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-green-400">Optimized Routes Today</h3>
                        <div class="text-center mb-3">
                            <span class="text-3xl font-bold text-green-400">87%</span>
                            <p class="text-xs text-slate-300">Routes using AI optimization</p>
                        </div>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="text-center">
                                <p class="text-lg font-bold text-blue-400">23%</p>
                                <p class="text-xs text-slate-300">Fuel Savings</p>
                            </div>
                            <div class="text-center">
                                <p class="text-lg font-bold text-green-400">18%</p>
                                <p class="text-xs text-slate-300">Time Reduction</p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-blue-400">Active Route Optimizations</h3>
                        <div class="space-y-2 text-sm">
                            <div class="p-2 bg-slate-600 rounded">
                                <div class="flex justify-between items-center">
                                    <span class="font-medium">Patrol Route Alpha-7</span>
                                    <span class="px-2 py-1 bg-green-600 text-xs rounded">Optimized</span>
                                </div>
                                <p class="text-xs text-slate-300 mt-1">Saved 45 minutes, 12L fuel</p>
                            </div>
                            <div class="p-2 bg-slate-600 rounded">
                                <div class="flex justify-between items-center">
                                    <span class="font-medium">Supply Run Bravo-3</span>
                                    <span class="px-2 py-1 bg-blue-600 text-xs rounded">In Progress</span>
                                </div>
                                <p class="text-xs text-slate-300 mt-1">Calculating optimal path...</p>
                            </div>
                            <div class="p-2 bg-slate-600 rounded">
                                <div class="flex justify-between items-center">
                                    <span class="font-medium">Training Transport</span>
                                    <span class="px-2 py-1 bg-yellow-600 text-xs rounded">Pending</span>
                                </div>
                                <p class="text-xs text-slate-300 mt-1">Weather delay affecting route</p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-purple-400">Route Efficiency Metrics</h3>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between">
                                <span class="text-sm">Average Speed</span>
                                <span class="text-green-400 font-semibold">+15%</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm">Fuel Consumption</span>
                                <span class="text-green-400 font-semibold">-23%</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm">On-Time Arrivals</span>
                                <span class="text-green-400 font-semibold">94%</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm">Route Deviations</span>
                                <span class="text-yellow-400 font-semibold">-8%</span>
                            </div>
                        </div>
                    </div>

                    <button class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded text-sm transition-colors" onclick="drillDown('route-optimization')">
                        View Detailed Route Analysis
                    </button>
                </div>
            </div>

            <!-- Usage Pattern Analysis -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <h2 class="text-xl font-bold mb-4">Usage Pattern Analysis</h2>
                
                <div class="space-y-4">
                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-yellow-400">Vehicle Utilization Patterns</h3>
                        <div style="height: 150px;">
                            <canvas id="usagePatternChart"></canvas>
                        </div>
                    </div>

                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-cyan-400">Peak Usage Analysis</h3>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="bg-slate-600 rounded p-3 text-center">
                                <p class="text-lg font-bold text-red-400">08:00</p>
                                <p class="text-xs text-slate-300">Peak Hour Start</p>
                            </div>
                            <div class="bg-slate-600 rounded p-3 text-center">
                                <p class="text-lg font-bold text-blue-400">78%</p>
                                <p class="text-xs text-slate-300">Peak Utilization</p>
                            </div>
                        </div>
                        <div class="mt-3 space-y-1 text-xs">
                            <div class="flex justify-between">
                                <span>Morning Rush (06:00-10:00):</span>
                                <span class="text-red-400">High Activity</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Midday (10:00-14:00):</span>
                                <span class="text-green-400">Normal Activity</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Evening (14:00-18:00):</span>
                                <span class="text-yellow-400">Moderate Activity</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Night (18:00-06:00):</span>
                                <span class="text-blue-400">Low Activity</span>
                            </div>
                        </div>
                    </div>

                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-orange-400">Usage Insights</h3>
                        <div class="space-y-2 text-sm">
                            <div class="p-2 bg-slate-600 rounded">
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="font-medium">Optimal Utilization</span>
                                </div>
                                <p class="text-xs text-slate-300 mt-1">1,450 vehicles (51%) operating efficiently</p>
                            </div>
                            <div class="p-2 bg-slate-600 rounded">
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-red-500 rounded-full"></div>
                                    <span class="font-medium">Overutilized</span>
                                </div>
                                <p class="text-xs text-slate-300 mt-1">240 vehicles (8%) exceeding recommended usage</p>
                            </div>
                            <div class="p-2 bg-slate-600 rounded">
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                    <span class="font-medium">Underutilized</span>
                                </div>
                                <p class="text-xs text-slate-300 mt-1">157 vehicles (6%) available for reallocation</p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-pink-400">Recommendations</h3>
                        <div class="space-y-1 text-xs">
                            <div class="flex items-center space-x-2">
                                <div class="w-1 h-1 bg-green-500 rounded-full"></div>
                                <span>Redistribute 45 vehicles from low-usage bases</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-1 h-1 bg-yellow-500 rounded-full"></div>
                                <span>Schedule maintenance during low-usage hours</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-1 h-1 bg-blue-500 rounded-full"></div>
                                <span>Implement staggered deployment schedules</span>
                            </div>
                        </div>
                    </div>

                    <button class="w-full bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded text-sm transition-colors" onclick="drillDown('usage-patterns')">
                        View Detailed Usage Analytics
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Fire Power Dashboard -->
    <div id="firepowerContent" class="p-6 space-y-6 hidden">
        <!-- Fire Power Key Metrics Cards -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div>
                    <p class="text-slate-400 text-sm">Total Weapons</p>
                    <p class="text-3xl font-bold text-green-400">18,450</p>
                    <p class="text-sm text-slate-300">All Categories</p>
                </div>
            </div>

            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div>
                    <p class="text-slate-400 text-sm">Operational</p>
                    <p class="text-3xl font-bold text-green-400">94%</p>
                    <p class="text-sm text-slate-300">17,343 weapons</p>
                </div>
            </div>

            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div>
                    <p class="text-slate-400 text-sm">Under Maintenance</p>
                    <p class="text-3xl font-bold text-yellow-400">4%</p>
                    <p class="text-sm text-slate-300">738 weapons</p>
                </div>
            </div>

            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div>
                    <p class="text-slate-400 text-sm">Ammunition Stock</p>
                    <p class="text-3xl font-bold text-yellow-400">68%</p>
                    <p class="text-sm text-slate-300">Below Optimal</p>
                </div>
            </div>
        </div>

        <!-- Charts Row -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Fire Power Type Distribution Chart -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold">Fire Power by Type & Quantity</h2>
                </div>
                <div style="height: 300px;">
                    <canvas id="firepowerTypeChart"></canvas>
                </div>
            </div>

            <!-- Usage by Operation Chart -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold">Usage by Operation</h2>
                    <select id="usageFilter" class="bg-slate-700 text-white px-3 py-1 rounded text-sm" onchange="updateUsageChart()">
                        <option value="all">All Activities</option>
                        <option value="operation">Operations Only</option>
                        <option value="training">Training Only</option>
                        <option value="unit">By Unit</option>
                    </select>
                </div>
                <div style="height: 300px;">
                    <canvas id="usageChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Tables and Notifications Row -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Expiry Date Table -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <h2 class="text-xl font-bold mb-4">Ammunition Expiry Schedule</h2>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead>
                            <tr class="border-b border-slate-600">
                                <th class="text-left py-2">Type</th>
                                <th class="text-left py-2">Quantity</th>
                                <th class="text-left py-2">Expiry Date</th>
                                <th class="text-left py-2">Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-slate-700">
                                <td class="py-2">5.56mm NATO</td>
                                <td class="py-2">450,000 rounds</td>
                                <td class="py-2">Mar 2025</td>
                                <td class="py-2"><span class="px-2 py-1 bg-yellow-600 text-xs rounded">Warning</span></td>
                            </tr>
                            <tr class="border-b border-slate-700">
                                <td class="py-2">7.62mm NATO</td>
                                <td class="py-2">280,000 rounds</td>
                                <td class="py-2">Jan 2025</td>
                                <td class="py-2"><span class="px-2 py-1 bg-red-600 text-xs rounded">Critical</span></td>
                            </tr>
                            <tr class="border-b border-slate-700">
                                <td class="py-2">40mm Grenades</td>
                                <td class="py-2">12,500 rounds</td>
                                <td class="py-2">Jun 2025</td>
                                <td class="py-2"><span class="px-2 py-1 bg-green-600 text-xs rounded">Good</span></td>
                            </tr>
                            <tr class="border-b border-slate-700">
                                <td class="py-2">155mm Artillery</td>
                                <td class="py-2">8,900 shells</td>
                                <td class="py-2">Feb 2025</td>
                                <td class="py-2"><span class="px-2 py-1 bg-yellow-600 text-xs rounded">Warning</span></td>
                            </tr>
                            <tr class="border-b border-slate-700">
                                <td class="py-2">120mm Mortar</td>
                                <td class="py-2">15,600 shells</td>
                                <td class="py-2">Aug 2025</td>
                                <td class="py-2"><span class="px-2 py-1 bg-green-600 text-xs rounded">Good</span></td>
                            </tr>
                            <tr>
                                <td class="py-2">Anti-Tank Missiles</td>
                                <td class="py-2">340 missiles</td>
                                <td class="py-2">Dec 2024</td>
                                <td class="py-2"><span class="px-2 py-1 bg-red-600 text-xs rounded">Expired</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Weapon Maintenance Notifications -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold">Weapon Maintenance Notifications</h2>
                    <div class="flex items-center space-x-2">
                        <div class="w-3 h-3 bg-red-500 rounded-full animate-pulse"></div>
                        <span class="text-sm text-red-400">12 Critical Alerts</span>
                    </div>
                </div>
                
                <div class="space-y-3">
                    <div class="bg-red-900 bg-opacity-30 border border-red-700 rounded-lg p-3">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-red-500 rounded-full animate-pulse"></div>
                                <span class="font-semibold text-red-400">CRITICAL - Overdue</span>
                            </div>
                            <button class="px-2 py-1 bg-red-600 text-xs rounded hover:bg-red-700" onclick="viewWeaponAlert('critical')">VIEW</button>
                        </div>
                        <p class="text-sm text-slate-300">M4A1 Rifles: Barrel replacement required (45 weapons)</p>
                        <p class="text-xs text-slate-400">Location: Kem Terendak | Overdue: 30 days</p>
                    </div>

                    <div class="bg-yellow-900 bg-opacity-30 border border-yellow-700 rounded-lg p-3">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
                                <span class="font-semibold text-yellow-400">WARNING - Due Soon</span>
                            </div>
                            <button class="px-2 py-1 bg-yellow-600 text-xs rounded hover:bg-yellow-700" onclick="viewWeaponAlert('warning')">VIEW</button>
                        </div>
                        <p class="text-sm text-slate-300">Artillery Systems: Calibration and inspection (12 units)</p>
                        <p class="text-xs text-slate-400">Location: Kem Gemas | Due: 7 days</p>
                    </div>

                    <div class="bg-blue-900 bg-opacity-30 border border-blue-700 rounded-lg p-3">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                <span class="font-semibold text-blue-400">SCHEDULED - Routine</span>
                            </div>
                            <button class="px-2 py-1 bg-blue-600 text-xs rounded hover:bg-blue-700" onclick="viewWeaponAlert('scheduled')">VIEW</button>
                        </div>
                        <p class="text-sm text-slate-300">Machine Guns: Cleaning and lubrication (156 weapons)</p>
                        <p class="text-xs text-slate-400">Location: Multiple | Due: 14 days</p>
                    </div>

                    <div class="bg-green-900 bg-opacity-30 border border-green-700 rounded-lg p-3">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                <span class="font-semibold text-green-400">COMPLETED - Recent</span>
                            </div>
                            <button class="px-2 py-1 bg-green-600 text-xs rounded hover:bg-green-700" onclick="viewWeaponAlert('completed')">VIEW</button>
                        </div>
                        <p class="text-sm text-slate-300">Sniper Rifles: Scope calibration completed (24 weapons)</p>
                        <p class="text-xs text-slate-400">Location: Kem Wardieburn | Completed: 2 days ago</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ammunition Usage Forecasting -->
        <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold">Ammunition Usage Forecasting</h2>
                <div class="flex items-center space-x-2">
                    <div class="w-3 h-3 bg-blue-500 rounded-full animate-pulse"></div>
                    <span class="text-sm text-blue-400">AI Prediction Active</span>
                </div>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Mission Selection -->
                <div class="bg-slate-700 rounded-lg p-4">
                    <h3 class="font-semibold mb-3 text-green-400">Select Training/Mission Type</h3>
                    
                    <!-- Search/Dropdown -->
                    <div class="relative mb-4">
                        <input 
                            type="text" 
                            id="missionSearch" 
                            placeholder="Search missions or select from dropdown..."
                            class="w-full bg-slate-600 text-white px-3 py-2 rounded border border-slate-500 focus:border-blue-400 focus:outline-none"
                            onkeyup="filterMissions()"
                            onfocus="showMissionDropdown()"
                        >
                        <div id="missionDropdown" class="absolute top-full left-0 right-0 bg-slate-600 border border-slate-500 rounded-b max-h-48 overflow-y-auto z-10 hidden">
                            <div class="mission-option p-2 hover:bg-slate-500 cursor-pointer" onclick="selectMission('border-patrol')">
                                <div class="font-semibold">Border Patrol Operation</div>
                                <div class="text-xs text-slate-300">Routine border security mission</div>
                            </div>
                            <div class="mission-option p-2 hover:bg-slate-500 cursor-pointer" onclick="selectMission('counter-terrorism')">
                                <div class="font-semibold">Counter-Terrorism Exercise</div>
                                <div class="text-xs text-slate-300">High-intensity combat training</div>
                            </div>
                            <div class="mission-option p-2 hover:bg-slate-500 cursor-pointer" onclick="selectMission('live-fire-training')">
                                <div class="font-semibold">Live Fire Training</div>
                                <div class="text-xs text-slate-300">Standard marksmanship training</div>
                            </div>
                            <div class="mission-option p-2 hover:bg-slate-500 cursor-pointer" onclick="selectMission('joint-exercise')">
                                <div class="font-semibold">Joint Military Exercise</div>
                                <div class="text-xs text-slate-300">Multi-unit coordination training</div>
                            </div>
                            <div class="mission-option p-2 hover:bg-slate-500 cursor-pointer" onclick="selectMission('urban-warfare')">
                                <div class="font-semibold">Urban Warfare Training</div>
                                <div class="text-xs text-slate-300">Close quarters combat simulation</div>
                            </div>
                            <div class="mission-option p-2 hover:bg-slate-500 cursor-pointer" onclick="selectMission('artillery-exercise')">
                                <div class="font-semibold">Artillery Exercise</div>
                                <div class="text-xs text-slate-300">Long-range fire support training</div>
                            </div>
                            <div class="mission-option p-2 hover:bg-slate-500 cursor-pointer" onclick="selectMission('peacekeeping')">
                                <div class="font-semibold">Peacekeeping Mission</div>
                                <div class="text-xs text-slate-300">International deployment</div>
                            </div>
                            <div class="mission-option p-2 hover:bg-slate-500 cursor-pointer" onclick="selectMission('disaster-response')">
                                <div class="font-semibold">Disaster Response</div>
                                <div class="text-xs text-slate-300">Humanitarian assistance operation</div>
                            </div>
                        </div>
                    </div>

                    <!-- Mission Attributes -->
                    <div id="missionAttributes" class="space-y-3">
                        <div class="text-center text-slate-400 py-8">
                            <span class="text-4xl">🎯</span>
                            <p class="mt-2">Select a mission type to view attributes and ammunition forecast</p>
                        </div>
                    </div>
                </div>

                <!-- Ammunition Usage Prediction -->
                <div class="bg-slate-700 rounded-lg p-4">
                    <h3 class="font-semibold mb-3 text-blue-400">Ammunition Usage Prediction</h3>
                    
                    <div id="usagePrediction" class="space-y-4">
                        <div class="text-center text-slate-400 py-8">
                            <span class="text-4xl">📊</span>
                            <p class="mt-2">Prediction will appear after mission selection</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Historical Comparison -->
            <div id="historicalComparison" class="mt-6 bg-slate-700 rounded-lg p-4 hidden">
                <h3 class="font-semibold mb-3 text-purple-400">Historical Comparison & Recommendations</h3>
                <div id="comparisonContent"></div>
            </div>
        </div>

        <!-- Weapon System Health Monitoring -->
        <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold">Weapon System Health Monitoring</h2>
                <div class="flex items-center space-x-2">
                    <select id="weaponSystemFilter" class="bg-slate-700 text-white px-3 py-1 rounded text-sm" onchange="updateWeaponHealthChart()">
                        <option value="heavy">Heavy Weapons</option>
                        <option value="artillery">Artillery Systems</option>
                        <option value="air-defense">Air Defense</option>
                        <option value="all">All Systems</option>
                    </select>
                    <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                    <span class="text-sm text-green-400">Real-time Monitoring</span>
                </div>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Performance Chart -->
                <div class="bg-slate-700 rounded-lg p-4">
                    <h3 class="font-semibold mb-3 text-blue-400">Heavy Weapon Performance Trends</h3>
                    <div style="height: 250px;">
                        <canvas id="weaponHealthChart"></canvas>
                    </div>
                </div>

                <!-- System Status Overview -->
                <div class="bg-slate-700 rounded-lg p-4">
                    <h3 class="font-semibold mb-3 text-green-400">System Health Overview</h3>
                    <div class="space-y-3">
                        <div class="bg-slate-600 rounded p-3">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-medium">M240 Machine Guns</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                                    <span class="px-2 py-1 bg-green-600 text-xs rounded">Optimal</span>
                                </div>
                            </div>
                            <div class="grid grid-cols-3 gap-2 text-xs">
                                <div class="text-center">
                                    <p class="text-green-400 font-bold">94%</p>
                                    <p class="text-slate-300">Accuracy</p>
                                </div>
                                <div class="text-center">
                                    <p class="text-blue-400 font-bold">2,450</p>
                                    <p class="text-slate-300">Rounds/min</p>
                                </div>
                                <div class="text-center">
                                    <p class="text-green-400 font-bold">98%</p>
                                    <p class="text-slate-300">Reliability</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-slate-600 rounded p-3">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-medium">155mm Howitzers</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
                                    <span class="px-2 py-1 bg-yellow-600 text-xs rounded">Caution</span>
                                </div>
                            </div>
                            <div class="grid grid-cols-3 gap-2 text-xs">
                                <div class="text-center">
                                    <p class="text-yellow-400 font-bold">87%</p>
                                    <p class="text-slate-300">Accuracy</p>
                                </div>
                                <div class="text-center">
                                    <p class="text-blue-400 font-bold">4</p>
                                    <p class="text-slate-300">Rounds/min</p>
                                </div>
                                <div class="text-center">
                                    <p class="text-yellow-400 font-bold">82%</p>
                                    <p class="text-slate-300">Reliability</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-slate-600 rounded p-3">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-medium">Anti-Tank Systems</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-red-500 rounded-full animate-pulse"></div>
                                    <span class="px-2 py-1 bg-red-600 text-xs rounded">Alert</span>
                                </div>
                            </div>
                            <div class="grid grid-cols-3 gap-2 text-xs">
                                <div class="text-center">
                                    <p class="text-red-400 font-bold">76%</p>
                                    <p class="text-slate-300">Accuracy</p>
                                </div>
                                <div class="text-center">
                                    <p class="text-blue-400 font-bold">1</p>
                                    <p class="text-slate-300">Rounds/min</p>
                                </div>
                                <div class="text-center">
                                    <p class="text-red-400 font-bold">68%</p>
                                    <p class="text-slate-300">Reliability</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Health Metrics and Alerts -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mt-6">
                <div class="bg-slate-700 rounded-lg p-4">
                    <h3 class="font-semibold mb-3 text-purple-400">Predictive Maintenance</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>Systems at Risk:</span>
                            <span class="text-red-400">12 weapons</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Maintenance Due:</span>
                            <span class="text-yellow-400">45 weapons</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Optimal Performance:</span>
                            <span class="text-green-400">156 weapons</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Avg. Lifespan:</span>
                            <span class="text-blue-400">15.2 years</span>
                        </div>
                    </div>
                </div>

                <div class="bg-slate-700 rounded-lg p-4">
                    <h3 class="font-semibold mb-3 text-cyan-400">Performance Analytics</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>Avg. Accuracy:</span>
                            <span class="text-green-400">89.2%</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Reliability Score:</span>
                            <span class="text-green-400">91.5%</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Maintenance Efficiency:</span>
                            <span class="text-blue-400">87.8%</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Downtime Reduction:</span>
                            <span class="text-green-400">-23%</span>
                        </div>
                    </div>
                </div>

                <div class="bg-slate-700 rounded-lg p-4">
                    <h3 class="font-semibold mb-3 text-orange-400">Critical Alerts</h3>
                    <div class="space-y-2 text-sm">
                        <div class="p-2 bg-red-900 bg-opacity-30 rounded border border-red-700">
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-red-500 rounded-full animate-pulse"></div>
                                <span class="font-medium">Barrel Wear Critical</span>
                            </div>
                            <p class="text-xs text-slate-300 mt-1">8 systems require immediate attention</p>
                        </div>
                        <div class="p-2 bg-yellow-900 bg-opacity-30 rounded border border-yellow-700">
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
                                <span class="font-medium">Calibration Drift</span>
                            </div>
                            <p class="text-xs text-slate-300 mt-1">15 systems need recalibration</p>
                        </div>
                        <div class="p-2 bg-blue-900 bg-opacity-30 rounded border border-blue-700">
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                <span class="font-medium">Scheduled Service</span>
                            </div>
                            <p class="text-xs text-slate-300 mt-1">22 systems due for maintenance</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Targeting Simulation and Effectiveness Analysis -->
        <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold">Targeting Simulation & Effectiveness Analysis</h2>
                <div class="flex items-center space-x-2">
                    <button id="runSimulationBtn" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm transition-colors" onclick="runTargetingSimulation()">
                        Run New Simulation
                    </button>
                    <div class="w-3 h-3 bg-blue-500 rounded-full animate-pulse"></div>
                    <span class="text-sm text-blue-400">AI Analysis Active</span>
                </div>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Simulation Controls -->
                <div class="bg-slate-700 rounded-lg p-4">
                    <h3 class="font-semibold mb-3 text-green-400">Simulation Parameters</h3>
                    
                    <div class="space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-1">Target Type</label>
                                <select id="targetType" class="w-full bg-slate-600 text-white px-3 py-2 rounded border border-slate-500">
                                    <option value="armored">Armored Vehicles</option>
                                    <option value="infantry">Infantry Positions</option>
                                    <option value="structures">Fixed Structures</option>
                                    <option value="aircraft">Aircraft</option>
                                    <option value="naval">Naval Targets</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1">Range (km)</label>
                                <select id="targetRange" class="w-full bg-slate-600 text-white px-3 py-2 rounded border border-slate-500">
                                    <option value="close">0.5 - 2 km</option>
                                    <option value="medium">2 - 10 km</option>
                                    <option value="long">10 - 30 km</option>
                                    <option value="extreme">30+ km</option>
                                </select>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-1">Weather Conditions</label>
                                <select id="weatherConditions" class="w-full bg-slate-600 text-white px-3 py-2 rounded border border-slate-500">
                                    <option value="clear">Clear</option>
                                    <option value="rain">Rain</option>
                                    <option value="fog">Fog/Mist</option>
                                    <option value="wind">High Wind</option>
                                    <option value="night">Night Operations</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1">Terrain Type</label>
                                <select id="terrainType" class="w-full bg-slate-600 text-white px-3 py-2 rounded border border-slate-500">
                                    <option value="urban">Urban</option>
                                    <option value="forest">Forest</option>
                                    <option value="desert">Desert</option>
                                    <option value="mountain">Mountain</option>
                                    <option value="coastal">Coastal</option>
                                </select>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium mb-1">Weapon System</label>
                            <select id="weaponSystem" class="w-full bg-slate-600 text-white px-3 py-2 rounded border border-slate-500">
                                <option value="m240">M240 Machine Gun</option>
                                <option value="howitzer">155mm Howitzer</option>
                                <option value="mortar">120mm Mortar</option>
                                <option value="antitank">Anti-Tank Missile</option>
                                <option value="sniper">Sniper System</option>
                            </select>
                        </div>
                    </div>

                    <div class="mt-4 p-3 bg-slate-600 rounded">
                        <h4 class="font-semibold mb-2 text-sm">Current Simulation</h4>
                        <div id="currentSimulation" class="space-y-1 text-xs">
                            <div class="flex justify-between">
                                <span>Status:</span>
                                <span class="text-green-400">Ready</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Last Run:</span>
                                <span class="text-blue-400">2 hours ago</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Scenarios Tested:</span>
                                <span class="text-yellow-400">1,247</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Effectiveness Results -->
                <div class="bg-slate-700 rounded-lg p-4">
                    <h3 class="font-semibold mb-3 text-blue-400">Effectiveness Analysis Results</h3>
                    
                    <div id="simulationResults" class="space-y-4">
                        <div class="bg-slate-600 rounded p-3">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-medium">Hit Probability</span>
                                <span class="text-2xl font-bold text-green-400">94.2%</span>
                            </div>
                            <div class="w-full bg-slate-500 rounded-full h-2">
                                <div class="bg-green-500 h-2 rounded-full" style="width: 94.2%"></div>
                            </div>
                            <p class="text-xs text-slate-300 mt-1">Based on current conditions and weapon system</p>
                        </div>

                        <div class="bg-slate-600 rounded p-3">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-medium">Kill Probability</span>
                                <span class="text-2xl font-bold text-yellow-400">87.5%</span>
                            </div>
                            <div class="w-full bg-slate-500 rounded-full h-2">
                                <div class="bg-yellow-500 h-2 rounded-full" style="width: 87.5%"></div>
                            </div>
                            <p class="text-xs text-slate-300 mt-1">Target neutralization effectiveness</p>
                        </div>

                        <div class="bg-slate-600 rounded p-3">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-medium">Collateral Risk</span>
                                <span class="text-2xl font-bold text-green-400">12.3%</span>
                            </div>
                            <div class="w-full bg-slate-500 rounded-full h-2">
                                <div class="bg-green-500 h-2 rounded-full" style="width: 12.3%"></div>
                            </div>
                            <p class="text-xs text-slate-300 mt-1">Minimal collateral damage probability</p>
                        </div>

                        <div class="grid grid-cols-2 gap-3">
                            <div class="bg-slate-600 rounded p-2 text-center">
                                <p class="text-lg font-bold text-blue-400">2.3s</p>
                                <p class="text-xs text-slate-300">Time to Target</p>
                            </div>
                            <div class="bg-slate-600 rounded p-2 text-center">
                                <p class="text-lg font-bold text-green-400">98.7%</p>
                                <p class="text-xs text-slate-300">System Reliability</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Advanced Analytics -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mt-6">
                <div class="bg-slate-700 rounded-lg p-4">
                    <h3 class="font-semibold mb-3 text-purple-400">Environmental Impact Analysis</h3>
                    <div class="space-y-3">
                        <div class="bg-slate-600 rounded p-2">
                            <div class="flex justify-between mb-1">
                                <span class="text-sm">Weather Effect</span>
                                <span class="text-yellow-400 font-semibold">-8%</span>
                            </div>
                            <div class="w-full bg-slate-500 rounded-full h-1">
                                <div class="bg-yellow-500 h-1 rounded-full" style="width: 8%"></div>
                            </div>
                        </div>
                        <div class="bg-slate-600 rounded p-2">
                            <div class="flex justify-between mb-1">
                                <span class="text-sm">Terrain Modifier</span>
                                <span class="text-green-400 font-semibold">+5%</span>
                            </div>
                            <div class="w-full bg-slate-500 rounded-full h-1">
                                <div class="bg-green-500 h-1 rounded-full" style="width: 5%"></div>
                            </div>
                        </div>
                        <div class="bg-slate-600 rounded p-2">
                            <div class="flex justify-between mb-1">
                                <span class="text-sm">Range Penalty</span>
                                <span class="text-red-400 font-semibold">-12%</span>
                            </div>
                            <div class="w-full bg-slate-500 rounded-full h-1">
                                <div class="bg-red-500 h-1 rounded-full" style="width: 12%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-slate-700 rounded-lg p-4">
                    <h3 class="font-semibold mb-3 text-cyan-400">Ammunition Optimization</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>Recommended Rounds:</span>
                            <span class="text-green-400">3-5 rounds</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Optimal Ammunition:</span>
                            <span class="text-blue-400">APFSDS</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Success Probability:</span>
                            <span class="text-green-400">96.8%</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Cost per Engagement:</span>
                            <span class="text-yellow-400">RM 2,450</span>
                        </div>
                    </div>
                </div>

                <div class="bg-slate-700 rounded-lg p-4">
                    <h3 class="font-semibold mb-3 text-orange-400">Tactical Recommendations</h3>
                    <div class="space-y-2 text-sm">
                        <div class="p-2 bg-green-900 bg-opacity-30 rounded border border-green-700">
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                <span class="font-medium">Optimal Engagement</span>
                            </div>
                            <p class="text-xs text-slate-300 mt-1">Current conditions favor engagement</p>
                        </div>
                        <div class="p-2 bg-blue-900 bg-opacity-30 rounded border border-blue-700">
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                <span class="font-medium">Adjust Elevation +2°</span>
                            </div>
                            <p class="text-xs text-slate-300 mt-1">Compensate for wind conditions</p>
                        </div>
                        <div class="p-2 bg-yellow-900 bg-opacity-30 rounded border border-yellow-700">
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
                                <span class="font-medium">Consider Alternative</span>
                            </div>
                            <p class="text-xs text-slate-300 mt-1">Mortar may be more effective</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Detailed Fire Power Analysis -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Ammunition Inventory Status -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <h2 class="text-xl font-bold mb-4">Ammunition Inventory Status</h2>
                <div class="space-y-4">
                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-green-400">Current Stock Levels</h3>
                        <div class="space-y-3">
                            <div>
                                <div class="flex justify-between mb-1"><span class="text-sm">Small Arms</span><span class="text-green-400">85%</span></div>
                                <div class="w-full bg-slate-600 rounded-full h-2"><div class="bg-green-500 h-2 rounded-full" style="width: 85%"></div></div>
                            </div>
                            <div>
                                <div class="flex justify-between mb-1"><span class="text-sm">Artillery</span><span class="text-yellow-400">45%</span></div>
                                <div class="w-full bg-slate-600 rounded-full h-2"><div class="bg-yellow-500 h-2 rounded-full" style="width: 45%"></div></div>
                            </div>
                            <div>
                                <div class="flex justify-between mb-1"><span class="text-sm">Anti-Tank</span><span class="text-red-400">25%</span></div>
                                <div class="w-full bg-slate-600 rounded-full h-2"><div class="bg-red-500 h-2 rounded-full" style="width: 25%"></div></div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-blue-400">Monthly Consumption</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span>Training Exercises:</span>
                                <span class="text-blue-400">65%</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Live Operations:</span>
                                <span class="text-yellow-400">25%</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Testing & Trials:</span>
                                <span class="text-green-400">10%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Weapon System Readiness -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <h2 class="text-xl font-bold mb-4">Weapon System Readiness</h2>
                <div class="space-y-4">
                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-purple-400">Readiness by Category</h3>
                        <div class="space-y-2 text-sm">
                            <div class="p-2 bg-slate-600 rounded">
                                <div class="flex justify-between items-center">
                                    <span class="font-medium">Small Arms</span>
                                    <span class="px-2 py-1 bg-green-600 text-xs rounded">96%</span>
                                </div>
                                <p class="text-xs text-slate-300 mt-1">15,450 weapons operational</p>
                            </div>
                            <div class="p-2 bg-slate-600 rounded">
                                <div class="flex justify-between items-center">
                                    <span class="font-medium">Heavy Weapons</span>
                                    <span class="px-2 py-1 bg-yellow-600 text-xs rounded">78%</span>
                                </div>
                                <p class="text-xs text-slate-300 mt-1">890 systems operational</p>
                            </div>
                            <div class="p-2 bg-slate-600 rounded">
                                <div class="flex justify-between items-center">
                                    <span class="font-medium">Artillery</span>
                                    <span class="px-2 py-1 bg-yellow-600 text-xs rounded">82%</span>
                                </div>
                                <p class="text-xs text-slate-300 mt-1">156 systems operational</p>
                            </div>
                            <div class="p-2 bg-slate-600 rounded">
                                <div class="flex justify-between items-center">
                                    <span class="font-medium">Air Defense</span>
                                    <span class="px-2 py-1 bg-green-600 text-xs rounded">94%</span>
                                </div>
                                <p class="text-xs text-slate-300 mt-1">45 systems operational</p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-orange-400">Critical Issues</h3>
                        <div class="space-y-1 text-xs">
                            <div class="flex items-center space-x-2">
                                <div class="w-1 h-1 bg-red-500 rounded-full"></div>
                                <span>45 rifles need barrel replacement</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-1 h-1 bg-yellow-500 rounded-full"></div>
                                <span>12 artillery systems need calibration</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-1 h-1 bg-blue-500 rounded-full"></div>
                                <span>156 weapons scheduled maintenance</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Fire Power Performance Metrics -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <h2 class="text-xl font-bold mb-4">Performance Metrics</h2>
                <div class="space-y-4">
                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-cyan-400">Accuracy & Effectiveness</h3>
                        <div class="grid grid-cols-2 gap-4 text-center">
                            <div class="bg-slate-600 rounded p-3">
                                <p class="text-lg font-bold text-green-400">94.2%</p>
                                <p class="text-xs text-slate-300">Marksmanship Score</p>
                            </div>
                            <div class="bg-slate-600 rounded p-3">
                                <p class="text-lg font-bold text-blue-400">87.5%</p>
                                <p class="text-xs text-slate-300">Mission Success</p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-pink-400">Training Statistics</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span>Qualified Marksmen:</span>
                                <span class="text-green-400">22,450</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Expert Shooters:</span>
                                <span class="text-blue-400">8,920</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Weapon Specialists:</span>
                                <span class="text-purple-400">2,340</span>
                            </div>
                        </div>
                    </div>

                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-semibold mb-3 text-yellow-400">Maintenance Efficiency</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span>Avg Repair Time:</span>
                                <span class="text-green-400">2.3 days</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Parts Availability:</span>
                                <span class="text-yellow-400">78%</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Technician Utilization:</span>
                                <span class="text-blue-400">85%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Drill Down Modal -->
    <div id="drillDownModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-slate-800 rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h2 id="modalTitle" class="text-2xl font-bold"></h2>
                <button onclick="closeModal()" class="text-slate-400 hover:text-white text-2xl">&times;</button>
            </div>
            <div id="modalContent" class="space-y-4">
                <!-- Dynamic content will be inserted here -->
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Force all chart text to white for clarity
        if (window.Chart) {
            Chart.defaults.color = '#ffffff';
            Chart.defaults.plugins.legend.labels.color = '#ffffff';
        }
        // Initialize timestamp and real-time updates on page load
        updateTimestamp();
        setInterval(updateTimestamp, 60000); // Update every minute
        setInterval(updateRealTimeData, 30000); // Update data every 30 seconds
        
        // Initialize workforce planning charts on page load
        setTimeout(() => {
            initializeWorkforceCharts();
        }, 500);

        // Update timestamp
        function updateTimestamp() {
            const now = new Date();
            document.getElementById('lastUpdate').textContent = now.toLocaleString();
        }

        // Simulate real-time data updates
        function updateRealTimeData() {
            // Simulate small changes in personnel readiness
            const personnelReadiness = document.querySelector('.text-3xl.font-bold.text-green-400');
            if (personnelReadiness && personnelReadiness.textContent.includes('%')) {
                const currentValue = parseFloat(personnelReadiness.textContent);
                const variation = (Math.random() - 0.5) * 0.4; // ±0.2% variation
                const newValue = Math.max(90, Math.min(95, currentValue + variation));
                personnelReadiness.textContent = newValue.toFixed(1) + '%';
                
                // Add a subtle flash animation
                personnelReadiness.style.transition = 'all 0.3s ease';
                personnelReadiness.style.transform = 'scale(1.05)';
                setTimeout(() => {
                    personnelReadiness.style.transform = 'scale(1)';
                }, 300);
            }

            // Update chart data if charts are initialized
            if (personnelChart) {
                // Small random variations in personnel data
                personnelChart.data.datasets.forEach(dataset => {
                    dataset.data = dataset.data.map(value => {
                        const variation = (Math.random() - 0.5) * 10; // ±5 personnel variation
                        return Math.max(0, Math.round(value + variation));
                    });
                });
                personnelChart.update('none'); // Update without animation
            }

            // Update overall readiness percentage
            const overallReadiness = document.querySelector('.text-green-400 span');
            if (overallReadiness) {
                const currentValue = parseFloat(overallReadiness.textContent);
                const variation = (Math.random() - 0.5) * 0.6; // ±0.3% variation
                const newValue = Math.max(85, Math.min(90, currentValue + variation));
                overallReadiness.textContent = newValue.toFixed(0) + '%';
            }
        }

        // Tab switching functionality
        function switchTab(tab) {
            const dashboardContent = document.getElementById('dashboardContent');
            const hrContent = document.getElementById('hrContent');
            const mobilityContent = document.getElementById('mobilityContent');
            const firepowerContent = document.getElementById('firepowerContent');
            const dashboardTab = document.getElementById('dashboardTab');
            const hrTab = document.getElementById('hrTab');
            const mobilityTab = document.getElementById('mobilityTab');
            const firepowerTab = document.getElementById('firepowerTab');

            // Hide all content
            dashboardContent.classList.add('hidden');
            hrContent.classList.add('hidden');
            mobilityContent.classList.add('hidden');
            firepowerContent.classList.add('hidden');

            // Reset all tabs
            dashboardTab.classList.add('border-transparent', 'text-blue-200');
            dashboardTab.classList.remove('border-yellow-500', 'text-yellow-400');
            hrTab.classList.add('border-transparent', 'text-blue-200');
            hrTab.classList.remove('border-yellow-500', 'text-yellow-400');
            mobilityTab.classList.add('border-transparent', 'text-blue-200');
            mobilityTab.classList.remove('border-yellow-500', 'text-yellow-400');
            firepowerTab.classList.add('border-transparent', 'text-blue-200');
            firepowerTab.classList.remove('border-yellow-500', 'text-yellow-400');

            if (tab === 'dashboard') {
                dashboardContent.classList.remove('hidden');
                dashboardTab.classList.add('border-yellow-500', 'text-yellow-400');
                dashboardTab.classList.remove('border-transparent', 'text-blue-200');
            } else if (tab === 'hr') {
                hrContent.classList.remove('hidden');
                hrTab.classList.add('border-yellow-500', 'text-yellow-400');
                hrTab.classList.remove('border-transparent', 'text-blue-200');
                
                // Initialize HR charts when HR tab is opened
                setTimeout(() => {
                    initializeHRCharts();
                }, 100);
            } else if (tab === 'mobility') {
                mobilityContent.classList.remove('hidden');
                mobilityTab.classList.add('border-yellow-500', 'text-yellow-400');
                mobilityTab.classList.remove('border-transparent', 'text-blue-200');
                
                // Initialize mobility charts when mobility tab is opened
                setTimeout(() => {
                    initializeMobilityCharts();
                }, 100);
            } else if (tab === 'firepower') {
                firepowerContent.classList.remove('hidden');
                firepowerTab.classList.add('border-yellow-500', 'text-yellow-400');
                firepowerTab.classList.remove('border-transparent', 'text-blue-200');
                
                // Initialize firepower charts when firepower tab is opened
                setTimeout(() => {
                    initializeFirepowerCharts();
                }, 100);
            }
        }

        // Chart initialization
        let personnelChart = null;
        let appointmentChart = null;
        let vehicleTypeChart = null;
        let locationChart = null;
        let firepowerTypeChart = null;
        let usageChart = null;
        let retirementForecastChart = null;
        let recruitmentNeedsChart = null;
        let trainingStatusChart = null;
        let medicalStatusChart = null;
        let fitnessPassChart = null;
        let injuryTypeChart = null;
        let sickDaysTrendChart = null;

        // Initialize workforce planning charts
        function initializeWorkforceCharts() {
            // Retirement Forecast Chart
            const retirementCtx = document.getElementById('retirementForecastChart');
            if (retirementCtx && !retirementForecastChart) {
                retirementForecastChart = new Chart(retirementCtx, {
                    type: 'line',
                    data: {
                        labels: ['2025', '2026', '2027', '2028', '2029'],
                        datasets: [{
                            label: 'Projected Retirements',
                            data: [1240, 1380, 1520, 1450, 1320],
                            borderColor: '#ef4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointBackgroundColor: '#ef4444',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            pointRadius: 5,
                            pointHoverRadius: 7
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'rgba(15, 23, 42, 0.9)',
                                titleColor: '#e2e8f0',
                                bodyColor: '#cbd5e1',
                                borderColor: '#475569',
                                borderWidth: 1,
                                cornerRadius: 8,
                                callbacks: {
                                    label: function(context) {
                                        return `${context.raw.toLocaleString()} personnel retiring`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: '#94a3b8',
                                    font: { size: 11 }
                                },
                                grid: { display: false }
                            },
                            y: {
                                ticks: {
                                    color: '#94a3b8',
                                    font: { size: 11 },
                                    callback: function(value) {
                                        return value.toLocaleString();
                                    }
                                },
                                grid: { color: '#374151' }
                            }
                        }
                    }
                });
            }

            // Recruitment Needs Chart
            const recruitmentCtx = document.getElementById('recruitmentNeedsChart');
            if (recruitmentCtx && !recruitmentNeedsChart) {
                recruitmentNeedsChart = new Chart(recruitmentCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Officers', 'NCOs', 'Specialists'],
                        datasets: [{
                            data: [180, 450, 320],
                            backgroundColor: ['#10b981', '#f59e0b', '#ef4444'],
                            borderColor: ['#059669', '#d97706', '#dc2626'],
                            borderWidth: 2,
                            hoverBackgroundColor: ['#34d399', '#fbbf24', '#f87171'],
                            hoverOffset: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: '#e2e8f0',
                                    usePointStyle: true,
                                    padding: 15,
                                    font: { size: 11 }
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(15, 23, 42, 0.9)',
                                titleColor: '#e2e8f0',
                                bodyColor: '#cbd5e1',
                                borderColor: '#475569',
                                borderWidth: 1,
                                cornerRadius: 8,
                                callbacks: {
                                    label: function(context) {
                                        return `${context.label}: ${context.raw} needed`;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Skill Match Chart
            const skillMatchCtx = document.getElementById('skillMatchChart');
            if (skillMatchCtx) {
                new Chart(skillMatchCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Perfect Match', 'Good Match', 'Needs Training'],
                        datasets: [{
                            data: [18450, 4890, 1240],
                            backgroundColor: ['#10b981', '#3b82f6', '#f59e0b'],
                            borderColor: ['#059669', '#2563eb', '#d97706'],
                            borderWidth: 2,
                            hoverBackgroundColor: ['#34d399', '#60a5fa', '#fbbf24'],
                            hoverOffset: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: '#e2e8f0',
                                    usePointStyle: true,
                                    padding: 10,
                                    font: { size: 10 }
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(15, 23, 42, 0.9)',
                                titleColor: '#e2e8f0',
                                bodyColor: '#cbd5e1',
                                borderColor: '#475569',
                                borderWidth: 1,
                                cornerRadius: 8,
                                callbacks: {
                                    label: function(context) {
                                        const total = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                                        const percentage = ((context.raw / total) * 100).toFixed(1);
                                        return `${context.label}: ${context.raw.toLocaleString()} (${percentage}%)`;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Transfer Recommendations Chart
            const transferCtx = document.getElementById('transferRecommendationsChart');
            if (transferCtx) {
                new Chart(transferCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Sgt. Ahmad', 'Lt. Sarah', 'Cpl. Raj'],
                        datasets: [{
                            label: 'Match %',
                            data: [98, 95, 92],
                            backgroundColor: ['#10b981', '#3b82f6', '#8b5cf6'],
                            borderColor: ['#059669', '#2563eb', '#7c3aed'],
                            borderWidth: 2,
                            borderRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            x: {
                                ticks: { color: '#94a3b8', font: { size: 10 } },
                                grid: { display: false }
                            },
                            y: {
                                ticks: { 
                                    color: '#94a3b8', 
                                    font: { size: 10 },
                                    callback: function(value) { return value + '%'; }
                                },
                                grid: { color: '#374151' },
                                min: 85,
                                max: 100
                            }
                        }
                    }
                });
            }

            // Attrition Risk Chart
            const attritionCtx = document.getElementById('attritionRiskChart');
            if (attritionCtx) {
                new Chart(attritionCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Low Risk', 'Medium Risk', 'High Risk'],
                        datasets: [{
                            data: [17550, 4890, 2140],
                            backgroundColor: ['#10b981', '#f59e0b', '#ef4444'],
                            borderColor: ['#059669', '#d97706', '#dc2626'],
                            borderWidth: 2,
                            hoverBackgroundColor: ['#34d399', '#fbbf24', '#f87171'],
                            hoverOffset: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: '#e2e8f0',
                                    usePointStyle: true,
                                    padding: 10,
                                    font: { size: 10 }
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(15, 23, 42, 0.9)',
                                titleColor: '#e2e8f0',
                                bodyColor: '#cbd5e1',
                                borderColor: '#475569',
                                borderWidth: 1,
                                cornerRadius: 8,
                                callbacks: {
                                    label: function(context) {
                                        const total = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                                        const percentage = ((context.raw / total) * 100).toFixed(1);
                                        return `${context.label}: ${context.raw.toLocaleString()} (${percentage}%)`;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Risk Factors Chart
            const riskFactorsCtx = document.getElementById('riskFactorsChart');
            if (riskFactorsCtx) {
                new Chart(riskFactorsCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Work-Life', 'Career', 'Compensation', 'Job Satisfaction'],
                        datasets: [{
                            label: 'Risk Impact %',
                            data: [75, 60, 45, 30],
                            backgroundColor: ['#ef4444', '#f59e0b', '#f59e0b', '#10b981'],
                            borderColor: ['#dc2626', '#d97706', '#d97706', '#059669'],
                            borderWidth: 2,
                            borderRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            x: {
                                ticks: { color: '#94a3b8', font: { size: 10 } },
                                grid: { display: false }
                            },
                            y: {
                                ticks: { 
                                    color: '#94a3b8', 
                                    font: { size: 10 },
                                    callback: function(value) { return value + '%'; }
                                },
                                grid: { color: '#374151' },
                                min: 0,
                                max: 80
                            }
                        }
                    }
                });
            }
        }

        function initializeHRCharts() {
            // ensure enhanced health charts can re-render on timeframe change
            window.updateMedicalFitnessTimeframe = function() {
                const range = document.getElementById('medTimeFilter')?.value || '90';
                // simple scaling factors to simulate timeframe effect
                const scale = range === '30' ? 0.35 : range === '90' ? 1 : 3.5;

                // Update sick days trend
                if (sickDaysTrendChart) {
                    const base = [320, 280, 340, 300, 265, 290];
                    sickDaysTrendChart.data.datasets[0].data = base.map(v => Math.round(v * (range === '30' ? 0.5 : range === '90' ? 1 : 4)));
                    sickDaysTrendChart.update('none');
                }

                // Update fitness pass/fail roughly based on timeframe (visual only)
                if (fitnessPassChart) {
                    const passBase = [82, 78, 75, 80, 85, 92];
                    const failBase = passBase.map(v => 100 - v);
                    fitnessPassChart.data.datasets[0].data = passBase.map(v => Math.max(60, Math.min(96, Math.round(v + (range === '30' ? 2 : range === '365' ? -2 : 0)))));
                    fitnessPassChart.data.datasets[1].data = fitnessPassChart.data.datasets[0].data.map(v => 100 - v);
                    fitnessPassChart.update('none');
                }

                // Update injury counts proportionally
                if (injuryTypeChart) {
                    const base = [320, 210, 185, 96, 74];
                    injuryTypeChart.data.datasets[0].data = base.map(v => Math.round(v * scale));
                    injuryTypeChart.update('none');
                }
            };
            // Personnel by Rank and Corps Chart (Interactive Stacked Bar)
            const personnelCtx = document.getElementById('personnelChart');
            if (personnelCtx && !personnelChart) {
                personnelChart = new Chart(personnelCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Infantry', 'Armored', 'Artillery', 'Engineering', 'Medical', 'Special Forces'],
                        datasets: [
                            {
                                label: 'Officers',
                                data: [450, 180, 120, 200, 80, 45],
                                backgroundColor: '#10b981',
                                borderColor: '#059669',
                                borderWidth: 2,
                                hoverBackgroundColor: '#34d399',
                                hoverBorderColor: '#10b981',
                                hoverBorderWidth: 3
                            },
                            {
                                label: 'NCOs',
                                data: [1200, 480, 320, 550, 180, 120],
                                backgroundColor: '#3b82f6',
                                borderColor: '#2563eb',
                                borderWidth: 2,
                                hoverBackgroundColor: '#60a5fa',
                                hoverBorderColor: '#3b82f6',
                                hoverBorderWidth: 3
                            },
                            {
                                label: 'Enlisted',
                                data: [2800, 1140, 750, 1300, 390, 415],
                                backgroundColor: '#f59e0b',
                                borderColor: '#d97706',
                                borderWidth: 2,
                                hoverBackgroundColor: '#fbbf24',
                                hoverBorderColor: '#f59e0b',
                                hoverBorderWidth: 3
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: {
                            duration: 2000,
                            easing: 'easeInOutQuart'
                        },
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        },
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#e2e8f0',
                                    usePointStyle: true,
                                    padding: 20
                                },
                                onHover: (event, legendItem, legend) => {
                                    legend.chart.canvas.style.cursor = 'pointer';
                                },
                                onLeave: (event, legendItem, legend) => {
                                    legend.chart.canvas.style.cursor = 'default';
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(15, 23, 42, 0.9)',
                                titleColor: '#e2e8f0',
                                bodyColor: '#cbd5e1',
                                borderColor: '#475569',
                                borderWidth: 1,
                                cornerRadius: 8,
                                displayColors: true,
                                callbacks: {
                                    title: function(context) {
                                        return context[0].label;
                                    },
                                    label: function(context) {
                                        return `${context.dataset.label}: ${context.raw.toLocaleString()}`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                stacked: true,
                                ticks: {
                                    color: '#94a3b8',
                                    font: {
                                        size: 12
                                    }
                                },
                                grid: {
                                    color: '#374151',
                                    display: false
                                }
                            },
                            y: {
                                stacked: true,
                                ticks: {
                                    color: '#94a3b8',
                                    callback: function(value) {
                                        return value.toLocaleString();
                                    }
                                },
                                grid: {
                                    color: '#374151'
                                }
                            }
                        },
                        onHover: (event, elements) => {
                            event.native.target.style.cursor = elements.length > 0 ? 'pointer' : 'default';
                        },
                        onClick: (event, elements) => {
                            if (elements.length > 0) {
                                const element = elements[0];
                                const corps = personnelChart.data.labels[element.index];
                                const rank = personnelChart.data.datasets[element.datasetIndex].label;
                                drillThroughChart('personnel', { corps, rank });
                            }
                        }
                    }
                });
            }

            // Appointments vs Retirements Chart (Interactive Line)
            const appointmentCtx = document.getElementById('appointmentChart');
            if (appointmentCtx && !appointmentChart) {
                appointmentChart = new Chart(appointmentCtx, {
                    type: 'line',
                    data: {
                        labels: ['2020', '2021', '2022', '2023', '2024'],
                        datasets: [
                            {
                                label: 'Appointments',
                                data: [1250, 1380, 1420, 1350, 1480],
                                borderColor: '#10b981',
                                backgroundColor: 'rgba(16, 185, 129, 0.2)',
                                tension: 0.4,
                                fill: true,
                                pointBackgroundColor: '#10b981',
                                pointBorderColor: '#ffffff',
                                pointBorderWidth: 2,
                                pointRadius: 6,
                                pointHoverRadius: 8,
                                pointHoverBackgroundColor: '#34d399',
                                pointHoverBorderColor: '#ffffff',
                                pointHoverBorderWidth: 3
                            },
                            {
                                label: 'Retirements',
                                data: [890, 920, 980, 1050, 1120],
                                borderColor: '#ef4444',
                                backgroundColor: 'rgba(239, 68, 68, 0.2)',
                                tension: 0.4,
                                fill: true,
                                pointBackgroundColor: '#ef4444',
                                pointBorderColor: '#ffffff',
                                pointBorderWidth: 2,
                                pointRadius: 6,
                                pointHoverRadius: 8,
                                pointHoverBackgroundColor: '#f87171',
                                pointHoverBorderColor: '#ffffff',
                                pointHoverBorderWidth: 3
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: {
                            duration: 2500,
                            easing: 'easeInOutCubic'
                        },
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        },
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#e2e8f0',
                                    usePointStyle: true,
                                    padding: 20
                                },
                                onHover: (event, legendItem, legend) => {
                                    legend.chart.canvas.style.cursor = 'pointer';
                                },
                                onLeave: (event, legendItem, legend) => {
                                    legend.chart.canvas.style.cursor = 'default';
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(15, 23, 42, 0.9)',
                                titleColor: '#e2e8f0',
                                bodyColor: '#cbd5e1',
                                borderColor: '#475569',
                                borderWidth: 1,
                                cornerRadius: 8,
                                displayColors: true,
                                callbacks: {
                                    title: function(context) {
                                        return context[0].label;
                                    },
                                    label: function(context) {
                                        return `${context.dataset.label}: ${context.raw.toLocaleString()}`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: '#94a3b8',
                                    font: {
                                        size: 12
                                    }
                                },
                                grid: {
                                    color: '#374151',
                                    display: false
                                }
                            },
                            y: {
                                ticks: {
                                    color: '#94a3b8',
                                    callback: function(value) {
                                        return value.toLocaleString();
                                    }
                                },
                                grid: {
                                    color: '#374151'
                                }
                            }
                        },
                        onHover: (event, elements) => {
                            event.native.target.style.cursor = elements.length > 0 ? 'pointer' : 'default';
                        },
                        onClick: (event, elements) => {
                            if (elements.length > 0) {
                                const element = elements[0];
                                const year = appointmentChart.data.labels[element.index];
                                drillThroughChart('appointments', { year });
                            }
                        }
                    }
                });
            }

            // Performance Distribution Chart (Doughnut)
            const performanceCtx = document.getElementById('performanceChart');
            if (performanceCtx) {
                new Chart(performanceCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Excellent', 'Good', 'Satisfactory', 'Needs Improvement'],
                        datasets: [{
                            data: [3687, 15977, 4424, 492],
                            backgroundColor: ['#10b981', '#3b82f6', '#f59e0b', '#ef4444'],
                            borderColor: ['#059669', '#2563eb', '#d97706', '#dc2626'],
                            borderWidth: 2,
                            hoverOffset: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: '#e2e8f0',
                                    usePointStyle: true,
                                    padding: 15
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(15, 23, 42, 0.9)',
                                titleColor: '#e2e8f0',
                                bodyColor: '#cbd5e1',
                                borderColor: '#475569',
                                borderWidth: 1,
                                cornerRadius: 8,
                                callbacks: {
                                    label: function(context) {
                                        const total = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                                        const percentage = ((context.raw / total) * 100).toFixed(1);
                                        return `${context.label}: ${context.raw.toLocaleString()} (${percentage}%)`;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Training Progress Chart (Radar)
            const trainingCtx = document.getElementById('trainingProgressChart');
            if (trainingCtx) {
                new Chart(trainingCtx, {
                    type: 'radar',
                    data: {
                        labels: ['Combat', 'Leadership', 'Technical', 'Physical', 'Medical', 'Communication'],
                        datasets: [{
                            label: 'Training Completion %',
                            data: [95, 78, 87, 92, 84, 89],
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.2)',
                            pointBackgroundColor: '#10b981',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            pointRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            r: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    color: '#94a3b8',
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                },
                                grid: {
                                    color: '#374151'
                                },
                                pointLabels: {
                                    color: '#e2e8f0'
                                }
                            }
                        }
                    }
                });
            }

            // Health & Fitness Chart (Bar)
            const healthCtx = document.getElementById('healthFitnessChart');
            if (healthCtx) {
                new Chart(healthCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Category A', 'Category B', 'Category C', 'Limited Duty'],
                        datasets: [{
                            label: 'Personnel Count',
                            data: [18450, 4890, 1240, 1240],
                            backgroundColor: ['#10b981', '#3b82f6', '#f59e0b', '#ef4444'],
                            borderColor: ['#059669', '#2563eb', '#d97706', '#dc2626'],
                            borderWidth: 2,
                            borderRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: '#94a3b8'
                                },
                                grid: {
                                    display: false
                                }
                            },
                            y: {
                                ticks: {
                                    color: '#94a3b8',
                                    callback: function(value) {
                                        return value.toLocaleString();
                                    }
                                },
                                grid: {
                                    color: '#374151'
                                }
                            }
                        }
                    }
                });
            }

            // Training Status Chart (Bar with filter)
            const trainingStatusCtx = document.getElementById('trainingStatusChart');
            if (trainingStatusCtx && !trainingStatusChart) {
                trainingStatusChart = new Chart(trainingStatusCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Combat Training', 'Leadership', 'Technical', 'Overall'],
                        datasets: [
                            {
                                label: '1st Infantry Division',
                                data: [95, 78, 87, 87],
                                backgroundColor: '#10b981',
                                borderColor: '#059669',
                                borderWidth: 2,
                                borderRadius: 4
                            },
                            {
                                label: 'Armored Brigade',
                                data: [92, 75, 89, 85],
                                backgroundColor: '#3b82f6',
                                borderColor: '#2563eb',
                                borderWidth: 2,
                                borderRadius: 4
                            },
                            {
                                label: 'Artillery Regiment',
                                data: [89, 72, 91, 84],
                                backgroundColor: '#f59e0b',
                                borderColor: '#d97706',
                                borderWidth: 2,
                                borderRadius: 4
                            },
                            {
                                label: 'Engineering Corps',
                                data: [87, 79, 94, 87],
                                backgroundColor: '#8b5cf6',
                                borderColor: '#7c3aed',
                                borderWidth: 2,
                                borderRadius: 4
                            },
                            {
                                label: 'Medical Corps',
                                data: [85, 82, 96, 88],
                                backgroundColor: '#06b6d4',
                                borderColor: '#0891b2',
                                borderWidth: 2,
                                borderRadius: 4
                            },
                            {
                                label: 'Special Forces',
                                data: [98, 94, 92, 95],
                                backgroundColor: '#ef4444',
                                borderColor: '#dc2626',
                                borderWidth: 2,
                                borderRadius: 4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: {
                            duration: 2000,
                            easing: 'easeInOutQuart'
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'rgba(15, 23, 42, 0.9)',
                                titleColor: '#e2e8f0',
                                bodyColor: '#cbd5e1',
                                borderColor: '#475569',
                                borderWidth: 1,
                                cornerRadius: 8,
                                callbacks: {
                                    label: function(context) {
                                        return `${context.dataset.label}: ${context.raw}%`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: '#94a3b8',
                                    font: { size: 12 }
                                },
                                grid: { display: false }
                            },
                            y: {
                                ticks: {
                                    color: '#94a3b8',
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                },
                                grid: { color: '#374151' },
                                min: 0,
                                max: 100
                            }
                        }
                    }
                });
            }

            // Medical Status Chart (Doughnut) + Fitness & Injury + Sick Days
            const medicalStatusCtx = document.getElementById('medicalStatusChart');
            if (medicalStatusCtx && !medicalStatusChart) {
                medicalStatusChart = new Chart(medicalStatusCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Fit for all duties', 'Category B (Fit with limitations)', 'Category C (Limited duties)', 'Medical Leave/Treatment'],
                        datasets: [{
                            data: [18450, 4890, 890, 350],
                            backgroundColor: ['#10b981', '#3b82f6', '#f59e0b', '#ef4444'],
                            borderColor: ['#059669', '#2563eb', '#d97706', '#dc2626'],
                            borderWidth: 2,
                            hoverBackgroundColor: ['#34d399', '#60a5fa', '#fbbf24', '#f87171'],
                            hoverOffset: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        cutout: '60%',
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: '#ffffff',
                                    usePointStyle: true,
                                    padding: 12,
                                    font: { size: 11 },
                                    generateLabels: function(chart) {
                                        const data = chart.data;
                                        if (data.labels.length && data.datasets.length) {
                                            return data.labels.map((label, i) => {
                                                const value = data.datasets[0].data[i];
                                                const total = data.datasets[0].data.reduce((a, b) => a + b, 0);
                                                const percentage = ((value / total) * 100).toFixed(1);
                                                return {
                                                    text: `${label.split(' (')[0]} (${percentage}%)`,
                                                    fillStyle: data.datasets[0].backgroundColor[i],
                                                    strokeStyle: data.datasets[0].borderColor[i],
                                                    lineWidth: 2,
                                                    pointStyle: 'circle',
                                                    hidden: false,
                                                    index: i
                                                };
                                            });
                                        }
                                        return [];
                                    }
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(15, 23, 42, 0.9)',
                                titleColor: '#e2e8f0',
                                bodyColor: '#cbd5e1',
                                borderColor: '#475569',
                                borderWidth: 1,
                                cornerRadius: 8,
                                callbacks: {
                                    label: function(context) {
                                        const total = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                                        const percentage = ((context.raw / total) * 100).toFixed(1);
                                        return `${context.raw.toLocaleString()} personnel (${percentage}%)`;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Fitness Pass Rate (Stacked bar)
            const fitnessPassCtx = document.getElementById('fitnessPassChart');
            if (fitnessPassCtx && !fitnessPassChart) {
                fitnessPassChart = new Chart(fitnessPassCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Infantry', 'Armored', 'Artillery', 'Engineering', 'Medical', 'Special Forces'],
                        datasets: [
                            { label: 'Pass', data: [82, 78, 75, 80, 85, 92], backgroundColor: '#10b981', borderColor: '#059669', borderWidth: 2, borderRadius: 4 },
                            { label: 'Fail', data: [18, 22, 25, 20, 15, 8], backgroundColor: '#ef4444', borderColor: '#dc2626', borderWidth: 2, borderRadius: 4 }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { labels: { color: '#e2e8f0', usePointStyle: true } } },
                        scales: {
                            x: { stacked: true, ticks: { color: '#94a3b8' }, grid: { display: false } },
                            y: { stacked: true, ticks: { color: '#94a3b8', callback: v => v + '%' }, grid: { color: '#374151' }, min: 0, max: 100 }
                        }
                    }
                });
            }

            // Injury Types (Horizontal bar)
            const injuryTypeCtx = document.getElementById('injuryTypeChart');
            if (injuryTypeCtx && !injuryTypeChart) {
                injuryTypeChart = new Chart(injuryTypeCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Sprains/Strains', 'Back Pain', 'Knee Injuries', 'Heat Exhaustion', 'Shoulder Injuries'],
                        datasets: [{
                            label: 'Cases',
                            data: [320, 210, 185, 96, 74],
                            backgroundColor: ['#f59e0b', '#ef4444', '#3b82f6', '#10b981', '#8b5cf6'],
                            borderColor: ['#d97706', '#dc2626', '#2563eb', '#059669', '#7c3aed'],
                            borderWidth: 2,
                            borderRadius: 6
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } },
                        scales: {
                            x: { ticks: { color: '#94a3b8' }, grid: { color: '#374151' } },
                            y: { ticks: { color: '#94a3b8' }, grid: { display: false } }
                        }
                    }
                });
            }

            // Sick Days Trend (Line)
            const sickDaysCtx = document.getElementById('sickDaysTrendChart');
            if (sickDaysCtx && !sickDaysTrendChart) {
                sickDaysTrendChart = new Chart(sickDaysCtx, {
                    type: 'line',
                    data: {
                        labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6'],
                        datasets: [{
                            label: 'Sick Days',
                            data: [320, 280, 340, 300, 265, 290],
                            borderColor: '#8b5cf6',
                            backgroundColor: 'rgba(139, 92, 246, 0.15)',
                            tension: 0.35,
                            fill: true,
                            pointBackgroundColor: '#8b5cf6',
                            pointBorderColor: '#7c3aed',
                            pointRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } },
                        scales: {
                            x: { ticks: { color: '#94a3b8' }, grid: { display: false } },
                            y: { ticks: { color: '#94a3b8' }, grid: { color: '#374151' } }
                        }
                    }
                });
            }
        }

        function initializeMobilityCharts() {
            // Vehicle Type Chart (Interactive Doughnut)
            const vehicleTypeCtx = document.getElementById('vehicleTypeChart');
            if (vehicleTypeCtx && !vehicleTypeChart) {
                vehicleTypeChart = new Chart(vehicleTypeCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Tanks', 'APCs', 'Trucks', 'Helicopters', 'Artillery', 'Support'],
                        datasets: [{
                            label: 'Number of Vehicles',
                            data: [145, 320, 890, 78, 156, 258],
                            backgroundColor: [
                                '#ef4444',
                                '#f59e0b',
                                '#10b981',
                                '#3b82f6',
                                '#8b5cf6',
                                '#06b6d4'
                            ],
                            borderColor: [
                                '#dc2626',
                                '#d97706',
                                '#059669',
                                '#2563eb',
                                '#7c3aed',
                                '#0891b2'
                            ],
                            borderWidth: 3,
                            hoverBackgroundColor: [
                                '#f87171',
                                '#fbbf24',
                                '#34d399',
                                '#60a5fa',
                                '#a78bfa',
                                '#22d3ee'
                            ],
                            hoverBorderWidth: 4,
                            hoverOffset: 15
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: {
                            animateRotate: true,
                            animateScale: true,
                            duration: 2000,
                            easing: 'easeInOutQuart'
                        },
                        interaction: {
                            intersect: false
                        },
                        plugins: {
                            legend: {
                                position: 'right',
                                labels: {
                                    color: '#e2e8f0',
                                    usePointStyle: true,
                                    padding: 15,
                                    font: {
                                        size: 12
                                    }
                                },
                                onHover: (event, legendItem, legend) => {
                                    legend.chart.canvas.style.cursor = 'pointer';
                                },
                                onLeave: (event, legendItem, legend) => {
                                    legend.chart.canvas.style.cursor = 'default';
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(15, 23, 42, 0.9)',
                                titleColor: '#e2e8f0',
                                bodyColor: '#cbd5e1',
                                borderColor: '#475569',
                                borderWidth: 1,
                                cornerRadius: 8,
                                displayColors: true,
                                callbacks: {
                                    title: function(context) {
                                        return context[0].label;
                                    },
                                    label: function(context) {
                                        const total = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                                        const percentage = ((context.raw / total) * 100).toFixed(1);
                                        return `${context.raw} vehicles (${percentage}%)`;
                                    }
                                }
                            }
                        },
                        onHover: (event, elements) => {
                            event.native.target.style.cursor = elements.length > 0 ? 'pointer' : 'default';
                        },
                        onClick: (event, elements) => {
                            if (elements.length > 0) {
                                const element = elements[0];
                                const vehicleType = vehicleTypeChart.data.labels[element.index];
                                showVehicleTypeDetails(vehicleType);
                            }
                        }
                    }
                });
            }

            // Location Distribution Chart (Interactive Horizontal Bar)
            const locationCtx = document.getElementById('locationChart');
            if (locationCtx && !locationChart) {
                locationChart = new Chart(locationCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Kem Terendak', 'Kem Gemas', 'Kem Mahkota', 'Kem Wardieburn', 'Kem Sungai Udang', 'Other Bases'],
                        datasets: [{
                            label: 'Vehicles',
                            data: [485, 420, 380, 345, 290, 927],
                            backgroundColor: [
                                '#3b82f6',
                                '#10b981',
                                '#f59e0b',
                                '#ef4444',
                                '#8b5cf6',
                                '#06b6d4'
                            ],
                            borderColor: [
                                '#2563eb',
                                '#059669',
                                '#d97706',
                                '#dc2626',
                                '#7c3aed',
                                '#0891b2'
                            ],
                            borderWidth: 2,
                            hoverBackgroundColor: [
                                '#60a5fa',
                                '#34d399',
                                '#fbbf24',
                                '#f87171',
                                '#a78bfa',
                                '#22d3ee'
                            ],
                            hoverBorderWidth: 3,
                            borderRadius: 6,
                            borderSkipped: false
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: {
                            duration: 2000,
                            easing: 'easeInOutBounce'
                        },
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'rgba(15, 23, 42, 0.9)',
                                titleColor: '#e2e8f0',
                                bodyColor: '#cbd5e1',
                                borderColor: '#475569',
                                borderWidth: 1,
                                cornerRadius: 8,
                                displayColors: true,
                                callbacks: {
                                    title: function(context) {
                                        return context[0].label;
                                    },
                                    label: function(context) {
                                        return `${context.raw} vehicles`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: '#94a3b8',
                                    callback: function(value) {
                                        return value.toLocaleString();
                                    }
                                },
                                grid: {
                                    color: '#374151'
                                }
                            },
                            y: {
                                ticks: {
                                    color: '#94a3b8',
                                    font: {
                                        size: 11
                                    }
                                },
                                grid: {
                                    display: false
                                }
                            }
                        },
                        onHover: (event, elements) => {
                            event.native.target.style.cursor = elements.length > 0 ? 'pointer' : 'default';
                        },
                        onClick: (event, elements) => {
                            if (elements.length > 0) {
                                const index = elements[0].index;
                                const location = locationChart.data.labels[index];
                                showLocationDetails(location);
                            }
                        }
                    }
                });
            }

            // Usage Pattern Chart
            const usagePatternCtx = document.getElementById('usagePatternChart');
            if (usagePatternCtx) {
                new Chart(usagePatternCtx, {
                    type: 'line',
                    data: {
                        labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00'],
                        datasets: [{
                            label: 'Vehicle Usage %',
                            data: [15, 8, 78, 45, 52, 28],
                            borderColor: '#f59e0b',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointBackgroundColor: '#f59e0b',
                            pointBorderColor: '#d97706',
                            pointRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: '#94a3b8'
                                },
                                grid: {
                                    color: '#374151'
                                }
                            },
                            y: {
                                ticks: {
                                    color: '#94a3b8',
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                },
                                grid: {
                                    color: '#374151'
                                },
                                min: 0,
                                max: 100
                            }
                        }
                    }
                });
            }
        }

        function initializeFirepowerCharts() {
            // Fire Power Type Chart (Pie Chart)
            const firepowerTypeCtx = document.getElementById('firepowerTypeChart');
            if (firepowerTypeCtx && !firepowerTypeChart) {
                firepowerTypeChart = new Chart(firepowerTypeCtx, {
                    type: 'pie',
                    data: {
                        labels: ['Small Arms', 'Heavy Weapons', 'Artillery', 'Anti-Tank', 'Air Defense', 'Mortars'],
                        datasets: [{
                            label: 'Number of Weapons',
                            data: [15450, 890, 156, 340, 45, 280],
                            backgroundColor: [
                                '#10b981',
                                '#f59e0b',
                                '#ef4444',
                                '#8b5cf6',
                                '#06b6d4',
                                '#f97316'
                            ],
                            borderColor: [
                                '#059669',
                                '#d97706',
                                '#dc2626',
                                '#7c3aed',
                                '#0891b2',
                                '#ea580c'
                            ],
                            borderWidth: 2,
                            hoverBackgroundColor: [
                                '#34d399',
                                '#fbbf24',
                                '#f87171',
                                '#a78bfa',
                                '#22d3ee',
                                '#fb923c'
                            ],
                            hoverBorderWidth: 3,
                            hoverOffset: 10
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: {
                            animateRotate: true,
                            animateScale: true,
                            duration: 2000,
                            easing: 'easeInOutQuart'
                        },
                        plugins: {
                            legend: {
                                position: 'right',
                                labels: {
                                    color: '#e2e8f0',
                                    usePointStyle: true,
                                    padding: 15,
                                    font: {
                                        size: 12
                                    }
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(15, 23, 42, 0.9)',
                                titleColor: '#e2e8f0',
                                bodyColor: '#cbd5e1',
                                borderColor: '#475569',
                                borderWidth: 1,
                                cornerRadius: 8,
                                displayColors: true,
                                callbacks: {
                                    title: function(context) {
                                        return context[0].label;
                                    },
                                    label: function(context) {
                                        const total = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                                        const percentage = ((context.raw / total) * 100).toFixed(1);
                                        return `${context.raw.toLocaleString()} weapons (${percentage}%)`;
                                    }
                                }
                            }
                        },
                        onHover: (event, elements) => {
                            event.native.target.style.cursor = elements.length > 0 ? 'pointer' : 'default';
                        },
                        onClick: (event, elements) => {
                            if (elements.length > 0) {
                                const element = elements[0];
                                const weaponType = firepowerTypeChart.data.labels[element.index];
                                showWeaponTypeDetails(weaponType);
                            }
                        }
                    }
                });
            }

            // Usage Chart
            const usageCtx = document.getElementById('usageChart');
            if (usageCtx && !usageChart) {
                usageChart = new Chart(usageCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Border Patrol', 'Training Exercises', 'Live Fire Training', 'Equipment Testing', 'Ceremonial', 'Maintenance'],
                        datasets: [{
                            label: 'Rounds Fired',
                            data: [45000, 125000, 89000, 12000, 3500, 8500],
                            backgroundColor: '#3b82f6',
                            borderColor: '#2563eb',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: '#94a3b8'
                                },
                                grid: {
                                    color: '#374151'
                                }
                            },
                            y: {
                                ticks: {
                                    color: '#94a3b8'
                                },
                                grid: {
                                    color: '#374151'
                                }
                            }
                        }
                    }
                });
            }

            // Weapon Health Chart
            const weaponHealthCtx = document.getElementById('weaponHealthChart');
            if (weaponHealthCtx) {
                window.weaponHealthChart = new Chart(weaponHealthCtx, {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                        datasets: [
                            {
                                label: 'Accuracy %',
                                data: [92, 91, 93, 89, 87, 85, 88, 90, 92, 94, 93, 91],
                                borderColor: '#10b981',
                                backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                tension: 0.4,
                                fill: false,
                                pointBackgroundColor: '#10b981',
                                pointBorderColor: '#059669',
                                pointRadius: 4
                            },
                            {
                                label: 'Reliability %',
                                data: [95, 94, 96, 92, 90, 88, 91, 93, 95, 97, 96, 94],
                                borderColor: '#3b82f6',
                                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                tension: 0.4,
                                fill: false,
                                pointBackgroundColor: '#3b82f6',
                                pointBorderColor: '#2563eb',
                                pointRadius: 4
                            },
                            {
                                label: 'Maintenance Score %',
                                data: [88, 89, 87, 85, 83, 81, 84, 86, 88, 90, 89, 87],
                                borderColor: '#f59e0b',
                                backgroundColor: 'rgba(245, 158, 11, 0.1)',
                                tension: 0.4,
                                fill: false,
                                pointBackgroundColor: '#f59e0b',
                                pointBorderColor: '#d97706',
                                pointRadius: 4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#e2e8f0',
                                    usePointStyle: true
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: '#94a3b8'
                                },
                                grid: {
                                    color: '#374151'
                                }
                            },
                            y: {
                                ticks: {
                                    color: '#94a3b8',
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                },
                                grid: {
                                    color: '#374151'
                                },
                                min: 70,
                                max: 100
                            }
                        }
                    }
                });
            }
        }

        // Update usage chart based on filter
        function updateUsageChart() {
            const filter = document.getElementById('usageFilter').value;
            let labels, data;

            switch(filter) {
                case 'operation':
                    labels = ['Border Patrol', 'Counter-Terrorism', 'Peacekeeping', 'Humanitarian Aid', 'Search & Rescue'];
                    data = [45000, 28000, 15000, 8500, 12000];
                    break;
                case 'training':
                    labels = ['Live Fire Training', 'Combat Training', 'Marksmanship', 'Tactical Exercises', 'Equipment Familiarization'];
                    data = [89000, 67000, 45000, 34000, 23000];
                    break;
                case 'unit':
                    labels = ['Infantry', 'Special Forces', 'Artillery', 'Armored', 'Engineering', 'Air Defense'];
                    data = [125000, 45000, 67000, 34000, 23000, 15000];
                    break;
                default: // all
                    labels = ['Border Patrol', 'Training Exercises', 'Live Fire Training', 'Equipment Testing', 'Ceremonial', 'Maintenance'];
                    data = [45000, 125000, 89000, 12000, 3500, 8500];
            }

            if (usageChart) {
                usageChart.data.labels = labels;
                usageChart.data.datasets[0].data = data;
                usageChart.update();
            }
        }

        // Mission forecasting functions
        const missionData = {
            'border-patrol': {
                name: 'Border Patrol Operation',
                duration: '7 days',
                personnel: '450 troops',
                intensity: 'Medium',
                environment: 'Rural/Forest',
                weapons: ['M4A1 Rifles', 'Machine Guns', 'Sniper Rifles'],
                prediction: {
                    '5.56mm NATO': { amount: 12500, confidence: 94 },
                    '7.62mm NATO': { amount: 3200, confidence: 89 },
                    '40mm Grenades': { amount: 150, confidence: 92 },
                    'Sniper Rounds': { amount: 240, confidence: 87 }
                },
                historical: {
                    lastMission: '8,450 rounds used',
                    variance: '+15% higher than average',
                    efficiency: '92% accuracy rate'
                }
            },
            'counter-terrorism': {
                name: 'Counter-Terrorism Exercise',
                duration: '3 days',
                personnel: '180 troops',
                intensity: 'Very High',
                environment: 'Urban/CQB',
                weapons: ['M4A1 Rifles', 'SMGs', 'Breaching Charges', 'Flash Bangs'],
                prediction: {
                    '5.56mm NATO': { amount: 8900, confidence: 96 },
                    '9mm Parabellum': { amount: 2400, confidence: 91 },
                    'Breaching Charges': { amount: 45, confidence: 88 },
                    'Flash Bangs': { amount: 120, confidence: 93 }
                },
                historical: {
                    lastMission: '7,200 rounds used',
                    variance: '+24% higher intensity',
                    efficiency: '89% mission success'
                }
            },
            'live-fire-training': {
                name: 'Live Fire Training',
                duration: '2 days',
                personnel: '320 troops',
                intensity: 'Medium',
                environment: 'Training Range',
                weapons: ['M4A1 Rifles', 'Machine Guns', 'Pistols'],
                prediction: {
                    '5.56mm NATO': { amount: 15600, confidence: 98 },
                    '7.62mm NATO': { amount: 4200, confidence: 95 },
                    '9mm Parabellum': { amount: 1800, confidence: 97 },
                    'Training Blanks': { amount: 3200, confidence: 99 }
                },
                historical: {
                    lastMission: '14,800 rounds used',
                    variance: '+5% standard increase',
                    efficiency: '96% training objectives met'
                }
            },
            'joint-exercise': {
                name: 'Joint Military Exercise',
                duration: '14 days',
                personnel: '1200 troops',
                intensity: 'High',
                environment: 'Mixed Terrain',
                weapons: ['All Categories', 'Artillery', 'Air Support'],
                prediction: {
                    '5.56mm NATO': { amount: 45000, confidence: 91 },
                    '7.62mm NATO': { amount: 18500, confidence: 88 },
                    '155mm Artillery': { amount: 280, confidence: 85 },
                    '40mm Grenades': { amount: 890, confidence: 90 }
                },
                historical: {
                    lastMission: '58,200 rounds used',
                    variance: '-22% more efficient',
                    efficiency: '94% objectives achieved'
                }
            },
            'urban-warfare': {
                name: 'Urban Warfare Training',
                duration: '5 days',
                personnel: '280 troops',
                intensity: 'High',
                environment: 'Urban/MOUT',
                weapons: ['M4A1 Rifles', 'SMGs', 'Grenades', 'Breaching Tools'],
                prediction: {
                    '5.56mm NATO': { amount: 18900, confidence: 93 },
                    '9mm Parabellum': { amount: 3400, confidence: 89 },
                    '40mm Grenades': { amount: 340, confidence: 86 },
                    'Smoke Grenades': { amount: 180, confidence: 94 }
                },
                historical: {
                    lastMission: '16,750 rounds used',
                    variance: '+13% urban complexity',
                    efficiency: '88% casualty reduction'
                }
            },
            'artillery-exercise': {
                name: 'Artillery Exercise',
                duration: '4 days',
                personnel: '150 troops',
                intensity: 'High',
                environment: 'Open Range',
                weapons: ['155mm Howitzers', '120mm Mortars', 'Observation Equipment'],
                prediction: {
                    '155mm Artillery': { amount: 450, confidence: 97 },
                    '120mm Mortar': { amount: 280, confidence: 95 },
                    'Illumination Rounds': { amount: 45, confidence: 92 },
                    'Smoke Rounds': { amount: 85, confidence: 94 }
                },
                historical: {
                    lastMission: '420 shells fired',
                    variance: '+7% accuracy improvement',
                    efficiency: '95% target engagement'
                }
            },
            'peacekeeping': {
                name: 'Peacekeeping Mission',
                duration: '30 days',
                personnel: '600 troops',
                intensity: 'Low',
                environment: 'International',
                weapons: ['M4A1 Rifles', 'Pistols', 'Non-lethal'],
                prediction: {
                    '5.56mm NATO': { amount: 2400, confidence: 85 },
                    '9mm Parabellum': { amount: 800, confidence: 82 },
                    'Rubber Bullets': { amount: 450, confidence: 78 },
                    'Tear Gas': { amount: 120, confidence: 88 }
                },
                historical: {
                    lastMission: '1,890 rounds used',
                    variance: '+27% due to tensions',
                    efficiency: '98% peaceful resolution'
                }
            },
            'disaster-response': {
                name: 'Disaster Response',
                duration: '10 days',
                personnel: '800 troops',
                intensity: 'Low',
                environment: 'Disaster Zone',
                weapons: ['Personal Defense', 'Signaling Equipment'],
                prediction: {
                    '5.56mm NATO': { amount: 480, confidence: 75 },
                    '9mm Parabellum': { amount: 240, confidence: 78 },
                    'Signal Flares': { amount: 180, confidence: 95 },
                    'Blank Rounds': { amount: 120, confidence: 92 }
                },
                historical: {
                    lastMission: '320 rounds used',
                    variance: '+50% security concerns',
                    efficiency: '99% humanitarian success'
                }
            }
        };

        function showMissionDropdown() {
            document.getElementById('missionDropdown').classList.remove('hidden');
        }

        function filterMissions() {
            const searchTerm = document.getElementById('missionSearch').value.toLowerCase();
            const options = document.querySelectorAll('.mission-option');
            
            options.forEach(option => {
                const text = option.textContent.toLowerCase();
                if (text.includes(searchTerm)) {
                    option.style.display = 'block';
                } else {
                    option.style.display = 'none';
                }
            });
            
            showMissionDropdown();
        }

        function selectMission(missionId) {
            const mission = missionData[missionId];
            if (!mission) return;

            // Update search input
            document.getElementById('missionSearch').value = mission.name;
            document.getElementById('missionDropdown').classList.add('hidden');

            // Update mission attributes
            const attributesDiv = document.getElementById('missionAttributes');
            attributesDiv.innerHTML = `
                <div class="bg-slate-600 rounded p-3 mb-3">
                    <h4 class="font-semibold text-yellow-400 mb-2">${mission.name}</h4>
                    <div class="grid grid-cols-2 gap-2 text-sm">
                        <div class="flex justify-between">
                            <span>Duration:</span>
                            <span class="text-blue-400">${mission.duration}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Personnel:</span>
                            <span class="text-green-400">${mission.personnel}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Intensity:</span>
                            <span class="text-${getIntensityColor(mission.intensity)}-400">${mission.intensity}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Environment:</span>
                            <span class="text-purple-400">${mission.environment}</span>
                        </div>
                    </div>
                </div>
                <div class="bg-slate-600 rounded p-3">
                    <h4 class="font-semibold text-cyan-400 mb-2">Primary Weapons</h4>
                    <div class="flex flex-wrap gap-1">
                        ${mission.weapons.map(weapon => 
                            `<span class="px-2 py-1 bg-slate-500 text-xs rounded">${weapon}</span>`
                        ).join('')}
                    </div>
                </div>
            `;

            // Update usage prediction
            const predictionDiv = document.getElementById('usagePrediction');
            predictionDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="text-center mb-4">
                        <span class="text-2xl font-bold text-blue-400">AI Prediction Results</span>
                        <p class="text-xs text-slate-300 mt-1">Based on historical data and mission parameters</p>
                    </div>
                    ${Object.entries(mission.prediction).map(([ammoType, data]) => `
                        <div class="bg-slate-600 rounded p-3">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-semibold">${ammoType}</span>
                                <div class="flex items-center space-x-2">
                                    <span class="text-lg font-bold text-green-400">${data.amount.toLocaleString()}</span>
                                    <span class="px-2 py-1 bg-blue-600 text-xs rounded">${data.confidence}% confidence</span>
                                </div>
                            </div>
                            <div class="w-full bg-slate-500 rounded-full h-2">
                                <div class="bg-blue-500 h-2 rounded-full" style="width: ${data.confidence}%"></div>
                            </div>
                        </div>
                    `).join('')}
                </div>
                <div class="mt-4 p-3 bg-blue-900 bg-opacity-30 border border-blue-700 rounded">
                    <div class="flex items-center space-x-2 mb-2">
                        <div class="w-2 h-2 bg-blue-500 rounded-full animate-pulse"></div>
                        <span class="font-semibold text-blue-400">Total Estimated Cost</span>
                    </div>
                    <p class="text-2xl font-bold text-green-400">RM ${calculateTotalCost(mission.prediction).toLocaleString()}</p>
                    <p class="text-xs text-slate-300">Including logistics and handling</p>
                </div>
            `;

            // Show and update historical comparison
            const comparisonDiv = document.getElementById('historicalComparison');
            const comparisonContent = document.getElementById('comparisonContent');
            
            comparisonContent.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-slate-600 rounded p-3">
                        <h4 class="font-semibold text-green-400 mb-2">Previous Mission</h4>
                        <p class="text-sm text-slate-300">${mission.historical.lastMission}</p>
                        <p class="text-xs text-slate-400 mt-1">Last execution</p>
                    </div>
                    <div class="bg-slate-600 rounded p-3">
                        <h4 class="font-semibold text-yellow-400 mb-2">Variance Analysis</h4>
                        <p class="text-sm text-slate-300">${mission.historical.variance}</p>
                        <p class="text-xs text-slate-400 mt-1">Compared to average</p>
                    </div>
                    <div class="bg-slate-600 rounded p-3">
                        <h4 class="font-semibold text-blue-400 mb-2">Mission Efficiency</h4>
                        <p class="text-sm text-slate-300">${mission.historical.efficiency}</p>
                        <p class="text-xs text-slate-400 mt-1">Success metrics</p>
                    </div>
                </div>
                <div class="mt-4 p-3 bg-purple-900 bg-opacity-30 border border-purple-700 rounded">
                    <h4 class="font-semibold text-purple-400 mb-2">AI Recommendations</h4>
                    <div class="space-y-1 text-sm">
                        ${generateRecommendations(missionId).map(rec => 
                            `<div class="flex items-center space-x-2">
                                <div class="w-1 h-1 bg-purple-500 rounded-full"></div>
                                <span>${rec}</span>
                            </div>`
                        ).join('')}
                    </div>
                </div>
            `;
            
            comparisonDiv.classList.remove('hidden');
        }

        function getIntensityColor(intensity) {
            switch(intensity.toLowerCase()) {
                case 'low': return 'green';
                case 'medium': return 'yellow';
                case 'high': return 'orange';
                case 'very high': return 'red';
                default: return 'blue';
            }
        }

        function calculateTotalCost(prediction) {
            const costs = {
                '5.56mm NATO': 2.5,
                '7.62mm NATO': 3.2,
                '9mm Parabellum': 1.8,
                '40mm Grenades': 45,
                '155mm Artillery': 850,
                '120mm Mortar': 320,
                'Sniper Rounds': 12,
                'Breaching Charges': 180,
                'Flash Bangs': 25,
                'Training Blanks': 1.2,
                'Rubber Bullets': 3.5,
                'Tear Gas': 35,
                'Signal Flares': 15,
                'Blank Rounds': 1.0,
                'Illumination Rounds': 450,
                'Smoke Rounds': 280,
                'Smoke Grenades': 28
            };

            let total = 0;
            Object.entries(prediction).forEach(([type, data]) => {
                const unitCost = costs[type] || 5; // Default cost if not found
                total += data.amount * unitCost;
            });

            return Math.round(total * 1.15); // Add 15% for logistics and handling
        }

        function generateRecommendations(missionId) {
            const recommendations = {
                'border-patrol': [
                    'Increase sniper ammunition by 10% for long-range engagements',
                    'Consider night vision equipment for extended patrols',
                    'Pre-position emergency resupply at checkpoint Alpha'
                ],
                'counter-terrorism': [
                    'Ensure breaching charge backup availability',
                    'Coordinate with medical team for casualty evacuation',
                    'Implement real-time ammunition tracking system'
                ],
                'live-fire-training': [
                    'Schedule ammunition delivery 48 hours before exercise',
                    'Prepare additional training blanks for safety drills',
                    'Coordinate range cleanup and brass collection'
                ],
                'joint-exercise': [
                    'Establish inter-unit ammunition sharing protocols',
                    'Deploy mobile ammunition supply vehicles',
                    'Implement centralized ammunition tracking system'
                ],
                'urban-warfare': [
                    'Increase smoke grenade allocation for concealment',
                    'Prepare additional breaching equipment',
                    'Coordinate with civilian evacuation procedures'
                ],
                'artillery-exercise': [
                    'Verify target range clearance and safety zones',
                    'Prepare meteorological data for accuracy',
                    'Coordinate with air traffic control'
                ],
                'peacekeeping': [
                    'Emphasize non-lethal ammunition availability',
                    'Prepare cultural sensitivity briefings',
                    'Establish local liaison communication protocols'
                ],
                'disaster-response': [
                    'Minimize ammunition load for humanitarian focus',
                    'Prepare emergency signaling equipment',
                    'Coordinate with civilian rescue organizations'
                ]
            };

            return recommendations[missionId] || [
                'Review mission parameters for accuracy',
                'Ensure adequate supply chain coordination',
                'Implement real-time usage monitoring'
            ];
        }

        // Update weapon health chart based on filter
        function updateWeaponHealthChart() {
            const filter = document.getElementById('weaponSystemFilter').value;
            
            if (!window.weaponHealthChart) return;
            
            // Define different data sets for each weapon system
            const chartData = {
                'heavy': {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [
                        {
                            label: 'Accuracy %',
                            data: [92, 91, 93, 89, 87, 85, 88, 90, 92, 94, 93, 91],
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.4,
                            fill: false,
                            pointBackgroundColor: '#10b981',
                            pointBorderColor: '#059669',
                            pointRadius: 4
                        },
                        {
                            label: 'Reliability %',
                            data: [95, 94, 96, 92, 90, 88, 91, 93, 95, 97, 96, 94],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4,
                            fill: false,
                            pointBackgroundColor: '#3b82f6',
                            pointBorderColor: '#2563eb',
                            pointRadius: 4
                        },
                        {
                            label: 'Maintenance Score %',
                            data: [88, 89, 87, 85, 83, 81, 84, 86, 88, 90, 89, 87],
                            borderColor: '#f59e0b',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            tension: 0.4,
                            fill: false,
                            pointBackgroundColor: '#f59e0b',
                            pointBorderColor: '#d97706',
                            pointRadius: 4
                        }
                    ]
                },
                'artillery': {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [
                        {
                            label: 'Accuracy %',
                            data: [89, 87, 91, 85, 82, 79, 83, 86, 89, 91, 88, 85],
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.4,
                            fill: false,
                            pointBackgroundColor: '#10b981',
                            pointBorderColor: '#059669',
                            pointRadius: 4
                        },
                        {
                            label: 'Reliability %',
                            data: [91, 89, 93, 87, 85, 82, 86, 89, 92, 94, 91, 88],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4,
                            fill: false,
                            pointBackgroundColor: '#3b82f6',
                            pointBorderColor: '#2563eb',
                            pointRadius: 4
                        },
                        {
                            label: 'Maintenance Score %',
                            data: [85, 86, 84, 82, 80, 78, 81, 83, 85, 87, 86, 84],
                            borderColor: '#f59e0b',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            tension: 0.4,
                            fill: false,
                            pointBackgroundColor: '#f59e0b',
                            pointBorderColor: '#d97706',
                            pointRadius: 4
                        }
                    ]
                },
                'air-defense': {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [
                        {
                            label: 'Accuracy %',
                            data: [96, 95, 97, 94, 92, 90, 93, 95, 97, 98, 96, 94],
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.4,
                            fill: false,
                            pointBackgroundColor: '#10b981',
                            pointBorderColor: '#059669',
                            pointRadius: 4
                        },
                        {
                            label: 'Reliability %',
                            data: [98, 97, 99, 96, 94, 92, 95, 97, 99, 100, 98, 96],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4,
                            fill: false,
                            pointBackgroundColor: '#3b82f6',
                            pointBorderColor: '#2563eb',
                            pointRadius: 4
                        },
                        {
                            label: 'Maintenance Score %',
                            data: [92, 93, 91, 89, 87, 85, 88, 90, 92, 94, 93, 91],
                            borderColor: '#f59e0b',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            tension: 0.4,
                            fill: false,
                            pointBackgroundColor: '#f59e0b',
                            pointBorderColor: '#d97706',
                            pointRadius: 4
                        }
                    ]
                },
                'all': {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [
                        {
                            label: 'Accuracy %',
                            data: [92, 91, 93, 89, 87, 85, 88, 90, 92, 94, 93, 91],
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.4,
                            fill: false,
                            pointBackgroundColor: '#10b981',
                            pointBorderColor: '#059669',
                            pointRadius: 4
                        },
                        {
                            label: 'Reliability %',
                            data: [95, 94, 96, 92, 90, 88, 91, 93, 95, 97, 96, 94],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4,
                            fill: false,
                            pointBackgroundColor: '#3b82f6',
                            pointBorderColor: '#2563eb',
                            pointRadius: 4
                        },
                        {
                            label: 'Maintenance Score %',
                            data: [88, 89, 87, 85, 83, 81, 84, 86, 88, 90, 89, 87],
                            borderColor: '#f59e0b',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            tension: 0.4,
                            fill: false,
                            pointBackgroundColor: '#f59e0b',
                            pointBorderColor: '#d97706',
                            pointRadius: 4
                        }
                    ]
                }
            };
            
            // Update chart data
            const newData = chartData[filter] || chartData['all'];
            window.weaponHealthChart.data.labels = newData.labels;
            window.weaponHealthChart.data.datasets = newData.datasets;
            
            // Update the chart with animation
            window.weaponHealthChart.update('active');
        }

        // Run targeting simulation
        function runTargetingSimulation() {
            const button = document.getElementById('runSimulationBtn');
            const currentSim = document.getElementById('currentSimulation');
            const results = document.getElementById('simulationResults');
            
            // Disable button and show loading
            button.disabled = true;
            button.textContent = 'Running Simulation...';
            button.classList.add('opacity-50');
            
            // Update current simulation status
            currentSim.innerHTML = `
                <div class="flex justify-between">
                    <span>Status:</span>
                    <span class="text-yellow-400">Running...</span>
                </div>
                <div class="flex justify-between">
                    <span>Progress:</span>
                    <span class="text-blue-400">Processing scenarios</span>
                </div>
                <div class="flex justify-between">
                    <span>ETA:</span>
                    <span class="text-green-400">30 seconds</span>
                </div>
            `;
            
            // Simulate processing time
            setTimeout(() => {
                // Get selected parameters
                const targetType = document.getElementById('targetType').value;
                const range = document.getElementById('targetRange').value;
                const weather = document.getElementById('weatherConditions').value;
                const terrain = document.getElementById('terrainType').value;
                const weapon = document.getElementById('weaponSystem').value;
                
                // Generate random but realistic results based on parameters
                const hitProb = Math.random() * 20 + 75; // 75-95%
                const killProb = Math.random() * 15 + 70; // 70-85%
                const collateralRisk = Math.random() * 20 + 5; // 5-25%
                const timeToTarget = (Math.random() * 3 + 1).toFixed(1); // 1-4 seconds
                const reliability = Math.random() * 5 + 95; // 95-100%
                
                // Update results
                results.innerHTML = `
                    <div class="bg-slate-600 rounded p-3">
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-medium">Hit Probability</span>
                            <span class="text-2xl font-bold text-green-400">${hitProb.toFixed(1)}%</span>
                        </div>
                        <div class="w-full bg-slate-500 rounded-full h-2">
                            <div class="bg-green-500 h-2 rounded-full" style="width: ${hitProb}%"></div>
                        </div>
                        <p class="text-xs text-slate-300 mt-1">Based on ${weapon} vs ${targetType} at ${range} range</p>
                    </div>

                    <div class="bg-slate-600 rounded p-3">
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-medium">Kill Probability</span>
                            <span class="text-2xl font-bold text-yellow-400">${killProb.toFixed(1)}%</span>
                        </div>
                        <div class="w-full bg-slate-500 rounded-full h-2">
                            <div class="bg-yellow-500 h-2 rounded-full" style="width: ${killProb}%"></div>
                        </div>
                        <p class="text-xs text-slate-300 mt-1">Target neutralization effectiveness</p>
                    </div>

                    <div class="bg-slate-600 rounded p-3">
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-medium">Collateral Risk</span>
                            <span class="text-2xl font-bold text-${collateralRisk > 15 ? 'red' : 'green'}-400">${collateralRisk.toFixed(1)}%</span>
                        </div>
                        <div class="w-full bg-slate-500 rounded-full h-2">
                            <div class="bg-${collateralRisk > 15 ? 'red' : 'green'}-500 h-2 rounded-full" style="width: ${collateralRisk}%"></div>
                        </div>
                        <p class="text-xs text-slate-300 mt-1">${collateralRisk > 15 ? 'Elevated' : 'Minimal'} collateral damage probability</p>
                    </div>

                    <div class="grid grid-cols-2 gap-3">
                        <div class="bg-slate-600 rounded p-2 text-center">
                            <p class="text-lg font-bold text-blue-400">${timeToTarget}s</p>
                            <p class="text-xs text-slate-300">Time to Target</p>
                        </div>
                        <div class="bg-slate-600 rounded p-2 text-center">
                            <p class="text-lg font-bold text-green-400">${reliability.toFixed(1)}%</p>
                            <p class="text-xs text-slate-300">System Reliability</p>
                        </div>
                    </div>
                `;
                
                // Update simulation status
                currentSim.innerHTML = `
                    <div class="flex justify-between">
                        <span>Status:</span>
                        <span class="text-green-400">Complete</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Last Run:</span>
                        <span class="text-blue-400">Just now</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Scenarios Tested:</span>
                        <span class="text-yellow-400">1,248</span>
                    </div>
                `;
                
                // Re-enable button
                button.disabled = false;
                button.textContent = 'Run New Simulation';
                button.classList.remove('opacity-50');
                
            }, 3000); // 3 second simulation time
        }

        // Hide dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('missionDropdown');
            const search = document.getElementById('missionSearch');
            
            if (!dropdown.contains(event.target) && !search.contains(event.target)) {
                dropdown.classList.add('hidden');
            }
        });

        // View weapon alert function
        function viewWeaponAlert(alertType) {
            const modal = document.getElementById('drillDownModal');
            const title = document.getElementById('modalTitle');
            const content = document.getElementById('modalContent');
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            switch(alertType) {
                case 'critical':
                    title.textContent = 'Critical Weapon Maintenance - M4A1 Rifles';
                    content.innerHTML = `
                        <div class="bg-red-900 bg-opacity-30 border border-red-700 rounded p-4 mb-4">
                            <h3 class="font-bold text-red-400 mb-2">CRITICAL - Overdue Maintenance</h3>
                            <p class="text-sm mb-2"><strong>Weapons:</strong> M4A1 Assault Rifles (45 units)</p>
                            <p class="text-sm mb-2"><strong>Issue:</strong> Barrel replacement required - 30 days overdue</p>
                            <p class="text-sm mb-2"><strong>Risk Level:</strong> Weapon accuracy compromised, safety risk</p>
                            <p class="text-sm"><strong>Location:</strong> Kem Terendak - Armory Block C</p>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Maintenance Details</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between"><span>Last Service:</span><span class="text-red-400">8 months ago</span></div>
                                    <div class="flex justify-between"><span>Rounds Fired:</span><span class="text-yellow-400">15,000+ rounds</span></div>
                                    <div class="flex justify-between"><span>Barrel Condition:</span><span class="text-red-400">Worn beyond spec</span></div>
                                    <div class="flex justify-between"><span>Estimated Cost:</span><span class="text-blue-400">RM 67,500</span></div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Action Plan</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-red-500 rounded-full"></div>
                                        <span>Immediate withdrawal from service</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
                                        <span>Replacement barrels ordered</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                        <span>Armorer team assigned</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                        <span>Completion: 5 days</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'warning':
                    title.textContent = 'Warning Maintenance Alert - Artillery Systems';
                    content.innerHTML = `
                        <div class="bg-yellow-900 bg-opacity-30 border border-yellow-700 rounded p-4 mb-4">
                            <h3 class="font-bold text-yellow-400 mb-2">WARNING - Due in 7 days</h3>
                            <p class="text-sm mb-2"><strong>Systems:</strong> 155mm Howitzers (12 units)</p>
                            <p class="text-sm mb-2"><strong>Service:</strong> Calibration and precision inspection</p>
                            <p class="text-sm"><strong>Location:</strong> Kem Gemas - Artillery Park</p>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Service Schedule</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between"><span>Scheduled Date:</span><span class="text-yellow-400">Dec 28, 2024</span></div>
                                    <div class="flex justify-between"><span>Duration:</span><span class="text-blue-400">3 days per unit</span></div>
                                    <div class="flex justify-between"><span>Specialists:</span><span class="text-green-400">4 assigned</span></div>
                                    <div class="flex justify-between"><span>Equipment Status:</span><span class="text-green-400">Available</span></div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">System Status</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between"><span>Current Accuracy:</span><span class="text-green-400">Within spec</span></div>
                                    <div class="flex justify-between"><span>Operational:</span><span class="text-green-400">Yes</span></div>
                                    <div class="flex justify-between"><span>Last Calibration:</span><span class="text-green-400">6 months ago</span></div>
                                    <div class="flex justify-between"><span>Rounds Fired:</span><span class="text-blue-400">2,450 rounds</span></div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'scheduled':
                    title.textContent = 'Scheduled Maintenance - Machine Guns';
                    content.innerHTML = `
                        <div class="bg-blue-900 bg-opacity-30 border border-blue-700 rounded p-4 mb-4">
                            <h3 class="font-bold text-blue-400 mb-2">SCHEDULED - Due in 14 days</h3>
                            <p class="text-sm mb-2"><strong>Weapons:</strong> M240 Machine Guns (156 units)</p>
                            <p class="text-sm mb-2"><strong>Service:</strong> Routine cleaning and lubrication</p>
                            <p class="text-sm"><strong>Location:</strong> Multiple bases - coordinated schedule</p>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Maintenance Checklist</h4>
                                <div class="space-y-1 text-sm">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                        <span>Complete disassembly and cleaning</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                        <span>Barrel inspection and cleaning</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                        <span>Lubrication of moving parts</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                        <span>Function testing</span>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Resource Allocation</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between"><span>Armorers:</span><span class="text-green-400">12 assigned</span></div>
                                    <div class="flex justify-between"><span>Cleaning Supplies:</span><span class="text-green-400">In stock</span></div>
                                    <div class="flex justify-between"><span>Estimated Time:</span><span class="text-blue-400">2 hours per weapon</span></div>
                                    <div class="flex justify-between"><span>Total Cost:</span><span class="text-green-400">RM 15,600</span></div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'completed':
                    title.textContent = 'Completed Maintenance - Sniper Rifles';
                    content.innerHTML = `
                        <div class="bg-green-900 bg-opacity-30 border border-green-700 rounded p-4 mb-4">
                            <h3 class="font-bold text-green-400 mb-2">COMPLETED - 2 days ago</h3>
                            <p class="text-sm mb-2"><strong>Weapons:</strong> M24 Sniper Rifles (24 units)</p>
                            <p class="text-sm mb-2"><strong>Service:</strong> Scope calibration and precision testing</p>
                            <p class="text-sm"><strong>Location:</strong> Kem Wardieburn - Precision Weapons Section</p>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Work Completed</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between"><span>Scope Calibration:</span><span class="text-green-400">Completed</span></div>
                                    <div class="flex justify-between"><span>Barrel Inspection:</span><span class="text-green-400">Passed</span></div>
                                    <div class="flex justify-between"><span>Accuracy Testing:</span><span class="text-green-400">Within spec</span></div>
                                    <div class="flex justify-between"><span>Documentation:</span><span class="text-green-400">Updated</span></div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Performance Results</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between"><span>Accuracy:</span><span class="text-green-400">0.5 MOA average</span></div>
                                    <div class="flex justify-between"><span>All Systems:</span><span class="text-green-400">Operational</span></div>
                                    <div class="flex justify-between"><span>Next Service:</span><span class="text-blue-400">6 months</span></div>
                                    <div class="flex justify-between"><span>Total Cost:</span><span class="text-green-400">RM 12,800</span></div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
            }
        }

        // Show vehicle type details popup
        function showVehicleTypeDetails(vehicleType) {
            const modal = document.getElementById('drillDownModal');
            const title = document.getElementById('modalTitle');
            const content = document.getElementById('modalContent');
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            title.textContent = `${vehicleType} Fleet - Detailed Analysis`;
            
            const vehicleDetails = {
                'Tanks': {
                    total: 145,
                    operational: 128,
                    maintenance: 12,
                    outOfService: 5,
                    avgAge: '12.3 years',
                    fuelConsumption: '450L/100km',
                    maintenanceCost: 'RM 45,000/month'
                },
                'APCs': {
                    total: 320,
                    operational: 285,
                    maintenance: 25,
                    outOfService: 10,
                    avgAge: '8.7 years',
                    fuelConsumption: '280L/100km',
                    maintenanceCost: 'RM 28,000/month'
                },
                'Trucks': {
                    total: 890,
                    operational: 798,
                    maintenance: 67,
                    outOfService: 25,
                    avgAge: '6.2 years',
                    fuelConsumption: '35L/100km',
                    maintenanceCost: 'RM 89,000/month'
                },
                'Helicopters': {
                    total: 78,
                    operational: 68,
                    maintenance: 8,
                    outOfService: 2,
                    avgAge: '15.8 years',
                    fuelConsumption: '320L/hour',
                    maintenanceCost: 'RM 156,000/month'
                },
                'Artillery': {
                    total: 156,
                    operational: 132,
                    maintenance: 18,
                    outOfService: 6,
                    avgAge: '18.5 years',
                    fuelConsumption: 'N/A',
                    maintenanceCost: 'RM 78,000/month'
                },
                'Support': {
                    total: 258,
                    operational: 230,
                    maintenance: 20,
                    outOfService: 8,
                    avgAge: '9.1 years',
                    fuelConsumption: '25L/100km',
                    maintenanceCost: 'RM 32,000/month'
                }
            };
            
            const details = vehicleDetails[vehicleType];
            
            content.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-green-600 bg-opacity-20 border border-green-500 rounded p-4 text-center">
                        <h3 class="font-bold text-green-400">Operational</h3>
                        <p class="text-3xl font-bold">${details.operational}</p>
                        <p class="text-xs text-slate-300">${((details.operational/details.total)*100).toFixed(1)}% of fleet</p>
                    </div>
                    <div class="bg-yellow-600 bg-opacity-20 border border-yellow-500 rounded p-4 text-center">
                        <h3 class="font-bold text-yellow-400">Maintenance</h3>
                        <p class="text-3xl font-bold">${details.maintenance}</p>
                        <p class="text-xs text-slate-300">${((details.maintenance/details.total)*100).toFixed(1)}% of fleet</p>
                    </div>
                    <div class="bg-red-600 bg-opacity-20 border border-red-500 rounded p-4 text-center">
                        <h3 class="font-bold text-red-400">Out of Service</h3>
                        <p class="text-3xl font-bold">${details.outOfService}</p>
                        <p class="text-xs text-slate-300">${((details.outOfService/details.total)*100).toFixed(1)}% of fleet</p>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-bold mb-3">Fleet Statistics</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between"><span>Total Fleet:</span><span class="text-blue-400">${details.total} vehicles</span></div>
                            <div class="flex justify-between"><span>Average Age:</span><span class="text-yellow-400">${details.avgAge}</span></div>
                            <div class="flex justify-between"><span>Fuel Consumption:</span><span class="text-green-400">${details.fuelConsumption}</span></div>
                            <div class="flex justify-between"><span>Monthly Maintenance:</span><span class="text-purple-400">${details.maintenanceCost}</span></div>
                        </div>
                    </div>
                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-bold mb-3">Performance Metrics</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between"><span>Availability Rate:</span><span class="text-green-400">${((details.operational/details.total)*100).toFixed(1)}%</span></div>
                            <div class="flex justify-between"><span>Reliability Score:</span><span class="text-blue-400">${(Math.random() * 10 + 85).toFixed(1)}%</span></div>
                            <div class="flex justify-between"><span>Utilization Rate:</span><span class="text-yellow-400">${(Math.random() * 20 + 70).toFixed(1)}%</span></div>
                            <div class="flex justify-between"><span>Mission Ready:</span><span class="text-green-400">${Math.floor(details.operational * 0.9)} vehicles</span></div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Show location details popup
        function showLocationDetails(location) {
            const modal = document.getElementById('drillDownModal');
            const title = document.getElementById('modalTitle');
            const content = document.getElementById('modalContent');
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            title.textContent = `${location} - Vehicle Distribution`;
            
            const locationData = {
                'Kem Terendak': {
                    tanks: 45, apcs: 89, trucks: 156, helicopters: 12, artillery: 34, support: 149
                },
                'Kem Gemas': {
                    tanks: 38, apcs: 76, trucks: 134, helicopters: 8, artillery: 28, support: 136
                },
                'Kem Mahkota': {
                    tanks: 32, apcs: 68, trucks: 120, helicopters: 15, artillery: 25, support: 120
                },
                'Kem Wardieburn': {
                    tanks: 20, apcs: 58, trucks: 98, helicopters: 18, artillery: 31, support: 120
                },
                'Kem Sungai Udang': {
                    tanks: 10, apcs: 29, trucks: 89, helicopters: 25, artillery: 38, support: 99
                }
            };
            
            const data = locationData[location] || {
                tanks: 0, apcs: 0, trucks: 293, helicopters: 0, artillery: 0, support: 634
            };
            
            content.innerHTML = `
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                    <div class="bg-red-600 bg-opacity-20 border border-red-500 rounded p-4 text-center">
                        <h3 class="font-bold text-red-400">Tanks</h3>
                        <p class="text-2xl font-bold">${data.tanks}</p>
                        <p class="text-xs text-slate-300">Main Battle Tanks</p>
                    </div>
                    <div class="bg-yellow-600 bg-opacity-20 border border-yellow-500 rounded p-4 text-center">
                        <h3 class="font-bold text-yellow-400">APCs</h3>
                        <p class="text-2xl font-bold">${data.apcs}</p>
                        <p class="text-xs text-slate-300">Armored Personnel Carriers</p>
                    </div>
                    <div class="bg-green-600 bg-opacity-20 border border-green-500 rounded p-4 text-center">
                        <h3 class="font-bold text-green-400">Trucks</h3>
                        <p class="text-2xl font-bold">${data.trucks}</p>
                        <p class="text-xs text-slate-300">Transport & Utility</p>
                    </div>
                    <div class="bg-blue-600 bg-opacity-20 border border-blue-500 rounded p-4 text-center">
                        <h3 class="font-bold text-blue-400">Helicopters</h3>
                        <p class="text-2xl font-bold">${data.helicopters}</p>
                        <p class="text-xs text-slate-300">Utility & Transport</p>
                    </div>
                    <div class="bg-purple-600 bg-opacity-20 border border-purple-500 rounded p-4 text-center">
                        <h3 class="font-bold text-purple-400">Artillery</h3>
                        <p class="text-2xl font-bold">${data.artillery}</p>
                        <p class="text-xs text-slate-300">Artillery Systems</p>
                    </div>
                    <div class="bg-cyan-600 bg-opacity-20 border border-cyan-500 rounded p-4 text-center">
                        <h3 class="font-bold text-cyan-400">Support</h3>
                        <p class="text-2xl font-bold">${data.support}</p>
                        <p class="text-xs text-slate-300">Support Vehicles</p>
                    </div>
                </div>
                <div class="bg-slate-700 rounded-lg p-4 mt-4">
                    <h3 class="font-bold mb-2">Location Details</h3>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div>
                            <p><strong>Total Vehicles:</strong> ${Object.values(data).reduce((a, b) => a + b, 0)}</p>
                            <p><strong>Operational:</strong> ${Math.floor(Object.values(data).reduce((a, b) => a + b, 0) * 0.89)}</p>
                        </div>
                        <div>
                            <p><strong>Under Maintenance:</strong> ${Math.floor(Object.values(data).reduce((a, b) => a + b, 0) * 0.08)}</p>
                            <p><strong>Out of Service:</strong> ${Math.floor(Object.values(data).reduce((a, b) => a + b, 0) * 0.03)}</p>
                        </div>
                    </div>
                </div>
            `;
        }

        // Close modal function
        function closeModal() {
            const modal = document.getElementById('drillDownModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        // Switch training view mode
        function switchTrainingView() {
            const viewMode = document.getElementById('trainingViewMode').value;
            const heatmapView = document.getElementById('trainingHeatmapView');
            const radarView = document.getElementById('trainingRadarView');
            const progressView = document.getElementById('trainingProgressView');
            
            // Hide all views
            heatmapView.classList.add('hidden');
            radarView.classList.add('hidden');
            progressView.classList.add('hidden');
            
            // Show selected view
            switch(viewMode) {
                case 'heatmap':
                    heatmapView.classList.remove('hidden');
                    break;
                case 'radar':
                    radarView.classList.remove('hidden');
                    initializeTrainingRadarChart();
                    break;
                case 'progress':
                    progressView.classList.remove('hidden');
                    break;
            }
        }

        // Initialize training radar chart
        function initializeTrainingRadarChart() {
            const radarCtx = document.getElementById('trainingRadarChart');
            if (radarCtx && !window.trainingRadarChart) {
                window.trainingRadarChart = new Chart(radarCtx, {
                    type: 'radar',
                    data: {
                        labels: ['Combat Training', 'Leadership', 'Technical Skills', 'Physical Fitness'],
                        datasets: [
                            {
                                label: '1st Infantry Division',
                                data: [95, 78, 87, 92],
                                borderColor: '#10b981',
                                backgroundColor: 'rgba(16, 185, 129, 0.2)',
                                pointBackgroundColor: '#10b981',
                                pointBorderColor: '#059669',
                                pointRadius: 4
                            },
                            {
                                label: 'Armored Brigade',
                                data: [92, 75, 89, 84],
                                borderColor: '#3b82f6',
                                backgroundColor: 'rgba(59, 130, 246, 0.2)',
                                pointBackgroundColor: '#3b82f6',
                                pointBorderColor: '#2563eb',
                                pointRadius: 4
                            },
                            {
                                label: 'Special Forces',
                                data: [98, 94, 92, 96],
                                borderColor: '#ef4444',
                                backgroundColor: 'rgba(239, 68, 68, 0.2)',
                                pointBackgroundColor: '#ef4444',
                                pointBorderColor: '#dc2626',
                                pointRadius: 4
                            },
                            {
                                label: 'Artillery Regiment',
                                data: [89, 72, 91, 84],
                                borderColor: '#f59e0b',
                                backgroundColor: 'rgba(245, 158, 11, 0.2)',
                                pointBackgroundColor: '#f59e0b',
                                pointBorderColor: '#d97706',
                                pointRadius: 4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#e2e8f0',
                                    usePointStyle: true,
                                    padding: 15
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(15, 23, 42, 0.9)',
                                titleColor: '#e2e8f0',
                                bodyColor: '#cbd5e1',
                                borderColor: '#475569',
                                borderWidth: 1,
                                cornerRadius: 8,
                                callbacks: {
                                    label: function(context) {
                                        return `${context.dataset.label}: ${context.raw}%`;
                                    }
                                }
                            }
                        },
                        scales: {
                            r: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    color: '#94a3b8',
                                    callback: function(value) {
                                        return value + '%';
                                    },
                                    stepSize: 20
                                },
                                grid: {
                                    color: '#374151'
                                },
                                pointLabels: {
                                    color: '#e2e8f0',
                                    font: {
                                        size: 12
                                    }
                                }
                            }
                        }
                    }
                });
            }
        }

        // Update training chart based on filter
        function updateTrainingChart() {
            const filter = document.getElementById('trainingUnitFilter').value;
            const viewMode = document.getElementById('trainingViewMode').value;
            
            // Update heat map view
            if (viewMode === 'heatmap') {
                updateHeatMapView(filter);
            }
            
            // Update radar chart if it's the active view
            if (viewMode === 'radar' && window.trainingRadarChart) {
                const radarData = {
                    'all': {
                        datasets: [
                            {
                                label: '1st Infantry Division',
                                data: [95, 78, 87, 92],
                                borderColor: '#10b981',
                                backgroundColor: 'rgba(16, 185, 129, 0.2)',
                                pointBackgroundColor: '#10b981',
                                pointBorderColor: '#059669',
                                pointRadius: 4
                            },
                            {
                                label: 'Armored Brigade',
                                data: [92, 75, 89, 84],
                                borderColor: '#3b82f6',
                                backgroundColor: 'rgba(59, 130, 246, 0.2)',
                                pointBackgroundColor: '#3b82f6',
                                pointBorderColor: '#2563eb',
                                pointRadius: 4
                            },
                            {
                                label: 'Special Forces',
                                data: [98, 94, 92, 96],
                                borderColor: '#ef4444',
                                backgroundColor: 'rgba(239, 68, 68, 0.2)',
                                pointBackgroundColor: '#ef4444',
                                pointBorderColor: '#dc2626',
                                pointRadius: 4
                            },
                            {
                                label: 'Artillery Regiment',
                                data: [89, 72, 91, 84],
                                borderColor: '#f59e0b',
                                backgroundColor: 'rgba(245, 158, 11, 0.2)',
                                pointBackgroundColor: '#f59e0b',
                                pointBorderColor: '#d97706',
                                pointRadius: 4
                            }
                        ]
                    },
                    'infantry': {
                        datasets: [{
                            label: '1st Infantry Division',
                            data: [95, 78, 87, 92],
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.2)',
                            pointBackgroundColor: '#10b981',
                            pointBorderColor: '#059669',
                            pointRadius: 4
                        }]
                    },
                    'armored': {
                        datasets: [{
                            label: 'Armored Brigade',
                            data: [92, 75, 89, 84],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.2)',
                            pointBackgroundColor: '#3b82f6',
                            pointBorderColor: '#2563eb',
                            pointRadius: 4
                        }]
                    },
                    'artillery': {
                        datasets: [{
                            label: 'Artillery Regiment',
                            data: [89, 72, 91, 84],
                            borderColor: '#f59e0b',
                            backgroundColor: 'rgba(245, 158, 11, 0.2)',
                            pointBackgroundColor: '#f59e0b',
                            pointBorderColor: '#d97706',
                            pointRadius: 4
                        }]
                    },
                    'engineering': {
                        datasets: [{
                            label: 'Engineering Corps',
                            data: [87, 79, 94, 88],
                            borderColor: '#8b5cf6',
                            backgroundColor: 'rgba(139, 92, 246, 0.2)',
                            pointBackgroundColor: '#8b5cf6',
                            pointBorderColor: '#7c3aed',
                            pointRadius: 4
                        }]
                    },
                    'medical': {
                        datasets: [{
                            label: 'Medical Corps',
                            data: [85, 82, 96, 89],
                            borderColor: '#06b6d4',
                            backgroundColor: 'rgba(6, 182, 212, 0.2)',
                            pointBackgroundColor: '#06b6d4',
                            pointBorderColor: '#0891b2',
                            pointRadius: 4
                        }]
                    },
                    'special': {
                        datasets: [{
                            label: 'Special Forces',
                            data: [98, 94, 92, 96],
                            borderColor: '#ef4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.2)',
                            pointBackgroundColor: '#ef4444',
                            pointBorderColor: '#dc2626',
                            pointRadius: 4
                        }]
                    }
                };
                
                const newData = radarData[filter] || radarData['all'];
                window.trainingRadarChart.data.datasets = newData.datasets;
                window.trainingRadarChart.update('active');
            }
            
            // Update progress cards view
            if (viewMode === 'progress') {
                updateProgressCardsView(filter);
            }
        }

        // Update heat map view based on filter
        function updateHeatMapView(filter) {
            const heatmapView = document.getElementById('trainingHeatmapView');
            
            const unitData = {
                'all': {
                    units: [
                        { name: '1st Infantry Division', color: 'green', overall: 87, combat: 95, leadership: 78, technical: 87, physical: 92 },
                        { name: 'Armored Brigade', color: 'blue', overall: 85, combat: 92, leadership: 75, technical: 89, physical: 84 },
                        { name: 'Artillery Regiment', color: 'yellow', overall: 84, combat: 89, leadership: 72, technical: 91, physical: 84 },
                        { name: 'Engineering Corps', color: 'purple', overall: 87, combat: 87, leadership: 79, technical: 94, physical: 88 },
                        { name: 'Medical Corps', color: 'cyan', overall: 88, combat: 85, leadership: 82, technical: 96, physical: 89 },
                        { name: 'Special Forces', color: 'red', overall: 95, combat: 98, leadership: 94, technical: 92, physical: 96 }
                    ]
                },
                'infantry': {
                    units: [
                        { name: '1st Infantry Division', color: 'green', overall: 87, combat: 95, leadership: 78, technical: 87, physical: 92 }
                    ]
                },
                'armored': {
                    units: [
                        { name: 'Armored Brigade', color: 'blue', overall: 85, combat: 92, leadership: 75, technical: 89, physical: 84 }
                    ]
                },
                'artillery': {
                    units: [
                        { name: 'Artillery Regiment', color: 'yellow', overall: 84, combat: 89, leadership: 72, technical: 91, physical: 84 }
                    ]
                },
                'engineering': {
                    units: [
                        { name: 'Engineering Corps', color: 'purple', overall: 87, combat: 87, leadership: 79, technical: 94, physical: 88 }
                    ]
                },
                'medical': {
                    units: [
                        { name: 'Medical Corps', color: 'cyan', overall: 88, combat: 85, leadership: 82, technical: 96, physical: 89 }
                    ]
                },
                'special': {
                    units: [
                        { name: 'Special Forces', color: 'red', overall: 95, combat: 98, leadership: 94, technical: 92, physical: 96 }
                    ]
                }
            };
            
            const selectedData = unitData[filter] || unitData['all'];
            
            let heatmapHTML = `
                <div class="mb-4">
                    <h3 class="font-semibold text-blue-400 mb-3">Training Completion Heat Map</h3>
                    <div class="grid grid-cols-1 gap-3">
            `;
            
            selectedData.units.forEach(unit => {
                const getColorClass = (score) => {
                    if (score >= 90) return 'bg-green-500';
                    if (score >= 80) return 'bg-blue-500';
                    if (score >= 70) return 'bg-yellow-500';
                    return 'bg-red-500';
                };
                
                heatmapHTML += `
                    <div class="bg-slate-700 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <h4 class="font-semibold text-${unit.color}-400">${unit.name}</h4>
                            <span class="px-2 py-1 bg-${unit.color}-600 text-xs rounded">${unit.overall}% Overall</span>
                        </div>
                        <div class="grid grid-cols-4 gap-2">
                            <div class="text-center">
                                <div class="w-full h-8 ${getColorClass(unit.combat)} rounded mb-1 flex items-center justify-center">
                                    <span class="text-xs font-bold text-white">${unit.combat}%</span>
                                </div>
                                <span class="text-xs text-slate-300">Combat</span>
                            </div>
                            <div class="text-center">
                                <div class="w-full h-8 ${getColorClass(unit.leadership)} rounded mb-1 flex items-center justify-center">
                                    <span class="text-xs font-bold text-white">${unit.leadership}%</span>
                                </div>
                                <span class="text-xs text-slate-300">Leadership</span>
                            </div>
                            <div class="text-center">
                                <div class="w-full h-8 ${getColorClass(unit.technical)} rounded mb-1 flex items-center justify-center">
                                    <span class="text-xs font-bold text-white">${unit.technical}%</span>
                                </div>
                                <span class="text-xs text-slate-300">Technical</span>
                            </div>
                            <div class="text-center">
                                <div class="w-full h-8 ${getColorClass(unit.physical)} rounded mb-1 flex items-center justify-center">
                                    <span class="text-xs font-bold text-white">${unit.physical}%</span>
                                </div>
                                <span class="text-xs text-slate-300">Physical</span>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            heatmapHTML += `
                    </div>
                </div>
            `;
            
            heatmapView.innerHTML = heatmapHTML;
        }

        // Update progress cards view based on filter
        function updateProgressCardsView(filter) {
            const progressView = document.getElementById('trainingProgressView');
            
            const unitData = {
                'all': [
                    { name: '1st Infantry Division', color: 'green', overall: 87, combat: 95, leadership: 78, technical: 87, physical: 92 },
                    { name: 'Armored Brigade', color: 'blue', overall: 85, combat: 92, leadership: 75, technical: 89, physical: 84 },
                    { name: 'Special Forces', color: 'red', overall: 95, combat: 98, leadership: 94, technical: 92, physical: 96 },
                    { name: 'Artillery Regiment', color: 'yellow', overall: 84, combat: 89, leadership: 72, technical: 91, physical: 84 },
                    { name: 'Engineering Corps', color: 'purple', overall: 87, combat: 87, leadership: 79, technical: 94, physical: 88 },
                    { name: 'Medical Corps', color: 'cyan', overall: 88, combat: 85, leadership: 82, technical: 96, physical: 89 }
                ],
                'infantry': [
                    { name: '1st Infantry Division', color: 'green', overall: 87, combat: 95, leadership: 78, technical: 87, physical: 92 }
                ],
                'armored': [
                    { name: 'Armored Brigade', color: 'blue', overall: 85, combat: 92, leadership: 75, technical: 89, physical: 84 }
                ],
                'artillery': [
                    { name: 'Artillery Regiment', color: 'yellow', overall: 84, combat: 89, leadership: 72, technical: 91, physical: 84 }
                ],
                'engineering': [
                    { name: 'Engineering Corps', color: 'purple', overall: 87, combat: 87, leadership: 79, technical: 94, physical: 88 }
                ],
                'medical': [
                    { name: 'Medical Corps', color: 'cyan', overall: 88, combat: 85, leadership: 82, technical: 96, physical: 89 }
                ],
                'special': [
                    { name: 'Special Forces', color: 'red', overall: 95, combat: 98, leadership: 94, technical: 92, physical: 96 }
                ]
            };
            
            const selectedUnits = unitData[filter] || unitData['all'];
            
            let cardsHTML = '<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">';
            
            selectedUnits.forEach(unit => {
                const getScoreColor = (score) => {
                    if (score >= 90) return 'text-green-400';
                    if (score >= 80) return 'text-blue-400';
                    if (score >= 70) return 'text-yellow-400';
                    return 'text-red-400';
                };
                
                cardsHTML += `
                    <div class="bg-slate-700 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <h4 class="font-semibold text-${unit.color}-400">${unit.name}</h4>
                            <div class="w-12 h-12 relative">
                                <svg class="w-12 h-12 transform -rotate-90" viewBox="0 0 36 36">
                                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#374151" stroke-width="2"/>
                                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#${unit.color === 'green' ? '10b981' : unit.color === 'blue' ? '3b82f6' : unit.color === 'red' ? 'ef4444' : unit.color === 'yellow' ? 'f59e0b' : unit.color === 'purple' ? '8b5cf6' : '06b6d4'}" stroke-width="2" stroke-dasharray="${unit.overall}, 100"/>
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <span class="text-xs font-bold text-${unit.color}-400">${unit.overall}%</span>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-2">
                            <div class="flex justify-between text-sm">
                                <span>Combat Training:</span>
                                <span class="${getScoreColor(unit.combat)}">${unit.combat}%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Leadership:</span>
                                <span class="${getScoreColor(unit.leadership)}">${unit.leadership}%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Technical:</span>
                                <span class="${getScoreColor(unit.technical)}">${unit.technical}%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>Physical:</span>
                                <span class="${getScoreColor(unit.physical)}">${unit.physical}%</span>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            cardsHTML += '</div>';
            progressView.innerHTML = cardsHTML;
        }

        // Update appointment chart based on filter
        function updateAppointmentChart() {
            const filter = document.getElementById('timeFilter').value;
            let labels, appointmentData, retirementData;

            switch(filter) {
                case 'month':
                    labels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                    appointmentData = [120, 110, 135, 125, 140, 130, 145, 135, 150, 140, 155, 145];
                    retirementData = [85, 90, 95, 88, 92, 98, 105, 100, 110, 108, 115, 112];
                    break;
                case 'quarter':
                    labels = ['Q1 2023', 'Q2 2023', 'Q3 2023', 'Q4 2023', 'Q1 2024', 'Q2 2024', 'Q3 2024', 'Q4 2024'];
                    appointmentData = [365, 375, 430, 420, 385, 415, 440, 450];
                    retirementData = [270, 280, 315, 310, 285, 295, 325, 335];
                    break;
                default: // year
                    labels = ['2020', '2021', '2022', '2023', '2024'];
                    appointmentData = [1250, 1380, 1420, 1350, 1480];
                    retirementData = [890, 920, 980, 1050, 1120];
            }

            if (appointmentChart) {
                appointmentChart.data.labels = labels;
                appointmentChart.data.datasets[0].data = appointmentData;
                appointmentChart.data.datasets[1].data = retirementData;
                appointmentChart.update();
            }
        }

        // Chart drill-through functionality
        function drillThroughChart(chartType) {
            const modal = document.getElementById('drillDownModal');
            const title = document.getElementById('modalTitle');
            const content = document.getElementById('modalContent');
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            if (chartType === 'personnel') {
                title.textContent = 'Personnel Distribution - Detailed View';
                content.innerHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-slate-700 rounded-lg p-4">
                            <h3 class="font-bold mb-3">Infantry Corps Breakdown</h3>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between"><span>Officers:</span><span class="text-green-400">450 (10%)</span></div>
                                <div class="flex justify-between"><span>NCOs:</span><span class="text-blue-400">1,200 (27%)</span></div>
                                <div class="flex justify-between"><span>Enlisted:</span><span class="text-yellow-400">2,800 (63%)</span></div>
                                <div class="mt-2 pt-2 border-t border-slate-600">
                                    <div class="flex justify-between font-semibold"><span>Total:</span><span>4,450 personnel</span></div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-slate-700 rounded-lg p-4">
                            <h3 class="font-bold mb-3">Armored Corps Breakdown</h3>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between"><span>Officers:</span><span class="text-green-400">180 (10%)</span></div>
                                <div class="flex justify-between"><span>NCOs:</span><span class="text-blue-400">480 (27%)</span></div>
                                <div class="flex justify-between"><span>Enlisted:</span><span class="text-yellow-400">1,140 (63%)</span></div>
                                <div class="mt-2 pt-2 border-t border-slate-600">
                                    <div class="flex justify-between font-semibold"><span>Total:</span><span>1,800 personnel</span></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-bold mb-3">Rank Distribution Across All Corps</h3>
                        <div class="grid grid-cols-3 gap-4 text-center">
                            <div class="bg-slate-600 rounded p-3">
                                <p class="text-2xl font-bold text-green-400">1,075</p>
                                <p class="text-sm">Total Officers</p>
                                <p class="text-xs text-slate-300">4.4% of force</p>
                            </div>
                            <div class="bg-slate-600 rounded p-3">
                                <p class="text-2xl font-bold text-blue-400">2,850</p>
                                <p class="text-sm">Total NCOs</p>
                                <p class="text-xs text-slate-300">11.6% of force</p>
                            </div>
                            <div class="bg-slate-600 rounded p-3">
                                <p class="text-2xl font-bold text-yellow-400">6,795</p>
                                <p class="text-sm">Total Enlisted</p>
                                <p class="text-xs text-slate-300">27.6% of force</p>
                            </div>
                        </div>
                    </div>
                `;
            } else if (chartType === 'appointments') {
                title.textContent = 'Appointments vs Retirements - Detailed Analysis';
                content.innerHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-slate-700 rounded-lg p-4">
                            <h3 class="font-bold mb-3">2024 Monthly Breakdown</h3>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between"><span>Jan 2024:</span><span class="text-green-400">+35 net gain</span></div>
                                <div class="flex justify-between"><span>Feb 2024:</span><span class="text-green-400">+20 net gain</span></div>
                                <div class="flex justify-between"><span>Mar 2024:</span><span class="text-green-400">+40 net gain</span></div>
                                <div class="flex justify-between"><span>Apr 2024:</span><span class="text-green-400">+37 net gain</span></div>
                                <div class="flex justify-between"><span>May 2024:</span><span class="text-green-400">+48 net gain</span></div>
                                <div class="flex justify-between"><span>Jun 2024:</span><span class="text-green-400">+32 net gain</span></div>
                            </div>
                        </div>
                        <div class="bg-slate-700 rounded-lg p-4">
                            <h3 class="font-bold mb-3">Appointment Sources</h3>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between"><span>Military Academy:</span><span class="text-blue-400">45%</span></div>
                                <div class="flex justify-between"><span>Direct Commission:</span><span class="text-green-400">25%</span></div>
                                <div class="flex justify-between"><span>Enlisted Promotion:</span><span class="text-yellow-400">20%</span></div>
                                <div class="flex justify-between"><span>Lateral Entry:</span><span class="text-purple-400">10%</span></div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-slate-700 rounded-lg p-4">
                        <h3 class="font-bold mb-3">Retirement Analysis</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <h4 class="font-semibold mb-2">Retirement Reasons</h4>
                                <div class="space-y-1 text-sm">
                                    <div class="flex justify-between"><span>Age Retirement:</span><span>65%</span></div>
                                    <div class="flex justify-between"><span>Medical:</span><span>20%</span></div>
                                    <div class="flex justify-between"><span>Voluntary:</span><span>15%</span></div>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-semibold mb-2">Average Service Years</h4>
                                <div class="space-y-1 text-sm">
                                    <div class="flex justify-between"><span>Officers:</span><span class="text-green-400">25.3 years</span></div>
                                    <div class="flex justify-between"><span>NCOs:</span><span class="text-blue-400">22.1 years</span></div>
                                    <div class="flex justify-between"><span>Enlisted:</span><span class="text-yellow-400">18.7 years</span></div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        // View alert function
        function viewAlert(alertType) {
            const modal = document.getElementById('drillDownModal');
            const title = document.getElementById('modalTitle');
            const content = document.getElementById('modalContent');
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            switch(alertType) {
                case 'supply':
                    title.textContent = 'Supply Chain Disruption - Critical Alert';
                    content.innerHTML = `
                        <div class="bg-red-900 bg-opacity-30 border border-red-700 rounded p-4 mb-4">
                            <h3 class="font-bold text-red-400 mb-2">Alert Details</h3>
                            <p class="text-sm mb-2"><strong>Location:</strong> Eastern Command - Sabah & Sarawak</p>
                            <p class="text-sm mb-2"><strong>Issue:</strong> Ammunition supplies below critical threshold (15% remaining)</p>
                            <p class="text-sm mb-2"><strong>Impact:</strong> Training exercises suspended, operational readiness reduced</p>
                            <p class="text-sm"><strong>Estimated Resolution:</strong> 72 hours</p>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Current Inventory</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between"><span>5.56mm Rounds:</span><span class="text-red-400">12% remaining</span></div>
                                    <div class="flex justify-between"><span>7.62mm Rounds:</span><span class="text-red-400">8% remaining</span></div>
                                    <div class="flex justify-between"><span>Artillery Shells:</span><span class="text-yellow-400">25% remaining</span></div>
                                    <div class="flex justify-between"><span>Training Blanks:</span><span class="text-red-400">5% remaining</span></div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Action Plan</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                        <span>Emergency resupply ordered</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
                                        <span>Transport aircraft dispatched</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                        <span>Alternative suppliers contacted</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-purple-500 rounded-full"></div>
                                        <span>Inventory protocols reviewed</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'training':
                    title.textContent = 'Training Exercise Delayed - Weather Alert';
                    content.innerHTML = `
                        <div class="bg-yellow-900 bg-opacity-30 border border-yellow-700 rounded p-4 mb-4">
                            <h3 class="font-bold text-yellow-400 mb-2">Alert Details</h3>
                            <p class="text-sm mb-2"><strong>Exercise:</strong> Operation Thunder - Joint Combat Training</p>
                            <p class="text-sm mb-2"><strong>Location:</strong> Central Command - Kem Gemas Training Area</p>
                            <p class="text-sm mb-2"><strong>Issue:</strong> Severe weather conditions (thunderstorms, heavy rain)</p>
                            <p class="text-sm"><strong>New Schedule:</strong> Postponed by 48 hours</p>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Weather Conditions</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between"><span>Current:</span><span class="text-red-400">Severe Thunderstorm</span></div>
                                    <div class="flex justify-between"><span>Visibility:</span><span class="text-red-400">< 500m</span></div>
                                    <div class="flex justify-between"><span>Wind Speed:</span><span class="text-yellow-400">45 km/h</span></div>
                                    <div class="flex justify-between"><span>Forecast:</span><span class="text-green-400">Clear in 36 hours</span></div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Impact Assessment</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between"><span>Personnel Affected:</span><span class="text-blue-400">1,200 troops</span></div>
                                    <div class="flex justify-between"><span>Equipment Staged:</span><span class="text-yellow-400">45 vehicles</span></div>
                                    <div class="flex justify-between"><span>Training Days Lost:</span><span class="text-red-400">2 days</span></div>
                                    <div class="flex justify-between"><span>Budget Impact:</span><span class="text-yellow-400">RM 150,000</span></div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'maintenance':
                    title.textContent = 'Equipment Maintenance - Scheduled Service';
                    content.innerHTML = `
                        <div class="bg-blue-900 bg-opacity-30 border border-blue-700 rounded p-4 mb-4">
                            <h3 class="font-bold text-blue-400 mb-2">Maintenance Schedule</h3>
                            <p class="text-sm mb-2"><strong>Location:</strong> Northern Command - Kem Terendak</p>
                            <p class="text-sm mb-2"><strong>Vehicles:</strong> 12 Armored Personnel Carriers</p>
                            <p class="text-sm mb-2"><strong>Type:</strong> Routine 6-month service and inspection</p>
                            <p class="text-sm"><strong>Duration:</strong> 5 days per vehicle</p>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Maintenance Details</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between"><span>Engine Service:</span><span class="text-green-400">Scheduled</span></div>
                                    <div class="flex justify-between"><span>Armor Inspection:</span><span class="text-green-400">Scheduled</span></div>
                                    <div class="flex justify-between"><span>Weapons Systems:</span><span class="text-yellow-400">Calibration</span></div>
                                    <div class="flex justify-between"><span>Communication:</span><span class="text-blue-400">Upgrade</span></div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Resource Allocation</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between"><span>Technicians:</span><span class="text-green-400">8 assigned</span></div>
                                    <div class="flex justify-between"><span>Parts Inventory:</span><span class="text-green-400">100% available</span></div>
                                    <div class="flex justify-between"><span>Workshop Bays:</span><span class="text-blue-400">4 allocated</span></div>
                                    <div class="flex justify-between"><span>Estimated Cost:</span><span class="text-yellow-400">RM 240,000</span></div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
            }
        }

        // Drill down functionality
        function drillDown(category) {
            const modal = document.getElementById('drillDownModal');
            const title = document.getElementById('modalTitle');
            const content = document.getElementById('modalContent');
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            switch(category) {
                case 'personnel':
                    title.textContent = 'Personnel Readiness Details';
                    content.innerHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">By Rank Distribution</h3>
                                <div class="space-y-2">
                                    <div class="flex justify-between"><span>Officers:</span><span class="text-green-400">98% (2,450/2,500)</span></div>
                                    <div class="flex justify-between"><span>NCOs:</span><span class="text-green-400">94% (7,520/8,000)</span></div>
                                    <div class="flex justify-between"><span>Enlisted:</span><span class="text-yellow-400">89% (14,610/16,217)</span></div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">Medical Status</h3>
                                <div class="space-y-2">
                                    <div class="flex justify-between"><span>Fit for Duty:</span><span class="text-green-400">22,890</span></div>
                                    <div class="flex justify-between"><span>Limited Duty:</span><span class="text-yellow-400">1,240</span></div>
                                    <div class="flex justify-between"><span>Medical Leave:</span><span class="text-red-400">450</span></div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-slate-700 rounded-lg p-4">
                            <h3 class="font-bold mb-3">Training Certifications</h3>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                <div class="text-center"><span class="block text-2xl font-bold text-green-400">95%</span><span class="text-sm">Combat Ready</span></div>
                                <div class="text-center"><span class="block text-2xl font-bold text-blue-400">87%</span><span class="text-sm">Specialized Skills</span></div>
                                <div class="text-center"><span class="block text-2xl font-bold text-yellow-400">78%</span><span class="text-sm">Leadership</span></div>
                                <div class="text-center"><span class="block text-2xl font-bold text-green-400">92%</span><span class="text-sm">Physical Fitness</span></div>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'equipment':
                    title.textContent = 'Equipment Status Details';
                    content.innerHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">Vehicles</h3>
                                <div class="space-y-2">
                                    <div class="flex justify-between"><span>Operational:</span><span class="text-green-400">89% (2,534)</span></div>
                                    <div class="flex justify-between"><span>Maintenance:</span><span class="text-yellow-400">8% (228)</span></div>
                                    <div class="flex justify-between"><span>Out of Service:</span><span class="text-red-400">3% (85)</span></div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">Weapons Systems</h3>
                                <div class="space-y-2">
                                    <div class="flex justify-between"><span>Small Arms:</span><span class="text-green-400">96% (24,576)</span></div>
                                    <div class="flex justify-between"><span>Heavy Weapons:</span><span class="text-yellow-400">82% (1,312)</span></div>
                                    <div class="flex justify-between"><span>Artillery:</span><span class="text-yellow-400">75% (156)</span></div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">Communication</h3>
                                <div class="space-y-2">
                                    <div class="flex justify-between"><span>Radio Systems:</span><span class="text-green-400">94% (2,820)</span></div>
                                    <div class="flex justify-between"><span>Satellite Comms:</span><span class="text-green-400">98% (45)</span></div>
                                    <div class="flex justify-between"><span>Field Networks:</span><span class="text-yellow-400">78% (156)</span></div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-slate-700 rounded-lg p-4">
                            <h3 class="font-bold mb-3">Critical Equipment Issues</h3>
                            <div class="space-y-2 text-sm">
                                <div class="p-2 bg-red-900 bg-opacity-30 rounded border border-red-700">
                                    <span class="font-semibold text-red-400">High Priority:</span> 12 Main Battle Tanks require engine overhaul
                                </div>
                                <div class="p-2 bg-yellow-900 bg-opacity-30 rounded border border-yellow-700">
                                    <span class="font-semibold text-yellow-400">Medium Priority:</span> 45 Communication systems need software updates
                                </div>
                                <div class="p-2 bg-blue-900 bg-opacity-30 rounded border border-blue-700">
                                    <span class="font-semibold text-blue-400">Low Priority:</span> 156 Small arms scheduled for routine maintenance
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'training':
                    title.textContent = 'Training Completion Details';
                    content.innerHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">Q4 2024 Training Progress</h3>
                                <div class="space-y-3">
                                    <div>
                                        <div class="flex justify-between mb-1"><span>Combat Training</span><span class="text-green-400">95%</span></div>
                                        <div class="w-full bg-slate-600 rounded-full h-2"><div class="bg-green-500 h-2 rounded-full" style="width: 95%"></div></div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between mb-1"><span>Leadership Development</span><span class="text-yellow-400">78%</span></div>
                                        <div class="w-full bg-slate-600 rounded-full h-2"><div class="bg-yellow-500 h-2 rounded-full" style="width: 78%"></div></div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between mb-1"><span>Technical Skills</span><span class="text-blue-400">87%</span></div>
                                        <div class="w-full bg-slate-600 rounded-full h-2"><div class="bg-blue-500 h-2 rounded-full" style="width: 87%"></div></div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">Upcoming Training</h3>
                                <div class="space-y-2 text-sm">
                                    <div class="p-2 bg-slate-600 rounded">
                                        <p class="font-semibold">Advanced Marksmanship</p>
                                        <p class="text-slate-300">Jan 15-20, 2025 | 450 personnel</p>
                                    </div>
                                    <div class="p-2 bg-slate-600 rounded">
                                        <p class="font-semibold">Joint Operations Exercise</p>
                                        <p class="text-slate-300">Feb 1-14, 2025 | 1,200 personnel</p>
                                    </div>
                                    <div class="p-2 bg-slate-600 rounded">
                                        <p class="font-semibold">Cyber Security Training</p>
                                        <p class="text-slate-300">Feb 20-25, 2025 | 180 personnel</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-slate-700 rounded-lg p-4">
                            <h3 class="font-bold mb-3">Training Performance by Unit</h3>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-4 text-center">
                                <div class="bg-slate-600 rounded p-3">
                                    <p class="text-xl font-bold text-green-400">92%</p>
                                    <p class="text-sm">Infantry Division</p>
                                </div>
                                <div class="bg-slate-600 rounded p-3">
                                    <p class="text-xl font-bold text-blue-400">88%</p>
                                    <p class="text-sm">Armored Brigade</p>
                                </div>
                                <div class="bg-slate-600 rounded p-3">
                                    <p class="text-xl font-bold text-yellow-400">85%</p>
                                    <p class="text-sm">Artillery Regiment</p>
                                </div>
                                <div class="bg-slate-600 rounded p-3">
                                    <p class="text-xl font-bold text-green-400">94%</p>
                                    <p class="text-sm">Special Forces</p>
                                </div>
                                <div class="bg-slate-600 rounded p-3">
                                    <p class="text-xl font-bold text-blue-400">89%</p>
                                    <p class="text-sm">Engineering Corps</p>
                                </div>
                                <div class="bg-slate-600 rounded p-3">
                                    <p class="text-xl font-bold text-green-400">91%</p>
                                    <p class="text-sm">Medical Corps</p>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'logistics':
                    title.textContent = 'Supply Chain Status Details';
                    content.innerHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">Critical Supply Levels</h3>
                                <div class="space-y-3">
                                    <div class="p-2 bg-red-900 bg-opacity-30 rounded border border-red-700">
                                        <div class="flex justify-between"><span class="font-semibold text-red-400">Ammunition</span><span class="text-red-400">15%</span></div>
                                        <p class="text-xs text-slate-300">Below minimum threshold</p>
                                    </div>
                                    <div class="p-2 bg-yellow-900 bg-opacity-30 rounded border border-yellow-700">
                                        <div class="flex justify-between"><span class="font-semibold text-yellow-400">Fuel</span><span class="text-yellow-400">35%</span></div>
                                        <p class="text-xs text-slate-300">Approaching minimum</p>
                                    </div>
                                    <div class="p-2 bg-green-900 bg-opacity-30 rounded border border-green-700">
                                        <div class="flex justify-between"><span class="font-semibold text-green-400">Medical Supplies</span><span class="text-green-400">85%</span></div>
                                        <p class="text-xs text-slate-300">Adequate stock</p>
                                    </div>
                                    <div class="p-2 bg-green-900 bg-opacity-30 rounded border border-green-700">
                                        <div class="flex justify-between"><span class="font-semibold text-green-400">Food Rations</span><span class="text-green-400">92%</span></div>
                                        <p class="text-xs text-slate-300">Well stocked</p>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">Supply Chain Actions</h3>
                                <div class="space-y-2 text-sm">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-red-500 rounded-full animate-pulse"></div>
                                        <span>Emergency ammunition procurement initiated</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
                                        <span>Fuel delivery scheduled for next week</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                        <span>Alternative suppliers being evaluated</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                        <span>Inventory management system upgrade</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-slate-700 rounded-lg p-4">
                            <h3 class="font-bold mb-3">Supply Distribution by Command</h3>
                            <div class="grid grid-cols-3 gap-4">
                                <div class="text-center">
                                    <p class="text-lg font-bold text-green-400">Northern</p>
                                    <p class="text-sm text-slate-300">Supply Status: Good</p>
                                    <p class="text-xs text-slate-400">Last resupply: 3 days ago</p>
                                </div>
                                <div class="text-center">
                                    <p class="text-lg font-bold text-yellow-400">Central</p>
                                    <p class="text-sm text-slate-300">Supply Status: Fair</p>
                                    <p class="text-xs text-slate-400">Last resupply: 7 days ago</p>
                                </div>
                                <div class="text-center">
                                    <p class="text-lg font-bold text-red-400">Eastern</p>
                                    <p class="text-sm text-slate-300">Supply Status: Critical</p>
                                    <p class="text-xs text-slate-400">Last resupply: 14 days ago</p>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'northern':
                case 'central':
                case 'eastern':
                    const commandNames = {
                        'northern': 'Northern Command',
                        'central': 'Central Command', 
                        'eastern': 'Eastern Command'
                    };
                    
                    const commandData = {
                        'northern': {
                            personnel: '94%', equipment: '89%', bases: 'Perlis, Kedah, Penang',
                            totalPersonnel: 8450, readyPersonnel: 7943, maintenanceVehicles: 23, criticalIssues: 2
                        },
                        'central': {
                            personnel: '91%', equipment: '72%', bases: 'KL, Selangor, Perak',
                            totalPersonnel: 9200, readyPersonnel: 8372, maintenanceVehicles: 45, criticalIssues: 8
                        },
                        'eastern': {
                            personnel: '88%', equipment: '85%', bases: 'Sabah, Sarawak',
                            totalPersonnel: 6930, readyPersonnel: 6098, maintenanceVehicles: 18, criticalIssues: 3
                        }
                    };
                    
                    const data = commandData[category];
                    title.textContent = `${commandNames[category]} - Detailed Status`;
                    content.innerHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">Personnel Status</h3>
                                <div class="space-y-2">
                                    <div class="flex justify-between"><span>Total Personnel:</span><span class="text-blue-400">${data.totalPersonnel.toLocaleString()}</span></div>
                                    <div class="flex justify-between"><span>Ready for Duty:</span><span class="text-green-400">${data.readyPersonnel.toLocaleString()}</span></div>
                                    <div class="flex justify-between"><span>Readiness Rate:</span><span class="text-green-400">${data.personnel}</span></div>
                                    <div class="flex justify-between"><span>On Leave:</span><span class="text-yellow-400">${(data.totalPersonnel - data.readyPersonnel).toLocaleString()}</span></div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">Equipment Status</h3>
                                <div class="space-y-2">
                                    <div class="flex justify-between"><span>Equipment Ready:</span><span class="text-green-400">${data.equipment}</span></div>
                                    <div class="flex justify-between"><span>Under Maintenance:</span><span class="text-yellow-400">${data.maintenanceVehicles} vehicles</span></div>
                                    <div class="flex justify-between"><span>Critical Issues:</span><span class="text-red-400">${data.criticalIssues} items</span></div>
                                    <div class="flex justify-between"><span>Operational Vehicles:</span><span class="text-green-400">89%</span></div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-slate-700 rounded-lg p-4">
                            <h3 class="font-bold mb-3">Base Locations</h3>
                            <p class="text-slate-300 mb-3">${data.bases}</p>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                                <div class="bg-slate-600 rounded p-3">
                                    <p class="text-xl font-bold text-green-400">95%</p>
                                    <p class="text-sm">Combat Ready</p>
                                </div>
                                <div class="bg-slate-600 rounded p-3">
                                    <p class="text-xl font-bold text-blue-400">87%</p>
                                    <p class="text-sm">Training Complete</p>
                                </div>
                                <div class="bg-slate-600 rounded p-3">
                                    <p class="text-xl font-bold text-yellow-400">78%</p>
                                    <p class="text-sm">Supply Level</p>
                                </div>
                                <div class="bg-slate-600 rounded p-3">
                                    <p class="text-xl font-bold text-green-400">92%</p>
                                    <p class="text-sm">Morale Score</p>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'workforce-planning':
                    title.textContent = 'Workforce Planning - Detailed Forecast';
                    content.innerHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">5-Year Retirement Projection</h3>
                                <div class="space-y-3">
                                    <div class="p-3 bg-slate-600 rounded">
                                        <div class="flex justify-between mb-1"><span>2025</span><span class="text-yellow-400">1,240 personnel</span></div>
                                        <div class="text-xs text-slate-300">Peak retirement year for 1990s recruits</div>
                                    </div>
                                    <div class="p-3 bg-slate-600 rounded">
                                        <div class="flex justify-between mb-1"><span>2026</span><span class="text-yellow-400">1,380 personnel</span></div>
                                        <div class="text-xs text-slate-300">Officer retirement surge expected</div>
                                    </div>
                                    <div class="p-3 bg-slate-600 rounded">
                                        <div class="flex justify-between mb-1"><span>2027</span><span class="text-red-400">1,520 personnel</span></div>
                                        <div class="text-xs text-slate-300">Critical year - highest retirement rate</div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">Recruitment Strategy</h3>
                                <div class="space-y-2">
                                    <div class="p-2 bg-green-900 bg-opacity-30 rounded border border-green-700">
                                        <div class="flex justify-between"><span class="font-semibold text-green-400">Officers</span><span class="text-green-400">+180 needed</span></div>
                                        <p class="text-xs text-slate-300">Focus on engineering and cyber specialists</p>
                                    </div>
                                    <div class="p-2 bg-yellow-900 bg-opacity-30 rounded border border-yellow-700">
                                        <div class="flex justify-between"><span class="font-semibold text-yellow-400">NCOs</span><span class="text-yellow-400">+450 needed</span></div>
                                        <p class="text-xs text-slate-300">Leadership development pipeline</p>
                                    </div>
                                    <div class="p-2 bg-red-900 bg-opacity-30 rounded border border-red-700">
                                        <div class="flex justify-between"><span class="font-semibold text-red-400">Specialists</span><span class="text-red-400">+320 critical</span></div>
                                        <p class="text-xs text-slate-300">Technical skills shortage</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'skill-matching':
                    title.textContent = 'AI Skill Matching - Recommendations';
                    content.innerHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">Top Transfer Recommendations</h3>
                                <div class="space-y-3">
                                    <div class="p-3 bg-slate-600 rounded">
                                        <div class="flex justify-between mb-1">
                                            <span class="font-semibold">Sgt. Ahmad Rahman</span>
                                            <span class="px-2 py-1 bg-green-600 text-xs rounded">98% Match</span>
                                        </div>
                                        <p class="text-sm text-slate-300">Infantry → Cyber Security Unit</p>
                                        <p class="text-xs text-slate-400">Skills: Programming, Network Security, Leadership</p>
                                    </div>
                                    <div class="p-3 bg-slate-600 rounded">
                                        <div class="flex justify-between mb-1">
                                            <span class="font-semibold">Lt. Sarah Lim</span>
                                            <span class="px-2 py-1 bg-green-600 text-xs rounded">95% Match</span>
                                        </div>
                                        <p class="text-sm text-slate-300">Artillery → Engineering Corps</p>
                                        <p class="text-xs text-slate-400">Skills: Mathematics, Project Management, Technical Analysis</p>
                                    </div>
                                    <div class="p-3 bg-slate-600 rounded">
                                        <div class="flex justify-between mb-1">
                                            <span class="font-semibold">Cpl. Raj Kumar</span>
                                            <span class="px-2 py-1 bg-blue-600 text-xs rounded">92% Match</span>
                                        </div>
                                        <p class="text-sm text-slate-300">Medical → Special Forces</p>
                                        <p class="text-xs text-slate-400">Skills: Emergency Medicine, Physical Fitness, Decision Making</p>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">Training Recommendations</h3>
                                <div class="space-y-2">
                                    <div class="p-2 bg-blue-900 bg-opacity-30 rounded border border-blue-700">
                                        <div class="flex justify-between"><span class="font-semibold text-blue-400">Leadership Development</span><span class="text-blue-400">245 personnel</span></div>
                                        <p class="text-xs text-slate-300">Mid-level management skills</p>
                                    </div>
                                    <div class="p-2 bg-yellow-900 bg-opacity-30 rounded border border-yellow-700">
                                        <div class="flex justify-between"><span class="font-semibold text-yellow-400">Technical Upskilling</span><span class="text-yellow-400">890 personnel</span></div>
                                        <p class="text-xs text-slate-300">Digital literacy and advanced systems</p>
                                    </div>
                                    <div class="p-2 bg-green-900 bg-opacity-30 rounded border border-green-700">
                                        <div class="flex justify-between"><span class="font-semibold text-green-400">Cross-Training</span><span class="text-green-400">156 personnel</span></div>
                                        <p class="text-xs text-slate-300">Multi-role capability development</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'attrition-risk':
                    title.textContent = 'Attrition Risk Assessment';
                    content.innerHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">High Risk Personnel</h3>
                                <div class="space-y-3">
                                    <div class="p-3 bg-red-900 bg-opacity-30 rounded border border-red-700">
                                        <div class="flex justify-between mb-1">
                                            <span class="font-semibold">Lt. Col. Hassan Ali</span>
                                            <span class="px-2 py-1 bg-red-600 text-xs rounded">High Risk</span>
                                        </div>
                                        <p class="text-sm text-slate-300">Risk Factors: Work-life balance, career stagnation</p>
                                        <p class="text-xs text-slate-400">Recommended: Career counseling, promotion consideration</p>
                                    </div>
                                    <div class="p-3 bg-red-900 bg-opacity-30 rounded border border-red-700">
                                        <div class="flex justify-between mb-1">
                                            <span class="font-semibold">Maj. Priya Sharma</span>
                                            <span class="px-2 py-1 bg-red-600 text-xs rounded">High Risk</span>
                                        </div>
                                        <p class="text-sm text-slate-300">Risk Factors: Family relocation, compensation</p>
                                        <p class="text-xs text-slate-400">Recommended: Transfer options, family support</p>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">Retention Initiatives</h3>
                                <div class="space-y-2">
                                    <div class="p-2 bg-blue-900 bg-opacity-30 rounded border border-blue-700">
                                        <div class="flex justify-between"><span class="font-semibold text-blue-400">Career Counseling</span><span class="text-blue-400">1,240 scheduled</span></div>
                                        <p class="text-xs text-slate-300">One-on-one career planning sessions</p>
                                    </div>
                                    <div class="p-2 bg-green-900 bg-opacity-30 rounded border border-green-700">
                                        <div class="flex justify-between"><span class="font-semibold text-green-400">Skill Development</span><span class="text-green-400">890 enrolled</span></div>
                                        <p class="text-xs text-slate-300">Professional development programs</p>
                                    </div>
                                    <div class="p-2 bg-purple-900 bg-opacity-30 rounded border border-purple-700">
                                        <div class="flex justify-between"><span class="font-semibold text-purple-400">Mentorship Program</span><span class="text-purple-400">456 matched</span></div>
                                        <p class="text-xs text-slate-300">Senior-junior mentoring relationships</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'route-optimization':
                    title.textContent = 'Route Optimization - Detailed Analysis';
                    content.innerHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">Today's Optimized Routes</h3>
                                <div class="space-y-3">
                                    <div class="p-3 bg-green-900 bg-opacity-30 rounded border border-green-700">
                                        <div class="flex justify-between mb-1">
                                            <span class="font-semibold">Patrol Route Alpha-7</span>
                                            <span class="px-2 py-1 bg-green-600 text-xs rounded">Completed</span>
                                        </div>
                                        <p class="text-sm text-slate-300">Original: 4.5 hours | Optimized: 3.75 hours</p>
                                        <p class="text-xs text-slate-400">Fuel saved: 12L | Distance reduced: 23km</p>
                                    </div>
                                    <div class="p-3 bg-blue-900 bg-opacity-30 rounded border border-blue-700">
                                        <div class="flex justify-between mb-1">
                                            <span class="font-semibold">Supply Run Bravo-3</span>
                                            <span class="px-2 py-1 bg-blue-600 text-xs rounded">In Progress</span>
                                        </div>
                                        <p class="text-sm text-slate-300">ETA: 14:30 | Progress: 65%</p>
                                        <p class="text-xs text-slate-400">Current savings: 8L fuel, 18 minutes</p>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">Weekly Performance</h3>
                                <div class="space-y-2">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm">Routes Optimized:</span>
                                        <span class="text-green-400 font-semibold">156/180 (87%)</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm">Total Fuel Saved:</span>
                                        <span class="text-green-400 font-semibold">2,340L</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm">Time Saved:</span>
                                        <span class="text-green-400 font-semibold">45.5 hours</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm">Cost Savings:</span>
                                        <span class="text-green-400 font-semibold">RM 18,450</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'usage-patterns':
                    title.textContent = 'Usage Pattern Analysis - Detailed View';
                    content.innerHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">Vehicle Utilization by Type</h3>
                                <div class="space-y-3">
                                    <div class="p-2 bg-slate-600 rounded">
                                        <div class="flex justify-between mb-1">
                                            <span class="font-semibold">Tanks</span>
                                            <span class="text-yellow-400">65% utilization</span>
                                        </div>
                                        <div class="w-full bg-slate-500 rounded-full h-2">
                                            <div class="bg-yellow-500 h-2 rounded-full" style="width: 65%"></div>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-slate-600 rounded">
                                        <div class="flex justify-between mb-1">
                                            <span class="font-semibold">Transport Trucks</span>
                                            <span class="text-green-400">89% utilization</span>
                                        </div>
                                        <div class="w-full bg-slate-500 rounded-full h-2">
                                            <div class="bg-green-500 h-2 rounded-full" style="width: 89%"></div>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-slate-600 rounded">
                                        <div class="flex justify-between mb-1">
                                            <span class="font-semibold">Helicopters</span>
                                            <span class="text-red-400">45% utilization</span>
                                        </div>
                                        <div class="w-full bg-slate-500 rounded-full h-2">
                                            <div class="bg-red-500 h-2 rounded-full" style="width: 45%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded-lg p-4">
                                <h3 class="font-bold mb-3">Optimization Recommendations</h3>
                                <div class="space-y-2 text-sm">
                                    <div class="p-2 bg-green-900 bg-opacity-30 rounded border border-green-700">
                                        <span class="font-semibold text-green-400">High Priority:</span>
                                        <p class="text-slate-300 mt-1">Redistribute 12 helicopters from Kem Wardieburn to active operations</p>
                                    </div>
                                    <div class="p-2 bg-yellow-900 bg-opacity-30 rounded border border-yellow-700">
                                        <span class="font-semibold text-yellow-400">Medium Priority:</span>
                                        <p class="text-slate-300 mt-1">Schedule tank training during low-usage periods (22:00-06:00)</p>
                                    </div>
                                    <div class="p-2 bg-blue-900 bg-opacity-30 rounded border border-blue-700">
                                        <span class="font-semibold text-blue-400">Low Priority:</span>
                                        <p class="text-slate-300 mt-1">Implement predictive scheduling for transport trucks</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                default:
                    title.textContent = 'Information Not Available';
                    content.innerHTML = '<p class="text-slate-300">Detailed information for this section is currently being updated.</p>';
            }
        }

        // View maintenance alert function
        function viewMaintenanceAlert(alertType) {
            const modal = document.getElementById('drillDownModal');
            const title = document.getElementById('modalTitle');
            const content = document.getElementById('modalContent');
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            switch(alertType) {
                case 'critical':
                    title.textContent = 'Critical Maintenance Alert - MY-T045-2010';
                    content.innerHTML = `
                        <div class="bg-red-900 bg-opacity-30 border border-red-700 rounded p-4 mb-4">
                            <h3 class="font-bold text-red-400 mb-2">CRITICAL - Immediate Action Required</h3>
                            <p class="text-sm mb-2"><strong>Vehicle:</strong> MY-T045-2010 (Main Battle Tank)</p>
                            <p class="text-sm mb-2"><strong>Issue:</strong> Engine overhaul required - 25,000 km overdue</p>
                            <p class="text-sm mb-2"><strong>Risk Level:</strong> Vehicle may fail during operation</p>
                            <p class="text-sm"><strong>Location:</strong> Kem Terendak - Bay 3</p>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Maintenance Details</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between"><span>Last Service:</span><span class="text-red-400">18 months ago</span></div>
                                    <div class="flex justify-between"><span>Mileage:</span><span class="text-yellow-400">125,000 km</span></div>
                                    <div class="flex justify-between"><span>Engine Hours:</span><span class="text-red-400">8,450 hours</span></div>
                                    <div class="flex justify-between"><span>Estimated Cost:</span><span class="text-blue-400">RM 45,000</span></div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Action Plan</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-red-500 rounded-full"></div>
                                        <span>Immediate removal from service</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
                                        <span>Parts ordered - ETA 48 hours</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                        <span>Technician team assigned</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                        <span>Estimated completion: 7 days</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'warning':
                    title.textContent = 'Warning Maintenance Alert - MY-APC-2015';
                    content.innerHTML = `
                        <div class="bg-yellow-900 bg-opacity-30 border border-yellow-700 rounded p-4 mb-4">
                            <h3 class="font-bold text-yellow-400 mb-2">WARNING - Due in 7 days</h3>
                            <p class="text-sm mb-2"><strong>Vehicle:</strong> MY-APC-2015 (Armored Personnel Carrier)</p>
                            <p class="text-sm mb-2"><strong>Service:</strong> Transmission service and fluid change</p>
                            <p class="text-sm"><strong>Location:</strong> Kem Gemas - Motor Pool</p>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Service Schedule</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between"><span>Scheduled Date:</span><span class="text-yellow-400">Dec 28, 2024</span></div>
                                    <div class="flex justify-between"><span>Duration:</span><span class="text-blue-400">2 days</span></div>
                                    <div class="flex justify-between"><span>Technicians:</span><span class="text-green-400">2 assigned</span></div>
                                    <div class="flex justify-between"><span>Parts Status:</span><span class="text-green-400">In stock</span></div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Vehicle Status</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between"><span>Current Condition:</span><span class="text-green-400">Good</span></div>
                                    <div class="flex justify-between"><span>Operational:</span><span class="text-green-400">Yes</span></div>
                                    <div class="flex justify-between"><span>Last Service:</span><span class="text-green-400">6 months ago</span></div>
                                    <div class="flex justify-between"><span>Mileage:</span><span class="text-blue-400">45,200 km</span></div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'scheduled':
                    title.textContent = 'Scheduled Maintenance - MY-HEL-2018';
                    content.innerHTML = `
                        <div class="bg-blue-900 bg-opacity-30 border border-blue-700 rounded p-4 mb-4">
                            <h3 class="font-bold text-blue-400 mb-2">SCHEDULED - Due in 14 days</h3>
                            <p class="text-sm mb-2"><strong>Aircraft:</strong> MY-HEL-2018 (Utility Helicopter)</p>
                            <p class="text-sm mb-2"><strong>Service:</strong> Routine inspection and preventive maintenance</p>
                            <p class="text-sm"><strong>Location:</strong> Kem Wardieburn - Hangar 2</p>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Inspection Checklist</h4>
                                <div class="space-y-1 text-sm">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                        <span>Engine inspection</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                        <span>Rotor system check</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                        <span>Avionics testing</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                        <span>Hydraulic system service</span>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Flight Status</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between"><span>Flight Hours:</span><span class="text-green-400">1,245 hours</span></div>
                                    <div class="flex justify-between"><span>Last Inspection:</span><span class="text-green-400">3 months ago</span></div>
                                    <div class="flex justify-between"><span>Airworthiness:</span><span class="text-green-400">Valid</span></div>
                                    <div class="flex justify-between"><span>Next Major:</span><span class="text-blue-400">6 months</span></div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'planned':
                    title.textContent = 'Planned Maintenance - MY-TR-2019';
                    content.innerHTML = `
                        <div class="bg-green-900 bg-opacity-30 border border-green-700 rounded p-4 mb-4">
                            <h3 class="font-bold text-green-400 mb-2">PLANNED - Due in 30 days</h3>
                            <p class="text-sm mb-2"><strong>Vehicle:</strong> MY-TR-2019 (Transport Truck)</p>
                            <p class="text-sm mb-2"><strong>Service:</strong> Preventive maintenance cycle</p>
                            <p class="text-sm"><strong>Location:</strong> Kem Mahkota - Service Bay 1</p>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Maintenance Plan</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between"><span>Oil Change:</span><span class="text-green-400">Scheduled</span></div>
                                    <div class="flex justify-between"><span>Brake Inspection:</span><span class="text-green-400">Scheduled</span></div>
                                    <div class="flex justify-between"><span>Tire Rotation:</span><span class="text-green-400">Scheduled</span></div>
                                    <div class="flex justify-between"><span>Filter Replacement:</span><span class="text-green-400">Scheduled</span></div>
                                </div>
                            </div>
                            <div class="bg-slate-700 rounded p-4">
                                <h4 class="font-semibold mb-2">Vehicle Information</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between"><span>Condition:</span><span class="text-green-400">Excellent</span></div>
                                    <div class="flex justify-between"><span>Mileage:</span><span class="text-green-400">28,500 km</span></div>
                                    <div class="flex justify-between"><span>Usage:</span><span class="text-blue-400">Regular</span></div>
                                    <div class="flex justify-between"><span>Estimated Cost:</span><span class="text-green-400">RM 6,200</span></div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
            }
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'981752fa4772c0c2',t:'MTc1ODI2NjQ2NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
